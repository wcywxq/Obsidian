---
title: 观察者模式
url: https://www.yuque.com/wcywxq/sd8kbc/dwziom
---

```javascript
class Watcher {
  constructor(name) {
    this.name = name
  }
  update() {
    console.log(this.name)
  }
}

class Notify {
  constructor() {
    this.observerList = []
  }
  add(obj) {
    this.observerList.push(obj)
    return this
  }
  remove(obj) {
    const idx = this.observerList.findIndex(o => o === obj)
    if (idx !== 1) {
      this.observerList.splice(idx, 1)
    }
    return this
  }
  notify() {
    this.observerList.forEach(wather => {
      wather.update()
    })
    return this
  }
}

const notify = new Notify()
const stateWatcher = new Watcher("state")
const computedWatcher = new Watcher("computed")
const watchWatcher = new Watcher("watch")

notify
  .add(stateWatcher)
  .add(computedWatcher)
  .add(watchWatcher)
  .notify()
```
