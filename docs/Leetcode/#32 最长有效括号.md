---
title: "#32 最长有效括号"
url: https://www.yuque.com/wcywxq/gklbh2/gkx2i4kcuqsp62q3
---

[32. 最长有效括号](https://leetcode.cn/problems/longest-valid-parentheses)

```javascript
/**
 * 动态规划
 * @param {string} s
 * @return {number}
 */
var longestValidParentheses = function (s) {
  /**
   * dp[i]: 以下标为 i 字符结尾的最长有效括号长度; dp[0...max]=0
   * 有效子串一定以 ) 结尾，以 ( 结尾的子串的 dp = 0，因此只需求解 ) 在 dp 数组中对应位置的值
   * 1. s[i]=) && s[i-1]=( -> dp[i]=dp[i-2]+2
   * 2. s[i]=) && s[i-1]=) -> s[i-dp[i-1]-1]=( -> dp[i]=dp[i-1]+dp[i-dp[i-1]-2]+2
   */
  let maxLength = 0
  let dp = new Array(s.length).fill(0)
  for (let i = 0; i < s.length; i++) {
    if (s[i] === ')') {
      if (s[i - 1] === '(') {
        dp[i] = (i >= 2 ? dp[i - 2] : 0) + 2
      } else if (
        s[i - 1] === ')' &&
        i > dp[i - 1] &&
        s[i - 1 - dp[i - 1]] === '('
      ) {
        dp[i] = (i - dp[i - 1] >= 2 ? dp[i - dp[i - 1] - 2] : 0) + dp[i - 1] + 2
      }
    }
    maxLength = Math.max(maxLength, dp[i])
  }
  return maxLength
}

/**
 * 栈
 * @param {string} s
 * @return {number}
 */
var longestValidParentheses = function (s) {
}

/**
 * 字符串
 * @param {string} s
 * @return {number}
 */
var longestValidParentheses = function (s) {
}
```
