{
  "id": 77021669,
  "slug": "gx1y1y",
  "title": "计算对象占用的字节数",
  "book_id": 27818302,
  "book": {
    "id": 27818302,
    "type": "Book",
    "slug": "pgkpvh",
    "name": "前端面试知识梳理",
    "user_id": 732231,
    "description": "",
    "creator_id": 732231,
    "public": 0,
    "items_count": 65,
    "likes_count": 0,
    "watches_count": 1,
    "content_updated_at": "2023-01-06T09:17:32.188Z",
    "updated_at": "2023-11-11T18:10:33.000Z",
    "created_at": "2022-05-11T14:43:59.000Z",
    "namespace": "wcywxq/pgkpvh",
    "user": {
      "id": 732231,
      "type": "User",
      "login": "wcywxq",
      "name": "magic",
      "description": null,
      "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
      "books_count": 18,
      "public_books_count": 0,
      "followers_count": 0,
      "following_count": 0,
      "created_at": "2020-01-08T14:21:31.000Z",
      "updated_at": "2023-11-13T09:32:35.000Z",
      "_serializer": "v2.user"
    },
    "_serializer": "v2.book"
  },
  "user_id": 732231,
  "creator": {
    "id": 732231,
    "type": "User",
    "login": "wcywxq",
    "name": "magic",
    "description": null,
    "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
    "books_count": 18,
    "public_books_count": 0,
    "followers_count": 0,
    "following_count": 0,
    "created_at": "2020-01-08T14:21:31.000Z",
    "updated_at": "2023-11-13T09:32:35.000Z",
    "_serializer": "v2.user"
  },
  "format": "lake",
  "body": "核心：\n\n- `number` 类型：`8` 字节\n- `string` 类型：每个字符长度 `2` 字节\n- `boolean` 类型：`4` 字节\n```javascript\nlet ws = new WeakSet()\n// 存储已经计算过的内存，避免相同引用造成的问题\nfunction calculator(val) {\n  let type = typeof val\n  switch (type) {\n    case \"string\":\n      return val.length * 2\n    case \"boolean\":\n      return 4\n    case \"number\":\n      return 8\n    case \"object\":\n      if (Array.isArray(val)) {\n        // 递归处理数组\n        return val.map(calculator).reduce((prev, cur) => prev + cur, 0)\n      } else {\n        // 对象的处理\n        return sizeOfObject(val)\n      }\n    default:\n      return 0\n  }\n}\n\nfunction sizeOfObject(obj) {\n  if (obj === null) return 0\n  let bytes = 0\n  // 对象里的 key 也会占用内存\n  let props = Object.keys(obj)\n  for (let i = 0; i < props.length; i++) {\n    const key = props[i]\n    bytes += calculator(key)\n    if (typeof obj[key] === \"object\" && obj[key] !== null) {\n      if (ws.has(obj[key])) continue\n      ws.add(obj[key])\n    }\n    bytes += calculator(obj[key])\n  }\n  return bytes\n}\n/** ========== 测试 ========== */\nconst testState = {\n  a: 111,\n  b: \"ccc\",\n  2222: false,\n  obj: {\n    a: 1,\n    b: 2\n  }\n}\nconsole.log(sizeOfObject(testState))\n```\n",
  "body_draft": "",
  "body_html": "<!doctype html><p data-lake-id=\"u159d166c\"><span>核心：</span></p><ul><li><code><span>number</span></code><span> 类型：</span><code><span>8</span></code><span> 字节</span></li><li><code><span>string</span></code><span> 类型：每个字符长度 </span><code><span>2</span></code><span> 字节</span></li><li><code><span>boolean</span></code><span> 类型：</span><code><span>4</span></code><span> 字节</span></li></ul><pre data-lang=\"javascript\"><code>let ws = new WeakSet()\n// 存储已经计算过的内存，避免相同引用造成的问题\nfunction calculator(val) {\n  let type = typeof val\n  switch (type) {\n    case &quot;string&quot;:\n      return val.length * 2\n    case &quot;boolean&quot;:\n      return 4\n    case &quot;number&quot;:\n      return 8\n    case &quot;object&quot;:\n      if (Array.isArray(val)) {\n        // 递归处理数组\n        return val.map(calculator).reduce((prev, cur) =&gt; prev + cur, 0)\n      } else {\n        // 对象的处理\n        return sizeOfObject(val)\n      }\n    default:\n      return 0\n  }\n}\n\nfunction sizeOfObject(obj) {\n  if (obj === null) return 0\n  let bytes = 0\n  // 对象里的 key 也会占用内存\n  let props = Object.keys(obj)\n  for (let i = 0; i &lt; props.length; i++) {\n    const key = props[i]\n    bytes += calculator(key)\n    if (typeof obj[key] === &quot;object&quot; &amp;&amp; obj[key] !== null) {\n      if (ws.has(obj[key])) continue\n      ws.add(obj[key])\n    }\n    bytes += calculator(obj[key])\n  }\n  return bytes\n}\n/** ========== 测试 ========== */\nconst testState = {\n  a: 111,\n  b: &quot;ccc&quot;,\n  2222: false,\n  obj: {\n    a: 1,\n    b: 2\n  }\n}\nconsole.log(sizeOfObject(testState))</code></pre>",
  "body_lake": "<!doctype lake><meta name=\"doc-version\" content=\"1\" /><meta name=\"typography\" content=\"classic\" /><meta name=\"viewport\" content=\"adapt\" /><p data-lake-id=\"u159d166c\" id=\"u159d166c\"><span data-lake-id=\"u9fe9c65e\" id=\"u9fe9c65e\">核心：</span></p><ul list=\"u8d41f6d8\"><li fid=\"u123d0c97\" data-lake-id=\"u88650048\" id=\"u88650048\"><code data-lake-id=\"ub265109c\" id=\"ub265109c\"><span data-lake-id=\"uad268a21\" id=\"uad268a21\">number</span></code><span data-lake-id=\"u93f31b7f\" id=\"u93f31b7f\"> 类型：</span><code data-lake-id=\"u2ef1eb4f\" id=\"u2ef1eb4f\"><span data-lake-id=\"u32a9cfeb\" id=\"u32a9cfeb\">8</span></code><span data-lake-id=\"u3b72943c\" id=\"u3b72943c\"> 字节</span></li><li fid=\"u123d0c97\" data-lake-id=\"ud7ca61ad\" id=\"ud7ca61ad\"><code data-lake-id=\"u797e9f3f\" id=\"u797e9f3f\"><span data-lake-id=\"u137779d6\" id=\"u137779d6\">string</span></code><span data-lake-id=\"ua3f397d7\" id=\"ua3f397d7\"> 类型：每个字符长度 </span><code data-lake-id=\"ud5914114\" id=\"ud5914114\"><span data-lake-id=\"ua5d62fab\" id=\"ua5d62fab\">2</span></code><span data-lake-id=\"uaf01c9bc\" id=\"uaf01c9bc\"> 字节</span></li><li fid=\"u123d0c97\" data-lake-id=\"udd4cdbc9\" id=\"udd4cdbc9\"><code data-lake-id=\"u000b5fdf\" id=\"u000b5fdf\"><span data-lake-id=\"u58522112\" id=\"u58522112\">boolean</span></code><span data-lake-id=\"u8467aabc\" id=\"u8467aabc\"> 类型：</span><code data-lake-id=\"u8c3600c0\" id=\"u8c3600c0\"><span data-lake-id=\"uf785ca75\" id=\"uf785ca75\">4</span></code><span data-lake-id=\"ubec1864d\" id=\"ubec1864d\"> 字节</span></li></ul><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22let%20ws%20%3D%20new%20WeakSet()%5Cn%2F%2F%20%E5%AD%98%E5%82%A8%E5%B7%B2%E7%BB%8F%E8%AE%A1%E7%AE%97%E8%BF%87%E7%9A%84%E5%86%85%E5%AD%98%EF%BC%8C%E9%81%BF%E5%85%8D%E7%9B%B8%E5%90%8C%E5%BC%95%E7%94%A8%E9%80%A0%E6%88%90%E7%9A%84%E9%97%AE%E9%A2%98%5Cnfunction%20calculator(val)%20%7B%5Cn%20%20let%20type%20%3D%20typeof%20val%5Cn%20%20switch%20(type)%20%7B%5Cn%20%20%20%20case%20%5C%22string%5C%22%3A%5Cn%20%20%20%20%20%20return%20val.length%20*%202%5Cn%20%20%20%20case%20%5C%22boolean%5C%22%3A%5Cn%20%20%20%20%20%20return%204%5Cn%20%20%20%20case%20%5C%22number%5C%22%3A%5Cn%20%20%20%20%20%20return%208%5Cn%20%20%20%20case%20%5C%22object%5C%22%3A%5Cn%20%20%20%20%20%20if%20(Array.isArray(val))%20%7B%5Cn%20%20%20%20%20%20%20%20%2F%2F%20%E9%80%92%E5%BD%92%E5%A4%84%E7%90%86%E6%95%B0%E7%BB%84%5Cn%20%20%20%20%20%20%20%20return%20val.map(calculator).reduce((prev%2C%20cur)%20%3D%3E%20prev%20%2B%20cur%2C%200)%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%2F%2F%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%A4%84%E7%90%86%5Cn%20%20%20%20%20%20%20%20return%20sizeOfObject(val)%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20default%3A%5Cn%20%20%20%20%20%20return%200%5Cn%20%20%7D%5Cn%7D%5Cn%5Cnfunction%20sizeOfObject(obj)%20%7B%5Cn%20%20if%20(obj%20%3D%3D%3D%20null)%20return%200%5Cn%20%20let%20bytes%20%3D%200%5Cn%20%20%2F%2F%20%E5%AF%B9%E8%B1%A1%E9%87%8C%E7%9A%84%20key%20%E4%B9%9F%E4%BC%9A%E5%8D%A0%E7%94%A8%E5%86%85%E5%AD%98%5Cn%20%20let%20props%20%3D%20Object.keys(obj)%5Cn%20%20for%20(let%20i%20%3D%200%3B%20i%20%3C%20props.length%3B%20i%2B%2B)%20%7B%5Cn%20%20%20%20const%20key%20%3D%20props%5Bi%5D%5Cn%20%20%20%20bytes%20%2B%3D%20calculator(key)%5Cn%20%20%20%20if%20(typeof%20obj%5Bkey%5D%20%3D%3D%3D%20%5C%22object%5C%22%20%26%26%20obj%5Bkey%5D%20!%3D%3D%20null)%20%7B%5Cn%20%20%20%20%20%20if%20(ws.has(obj%5Bkey%5D))%20continue%5Cn%20%20%20%20%20%20ws.add(obj%5Bkey%5D)%5Cn%20%20%20%20%7D%5Cn%20%20%20%20bytes%20%2B%3D%20calculator(obj%5Bkey%5D)%5Cn%20%20%7D%5Cn%20%20return%20bytes%5Cn%7D%5Cn%2F**%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%B5%8B%E8%AF%95%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%5Cnconst%20testState%20%3D%20%7B%5Cn%20%20a%3A%20111%2C%5Cn%20%20b%3A%20%5C%22ccc%5C%22%2C%5Cn%20%202222%3A%20false%2C%5Cn%20%20obj%3A%20%7B%5Cn%20%20%20%20a%3A%201%2C%5Cn%20%20%20%20b%3A%202%5Cn%20%20%7D%5Cn%7D%5Cnconsole.log(sizeOfObject(testState))%22%2C%22autoWrap%22%3Afalse%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22One%20Dark%20Pro%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22uwtA8%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card>",
  "body_draft_lake": "",
  "public": 0,
  "status": 1,
  "view_status": 0,
  "read_status": 1,
  "likes_count": 0,
  "comments_count": 0,
  "content_updated_at": "2022-05-11T15:01:50.000Z",
  "deleted_at": null,
  "created_at": "2022-05-11T15:01:50.000Z",
  "updated_at": "2022-05-11T15:08:07.000Z",
  "published_at": "2022-05-11T15:01:50.000Z",
  "first_published_at": "2022-05-11T15:01:50.463Z",
  "word_count": 213,
  "cover": null,
  "description": "核心：number 类型：8 字节string 类型：每个字符长度 2 字节boolean 类型：4 字节let ws = new WeakSet() // 存储已经计算过的内存，避免相同引用造成的问题 function calculator(val) {   let type = typeo...",
  "custom_description": null,
  "hits": 0,
  "_serializer": "v2.doc_detail"
}