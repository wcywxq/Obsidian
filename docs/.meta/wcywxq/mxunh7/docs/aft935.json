{
  "id": 72212166,
  "slug": "aft935",
  "title": "优化 webpack 的构建速度",
  "book_id": 26225124,
  "book": {
    "id": 26225124,
    "type": "Book",
    "slug": "mxunh7",
    "name": "八股文 eight-part essay writing",
    "user_id": 732231,
    "description": "前端八股文",
    "creator_id": 732231,
    "public": 0,
    "items_count": 239,
    "likes_count": 0,
    "watches_count": 1,
    "content_updated_at": "2023-11-11T18:15:57.023Z",
    "updated_at": "2023-11-11T18:15:57.000Z",
    "created_at": "2022-04-04T11:31:45.000Z",
    "namespace": "wcywxq/mxunh7",
    "user": {
      "id": 732231,
      "type": "User",
      "login": "wcywxq",
      "name": "magic",
      "description": null,
      "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
      "books_count": 18,
      "public_books_count": 0,
      "followers_count": 0,
      "following_count": 0,
      "created_at": "2020-01-08T14:21:31.000Z",
      "updated_at": "2023-11-13T09:32:35.000Z",
      "_serializer": "v2.user"
    },
    "_serializer": "v2.book"
  },
  "user_id": 732231,
  "creator": {
    "id": 732231,
    "type": "User",
    "login": "wcywxq",
    "name": "magic",
    "description": null,
    "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
    "books_count": 18,
    "public_books_count": 0,
    "followers_count": 0,
    "following_count": 0,
    "created_at": "2020-01-08T14:21:31.000Z",
    "updated_at": "2023-11-13T09:32:35.000Z",
    "_serializer": "v2.user"
  },
  "format": "lake",
  "body": "1. **使用高版本的 **`**webpack**`** 和 **`**node.js**`\n   - `webpack v4` 优点：\n      - v8 带来的优化(`for...of` 代替了 `forEach`、`Map` 和 `Set` 代替了 `Object`、`includes` 代替了 `indexOf`)\n      - 默认使用更快的 `md4 hash`算法，去替代`md5`\n      - `webpack ast`可以直接从`loader`传递给 `ast`，减少解析时间\n      - 使用字符串方法替代正则表达式\n   - `webpack v5` 优点：\n\n[webpack 5 和 webpack 4 的区别](https://front-tech.yuque.com/go/doc/71613217?view=doc_embed)\n\n2. **多进程、多实例构建**\n   - `thread-loader`官方推荐\n   - `parallel-webpack`\n   - `happypack`\n3. `**JavaScript**`**代码多进程、多实例并行压缩**\n   - `terser-webpack-plugin`：设置`parallel: true`\n4. **图片压缩**\n   - `image-minimizer-webpack-plugin`官方推荐\n   - `image-webpack-loader`\n5. **缩小打包作用域**\n   - `exclude/include`：确定`loader`的作用范围\n   - 优化`resolve.module`配置：指明第三方模块的绝对路径，以减少不必要的查找\n   - 优化`resolve.mainFields`配置\n   - 优化`resolve.extensions`配置\n   - 对不需要解析的第三方库进行忽略\n   - 合理利用`alias`\n6. **提取页面公共资源**\n   - `externals`：\n      - 使用`externals`配置来提取常用库，将基础库通过`cdn`引入，不打入`bundle`中\n   - `dll`webpack5不推荐：\n      - 在`webpack v4`及以前，可以通过使用`webpack.DllPlugin`和`webpack.DllReferencePlugin`来拆分`bundles`，对模块进行预编译，从而大幅提升构建速度。(`dll: 动态链接库`)\n      - 主要是利用，利用索引链接对`mainfest.json`的引用，通过`webpack.DllPlugin`来对引用但绝对不会修改的`npm`包进行预编译，再通过`webpack.DllReferencePlugin`将预编译的模块加载进来，避免反复编译浪费时间\n      - 随着`webpack v4`版本自身编译加快，`dll`缓存作为优化方案便显得不再那么重要。在`webpack v5`中，提供的持久化缓存是比`dll`更优秀的解决方案。\n7. **充分利用缓存提高二次构建速度**\n   - `babel-loader`可以通过设置`cacheDirectory: true`选项来开启缓存配置，将`babel-loader`提速至少两倍，同时会将转译结果缓存到文件系统中。\n   - `terser-webpack-plugin`：通过配置`minimizer`自定义`terser-webpack-plugin`配置\n      - 在 `webpack4` 中，通过设置`cache: true`或者 `cache: 'path/to/cache'` 即指定缓存目录来开启缓存；\n      - 在 `webpack5`中，通过设置`terserOptions.nameCache: JSON.parse(fs.readFileSync(/tmp/cache.json, \"utf8\"))`来指定缓存文件的映射\n   - 在`webpack5`中，通过配置持久化缓存`cache.type: filesystem`和配置缓存路径`cache.cacheDirectory: path.resolve(__dirname, '.temp_cache')`来缓存生成的`webpack`模块和`chunk`，以改善构建速度。(当构建突然中断，二次构建时，将直接从缓存中拉取代码，整体提速 `90%`左右)\n8. **多个入口时进行 **`**common chunk**`** 设置**\n   - 在`webpack v4`之前，曾使用`common-webpack-plugin`来避免`webpack`图谱中父子关系关联之间的重复依赖问题\n   - 在`webpack v4`开始，通过使用`optimization.splitChunks`来配置分包策略，进而分离公共资源，避免单个包体积过大等问题\n9. **代码 **`**tree-shaking**`\n   - 在打包过程中检测工程中没有使用过的模块并进行标记，在资源压缩时将他们从最终的 `bunlde`中去掉，在开发过程中尽可能的使用`es-module`的模块，提高`tree-shaking`效率\n   - 禁用`babel-loader`的模块依赖解析功能，否则`webpack`接收到的就是转换过的`commonjs`形式的模块，无法进行`tree-shaking`\n   - 使用`mini-css-extract-plugin`，默认情况下会生成使用`ES`模块语法的`JS`语法，这样对`tree-shaking`是有益的\n10. **作用域提升 **`**scope-hoisting**`\n   - `scope-hoisting` 会分析出模块之间的依赖关系，尽可能的使用闭包，即把打包出来的模块合并到一个函数中，这样会减少冗余并加速\n   - 开启方式：`optimazation.concatenateModules: true`\n11. **动态 **`**polyfill**`** 服务**\n   - 利用 `cdn`动态导入 `polyfill`\n12. **关闭 **`**symlinks**`\n   - 若项目不使用 `npm link` 或者 `yarn link`，那么可以设置 `resolve.syslinks: false`，减少解析工作量\n13. **不同的**`**devtool**`**设置，会导致性能差异**\n   - 在大多数情况下，最佳选择是`eval-cheap-module-source-map`\n      - 设置`devtool: \"eval-cheap-module-source-map\"`即可\n14. **输出结果不携带路径信息**\n   - 默认`webpack`会在输出的`bundle`中生成路径信息，将路径信息删除可小幅度提升构建速度\n      - 设置`output.pathinfo: false`来关闭路径信息\n",
  "body_draft": "",
  "body_html": "<!doctype html><ol><li><strong><span>使用高版本的 </span></strong><code><strong><span>webpack</span></strong></code><strong><span> 和 </span></strong><code><strong><span>node.js</span></strong></code></li></ol><ul data-lake-indent=\"1\"><li><code><span>webpack v4</span></code><span> 优点：</span></li></ul><ul data-lake-indent=\"2\"><li><span>v8 带来的优化(</span><code><span>for...of</span></code><span> 代替了 </span><code><span>forEach</span></code><span>、</span><code><span>Map</span></code><span> 和 </span><code><span>Set</span></code><span> 代替了 </span><code><span>Object</span></code><span>、</span><code><span>includes</span></code><span> 代替了 </span><code><span>indexOf</span></code><span>)</span></li><li><span>默认使用更快的 </span><code><span>md4 hash</span></code><span>算法，去替代</span><code><span>md5</span></code></li><li><code><span>webpack ast</span></code><span>可以直接从</span><code><span>loader</span></code><span>传递给 </span><code><span>ast</span></code><span>，减少解析时间</span></li><li><span>使用字符串方法替代正则表达式</span></li></ul><ul data-lake-indent=\"1\"><li><code><span>webpack v5</span></code><span> 优点：</span></li></ul><p><a target=\"_blank\" href=\"https://front-tech.yuque.com/go/doc/71613217?view=doc_embed\">webpack 5 和 webpack 4 的区别</a></p><ol start=\"2\"><li><strong><span>多进程、多实例构建</span></strong></li></ol><ul data-lake-indent=\"1\"><li><code><span>thread-loader</span></code><span class=\"lake-card-label\" style=\"background-color: #DEE8FC; color: #061178;\">官方推荐</span></li><li><code><span>parallel-webpack</span></code></li><li><code><span>happypack</span></code></li></ul><ol start=\"3\"><li><code><strong><span>JavaScript</span></strong></code><strong><span>代码多进程、多实例并行压缩</span></strong></li></ol><ul data-lake-indent=\"1\"><li><code><span>terser-webpack-plugin</span></code><span>：设置</span><code><span>parallel: true</span></code></li></ul><ol start=\"4\"><li><strong><span>图片压缩</span></strong></li></ol><ul data-lake-indent=\"1\"><li><code><span>image-minimizer-webpack-plugin</span></code><span class=\"lake-card-label\" style=\"background-color: #DEE8FC; color: #061178;\">官方推荐</span></li></ul><ul data-lake-indent=\"1\"><li><code><span>image-webpack-loader</span></code></li></ul><ol start=\"5\"><li><strong><span>缩小打包作用域</span></strong></li></ol><ul data-lake-indent=\"1\"><li><code><span>exclude/include</span></code><span>：确定</span><code><span>loader</span></code><span>的作用范围</span></li><li><span>优化</span><code><span>resolve.module</span></code><span>配置：指明第三方模块的绝对路径，以减少不必要的查找</span></li><li><span>优化</span><code><span>resolve.mainFields</span></code><span>配置</span></li><li><span>优化</span><code><span>resolve.extensions</span></code><span>配置</span></li><li><span>对不需要解析的第三方库进行忽略</span></li><li><span>合理利用</span><code><span>alias</span></code></li></ul><ol start=\"6\"><li><strong><span>提取页面公共资源</span></strong></li></ol><ul data-lake-indent=\"1\"><li><code><span>externals</span></code><span>：</span></li></ul><ul data-lake-indent=\"2\"><li><span>使用</span><code><span>externals</span></code><span>配置来提取常用库，将基础库通过</span><code><span>cdn</span></code><span>引入，不打入</span><code><span>bundle</span></code><span>中</span></li></ul><ul data-lake-indent=\"1\"><li><code><span>dll</span></code><span class=\"lake-card-label\" style=\"background-color: #FFE8E6; color: #820014;\">webpack5不推荐</span><span>：</span></li></ul><ul data-lake-indent=\"2\"><li><span>在</span><code><span>webpack v4</span></code><span>及以前，可以通过使用</span><code><span>webpack.DllPlugin</span></code><span>和</span><code><span>webpack.DllReferencePlugin</span></code><span>来拆分</span><code><span>bundles</span></code><span>，对模块进行预编译，从而大幅提升构建速度。(</span><code><span>dll: 动态链接库</span></code><span>)</span></li><li><span>主要是利用，利用索引链接对</span><code><span>mainfest.json</span></code><span>的引用，通过</span><code><span>webpack.DllPlugin</span></code><span>来对引用但绝对不会修改的</span><code><span>npm</span></code><span>包进行预编译，再通过</span><code><span>webpack.DllReferencePlugin</span></code><span>将预编译的模块加载进来，避免反复编译浪费时间</span></li><li><span>随着</span><code><span>webpack v4</span></code><span>版本自身编译加快，</span><code><span>dll</span></code><span>缓存作为优化方案便显得不再那么重要。在</span><code><span>webpack v5</span></code><span>中，提供的持久化缓存是比</span><code><span>dll</span></code><span>更优秀的解决方案。</span></li></ul><ol start=\"7\"><li><strong><span>充分利用缓存提高二次构建速度</span></strong></li></ol><ul data-lake-indent=\"1\"><li><code><span>babel-loader</span></code><span>可以通过设置</span><code><span>cacheDirectory: true</span></code><span>选项来开启缓存配置，将</span><code><span>babel-loader</span></code><span>提速至少两倍，同时会将转译结果缓存到文件系统中。</span></li><li><code><span>terser-webpack-plugin</span></code><span>：通过配置</span><code><span>minimizer</span></code><span>自定义</span><code><span>terser-webpack-plugin</span></code><span>配置</span></li></ul><ul data-lake-indent=\"2\"><li><span>在 </span><code><span>webpack4</span></code><span> 中，通过设置</span><code><span>cache: true</span></code><span>或者 </span><code><span>cache: 'path/to/cache'</span></code><span> 即指定缓存目录来开启缓存；</span></li><li><span>在 </span><code><span>webpack5</span></code><span>中，通过设置</span><code><span>terserOptions.nameCache: </span><span>JSON</span><span>.</span><span>parse</span><span>(fs.</span><span>readFileSync</span><span>(</span><span>/tmp/cache.json</span><span>, </span><span>&quot;utf8&quot;</span><span>))</span></code><span>来指定缓存文件的映射</span></li></ul><ul data-lake-indent=\"1\"><li><span>在</span><code><span>webpack5</span></code><span>中，通过配置持久化缓存</span><code><span>cache.type: filesystem</span></code><span>和配置缓存路径</span><code><span>cache.</span><span class=\"lake-fontsize-11\" style=\"color: #2B3A42;\">cacheDirectory: path.resolve(__dirname, '.temp_cache')</span></code><span>来缓存生成的</span><code><span>webpack</span></code><span>模块和</span><code><span>chunk</span></code><span>，以改善构建速度。(当构建突然中断，二次构建时，将直接从缓存中拉取代码，整体提速 </span><code><span>90%</span></code><span>左右)</span></li></ul><ol start=\"8\"><li><strong><span>多个入口时进行 </span></strong><code><strong><span>common chunk</span></strong></code><strong><span> 设置</span></strong></li></ol><ul data-lake-indent=\"1\"><li><span>在</span><code><span>webpack v4</span></code><span>之前，曾使用</span><code><span>common-webpack-plugin</span></code><span>来避免</span><code><span>webpack</span></code><span>图谱中父子关系关联之间的重复依赖问题</span></li><li><span>在</span><code><span>webpack v4</span></code><span>开始，通过使用</span><code><span>optimization.splitChunks</span></code><span>来配置分包策略，进而分离公共资源，避免单个包体积过大等问题</span></li></ul><ol start=\"9\"><li><strong><span>代码 </span></strong><code><strong><span>tree-shaking</span></strong></code></li></ol><ul data-lake-indent=\"1\"><li><span>在打包过程中检测工程中没有使用过的模块并进行标记，在资源压缩时将他们从最终的 </span><code><span>bunlde</span></code><span>中去掉，在开发过程中尽可能的使用</span><code><span>es-module</span></code><span>的模块，提高</span><code><span>tree-shaking</span></code><span>效率</span></li><li><span>禁用</span><code><span>babel-loader</span></code><span>的模块依赖解析功能，否则</span><code><span>webpack</span></code><span>接收到的就是转换过的</span><code><span>commonjs</span></code><span>形式的模块，无法进行</span><code><span>tree-shaking</span></code></li><li><span>使用</span><code><span>mini-css-extract-plugin</span></code><span>，默认情况下会生成使用</span><code><span>ES</span></code><span>模块语法的</span><code><span>JS</span></code><span>语法，这样对</span><code><span>tree-shaking</span></code><span>是有益的</span></li></ul><ol start=\"10\"><li><strong><span>作用域提升 </span></strong><code><strong><span>scope-hoisting</span></strong></code></li></ol><ul data-lake-indent=\"1\"><li><code><span>scope-hoisting</span></code><span> 会分析出模块之间的依赖关系，尽可能的使用闭包，即把打包出来的模块合并到一个函数中，这样会减少冗余并加速</span></li><li><span>开启方式：</span><code><span>optimazation.concatenateModules: true</span></code></li></ul><ol start=\"11\"><li><strong><span>动态 </span></strong><code><strong><span>polyfill</span></strong></code><strong><span> 服务</span></strong></li></ol><ul data-lake-indent=\"1\"><li><span>利用 </span><code><span>cdn</span></code><span>动态导入 </span><code><span>polyfill</span></code></li></ul><ol start=\"12\"><li><strong><span>关闭 </span></strong><code><strong><span>symlinks</span></strong></code><strong><span>​</span></strong></li></ol><ul data-lake-indent=\"1\"><li><span>若项目不使用 </span><code><span>npm link</span></code><span> 或者 </span><code><span>yarn link</span></code><span>，那么可以设置 </span><code><span>resolve.syslinks: false</span></code><span>，减少解析工作量</span></li></ul><ol start=\"13\"><li><strong><span>不同的</span></strong><code><strong><span>devtool</span></strong></code><strong><span>设置，会导致性能差异</span></strong></li></ol><ul data-lake-indent=\"1\"><li><span>在大多数情况下，最佳选择是</span><code><span>eval-cheap-module-source-map</span></code></li></ul><ul data-lake-indent=\"2\"><li><span>设置</span><code><span>devtool: &quot;eval-cheap-module-source-map&quot;</span></code><span>即可</span></li></ul><ol start=\"14\"><li><strong><span>输出结果不携带路径信息</span></strong></li></ol><ul data-lake-indent=\"1\"><li><span>默认</span><code><span>webpack</span></code><span>会在输出的</span><code><span>bundle</span></code><span>中生成路径信息，将路径信息删除可小幅度提升构建速度</span></li></ul><ul data-lake-indent=\"2\"><li><span>设置</span><code><span>output.pathinfo: false</span></code><span>来关闭路径信息</span></li></ul>",
  "body_lake": "<!doctype lake><meta name=\"doc-version\" content=\"1\" /><meta name=\"typography\" content=\"classic\" /><meta name=\"viewport\" content=\"adapt\" /><ol list=\"ue4c88d23\"><li fid=\"u305d115c\" data-lake-id=\"u38c2c08a\" id=\"u38c2c08a\"><strong><span data-lake-id=\"u11a95b7c\" id=\"u11a95b7c\">使用高版本的 </span></strong><code data-lake-id=\"udd841939\" id=\"udd841939\"><strong><span data-lake-id=\"ubca698f1\" id=\"ubca698f1\">webpack</span></strong></code><strong><span data-lake-id=\"u14aa614d\" id=\"u14aa614d\"> 和 </span></strong><code data-lake-id=\"u6c6a42b9\" id=\"u6c6a42b9\"><strong><span data-lake-id=\"u6bc0f3e9\" id=\"u6bc0f3e9\">node.js</span></strong></code></li></ol><ul list=\"ue1b6156c\" data-lake-indent=\"1\"><li fid=\"uf90f3b7d\" data-lake-id=\"u46acf5de\" id=\"u46acf5de\"><code data-lake-id=\"ucb43a1cf\" id=\"ucb43a1cf\"><span data-lake-id=\"ua6f9c141\" id=\"ua6f9c141\">webpack v4</span></code><span data-lake-id=\"u769da491\" id=\"u769da491\"> 优点：</span></li></ul><ul list=\"ue1b6156c\" data-lake-indent=\"2\"><li fid=\"uf90f3b7d\" data-lake-id=\"ub9915e8b\" id=\"ub9915e8b\"><span data-lake-id=\"u8493aa9f\" id=\"u8493aa9f\">v8 带来的优化(</span><code data-lake-id=\"u53adf643\" id=\"u53adf643\"><span data-lake-id=\"u3fa59ec8\" id=\"u3fa59ec8\">for...of</span></code><span data-lake-id=\"ufec03c9b\" id=\"ufec03c9b\"> 代替了 </span><code data-lake-id=\"u3c6d2eb2\" id=\"u3c6d2eb2\"><span data-lake-id=\"u2ce1be70\" id=\"u2ce1be70\">forEach</span></code><span data-lake-id=\"ua348839d\" id=\"ua348839d\">、</span><code data-lake-id=\"uf86d0243\" id=\"uf86d0243\"><span data-lake-id=\"u036c50b2\" id=\"u036c50b2\">Map</span></code><span data-lake-id=\"u97792e27\" id=\"u97792e27\"> 和 </span><code data-lake-id=\"uad3edaf5\" id=\"uad3edaf5\"><span data-lake-id=\"u14f6805d\" id=\"u14f6805d\">Set</span></code><span data-lake-id=\"u335826eb\" id=\"u335826eb\"> 代替了 </span><code data-lake-id=\"ue642725b\" id=\"ue642725b\"><span data-lake-id=\"u0c92136e\" id=\"u0c92136e\">Object</span></code><span data-lake-id=\"ube065a4f\" id=\"ube065a4f\">、</span><code data-lake-id=\"u7e9eb058\" id=\"u7e9eb058\"><span data-lake-id=\"u943e16c6\" id=\"u943e16c6\">includes</span></code><span data-lake-id=\"ubbd27d01\" id=\"ubbd27d01\"> 代替了 </span><code data-lake-id=\"u4aefb962\" id=\"u4aefb962\"><span data-lake-id=\"u9c68fcc5\" id=\"u9c68fcc5\">indexOf</span></code><span data-lake-id=\"ufa90349f\" id=\"ufa90349f\">)</span></li><li fid=\"uf90f3b7d\" data-lake-id=\"u97c84e9f\" id=\"u97c84e9f\"><span data-lake-id=\"u55e231af\" id=\"u55e231af\">默认使用更快的 </span><code data-lake-id=\"u798a480c\" id=\"u798a480c\"><span data-lake-id=\"u5ba31a2f\" id=\"u5ba31a2f\">md4 hash</span></code><span data-lake-id=\"uc5a543d6\" id=\"uc5a543d6\">算法，去替代</span><code data-lake-id=\"ubf4c5580\" id=\"ubf4c5580\"><span data-lake-id=\"u5dfb7cf9\" id=\"u5dfb7cf9\">md5</span></code></li><li fid=\"uf90f3b7d\" data-lake-id=\"u95984113\" id=\"u95984113\"><code data-lake-id=\"u3fb8fae4\" id=\"u3fb8fae4\"><span data-lake-id=\"u43f0de9d\" id=\"u43f0de9d\">webpack ast</span></code><span data-lake-id=\"u2640d509\" id=\"u2640d509\">可以直接从</span><code data-lake-id=\"uc72fe3b7\" id=\"uc72fe3b7\"><span data-lake-id=\"uf79548d6\" id=\"uf79548d6\">loader</span></code><span data-lake-id=\"u2e98c9bd\" id=\"u2e98c9bd\">传递给 </span><code data-lake-id=\"u5ae455a5\" id=\"u5ae455a5\"><span data-lake-id=\"u4e739e48\" id=\"u4e739e48\">ast</span></code><span data-lake-id=\"u6d09c20d\" id=\"u6d09c20d\">，减少解析时间</span></li><li fid=\"uf90f3b7d\" data-lake-id=\"ua9490fcf\" id=\"ua9490fcf\"><span data-lake-id=\"u2ea1fd6a\" id=\"u2ea1fd6a\">使用字符串方法替代正则表达式</span></li></ul><ul list=\"ue1b6156c\" start=\"2\" data-lake-indent=\"1\"><li fid=\"uf90f3b7d\" data-lake-id=\"u3055b466\" id=\"u3055b466\"><code data-lake-id=\"ud2f53434\" id=\"ud2f53434\"><span data-lake-id=\"u441d2e3b\" id=\"u441d2e3b\">webpack v5</span></code><span data-lake-id=\"ud36fdf40\" id=\"ud36fdf40\"> 优点：</span></li></ul><card type=\"block\" name=\"yuque\" value=\"data:%7B%22mode%22%3A%22embed%22%2C%22heightMode%22%3A%22adaptive%22%2C%22isGroup%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Ffront-tech.yuque.com%2Fgo%2Fdoc%2F71613217%22%2C%22url%22%3A%22https%3A%2F%2Ffront-tech.yuque.com%2Fgo%2Fdoc%2F71613217%3Fview%3Ddoc_embed%22%2C%22detail%22%3A%7B%22image%22%3A%22https%3A%2F%2Fcdn.nlark.com%2Fyuque%2F0%2F2022%2Fpng%2F732231%2F1648046099220-3f4e6738-7bab-465b-af99-22d0f2dfd0e3.png%22%2C%22title%22%3A%22webpack%205%20%E5%92%8C%20webpack%204%20%E7%9A%84%E5%8C%BA%E5%88%AB%22%2C%22type%22%3A%22doc%22%2C%22belong%22%3A%22%E5%89%8D%E7%AB%AF%E5%85%AB%E8%82%A1%E6%96%87%E7%B4%A2%E5%BC%95%22%2C%22belong_url%22%3A%22%2Fstaff-qg7c8v%2Fnz53az%22%2C%22desc%22%3A%22%E5%86%85%E7%BD%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%9E%84%E5%BB%BA%E8%83%BD%E5%8A%9B%20Asset%20Modules%E5%9C%A8%20webpack5%20%E4%B9%8B%E5%89%8D%EF%BC%8C%E9%80%9A%E5%B8%B8%E4%BD%BF%E7%94%A8%EF%BC%9Araw-loader%20%E5%B0%86%E6%96%87%E4%BB%B6%E5%AF%BC%E5%85%A5%E4%B8%BA%E5%AD%97%E7%AC%A6%E4%B8%B2url-loader%20%E5%B0%86%E6%96%87%E4%BB%B6%E4%BD%9C%E4%B8%BA%20data%20URI%20%E5%86%85%E8%81%94%E5%88%B0%20bundle%20%E4%B8%ADfile-loader%20%E5%B0%86%E6%96%87%E4%BB%B6%E5%8F%91%E9%80%81%E5%88%B0%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95%E8%B5%84%E6%BA%90%E6%A8%A1%E5%9D%97%E7%B1%BB%E5%9E%8B%20asset%20module%20type...%22%2C%22url%22%3A%22https%3A%2F%2Ffront-tech.yuque.com%2Fgo%2Fdoc%2F71613217%22%2C%22target_type%22%3A%22Doc%22%2C%22_serializer%22%3A%22web.editor_link_detail%22%7D%2C%22id%22%3A%22Atn8p%22%7D\"></card><ol list=\"ue4c88d23\" start=\"2\"><li fid=\"u305d115c\" data-lake-id=\"u517323c1\" id=\"u517323c1\"><strong><span data-lake-id=\"u30eff3f2\" id=\"u30eff3f2\">多进程、多实例构建</span></strong></li></ol><ul list=\"u30abd843\" data-lake-indent=\"1\"><li fid=\"u28740d8a\" data-lake-id=\"u19dff384\" id=\"u19dff384\"><code data-lake-id=\"u307581f0\" id=\"u307581f0\"><span data-lake-id=\"u1cb6a898\" id=\"u1cb6a898\">thread-loader</span></code><card type=\"inline\" name=\"label\" value=\"data:%7B%22label%22%3A%22%E5%AE%98%E6%96%B9%E6%8E%A8%E8%8D%90%22%2C%22colorIndex%22%3A5%2C%22id%22%3A%22mj5NF%22%7D\"></card></li><li fid=\"u28740d8a\" data-lake-id=\"u617aaf88\" id=\"u617aaf88\"><code data-lake-id=\"ue31f80eb\" id=\"ue31f80eb\"><span data-lake-id=\"u2132544b\" id=\"u2132544b\">parallel-webpack</span></code></li><li fid=\"u28740d8a\" data-lake-id=\"u543ddead\" id=\"u543ddead\"><code data-lake-id=\"u55e8c508\" id=\"u55e8c508\"><span data-lake-id=\"ub18c4fdd\" id=\"ub18c4fdd\">happypack</span></code></li></ul><ol list=\"ue4c88d23\" start=\"3\"><li fid=\"u305d115c\" data-lake-id=\"u8713c605\" id=\"u8713c605\"><code data-lake-id=\"u30039726\" id=\"u30039726\"><strong><span data-lake-id=\"ue8e71b43\" id=\"ue8e71b43\">JavaScript</span></strong></code><strong><span data-lake-id=\"ua82aa886\" id=\"ua82aa886\">代码多进程、多实例并行压缩</span></strong></li></ol><ul list=\"u45e2dec9\" data-lake-indent=\"1\"><li fid=\"uea90984e\" data-lake-id=\"ue0f348f1\" id=\"ue0f348f1\"><code data-lake-id=\"u11ea01ea\" id=\"u11ea01ea\"><span data-lake-id=\"ued409b80\" id=\"ued409b80\">terser-webpack-plugin</span></code><span data-lake-id=\"ud13b929d\" id=\"ud13b929d\">：设置</span><code data-lake-id=\"ud68046a3\" id=\"ud68046a3\"><span data-lake-id=\"ucd9b4124\" id=\"ucd9b4124\">parallel: true</span></code></li></ul><ol list=\"ue4c88d23\" start=\"4\"><li fid=\"u305d115c\" data-lake-id=\"ub05f609a\" id=\"ub05f609a\"><strong><span data-lake-id=\"ubdc3a621\" id=\"ubdc3a621\">图片压缩</span></strong></li></ol><ul list=\"u674d37f8\" data-lake-indent=\"1\"><li fid=\"ua56c0ee1\" data-lake-id=\"u01eb7b47\" id=\"u01eb7b47\"><code data-lake-id=\"u59cfe5dd\" id=\"u59cfe5dd\"><span data-lake-id=\"u3204d831\" id=\"u3204d831\">image-minimizer-webpack-plugin</span></code><card type=\"inline\" name=\"label\" value=\"data:%7B%22label%22%3A%22%E5%AE%98%E6%96%B9%E6%8E%A8%E8%8D%90%22%2C%22colorIndex%22%3A5%2C%22id%22%3A%22gl5WD%22%7D\"></card></li></ul><ul list=\"ubd0e6462\" data-lake-indent=\"1\"><li fid=\"u53edd3b7\" data-lake-id=\"u839f329f\" id=\"u839f329f\"><code data-lake-id=\"ub1d1360c\" id=\"ub1d1360c\"><span data-lake-id=\"u3fa12c0f\" id=\"u3fa12c0f\">image-webpack-loader</span></code></li></ul><ol list=\"ue4c88d23\" start=\"5\"><li fid=\"u305d115c\" data-lake-id=\"ud6fb64d3\" id=\"ud6fb64d3\"><strong><span data-lake-id=\"u2392c65f\" id=\"u2392c65f\">缩小打包作用域</span></strong></li></ol><ul list=\"u6aa24b8a\" data-lake-indent=\"1\"><li fid=\"uacb31ed0\" data-lake-id=\"ue3dd19c3\" id=\"ue3dd19c3\"><code data-lake-id=\"u1ee16e44\" id=\"u1ee16e44\"><span data-lake-id=\"u859ab6b7\" id=\"u859ab6b7\">exclude/include</span></code><span data-lake-id=\"u958a384f\" id=\"u958a384f\">：确定</span><code data-lake-id=\"ub72ee4d0\" id=\"ub72ee4d0\"><span data-lake-id=\"u193ffc57\" id=\"u193ffc57\">loader</span></code><span data-lake-id=\"u9aebe142\" id=\"u9aebe142\">的作用范围</span></li><li fid=\"uacb31ed0\" data-lake-id=\"u3cea577e\" id=\"u3cea577e\"><span data-lake-id=\"u388cbcfa\" id=\"u388cbcfa\">优化</span><code data-lake-id=\"ua54fc1a9\" id=\"ua54fc1a9\"><span data-lake-id=\"uc719e4d5\" id=\"uc719e4d5\">resolve.module</span></code><span data-lake-id=\"ubbc65fac\" id=\"ubbc65fac\">配置：指明第三方模块的绝对路径，以减少不必要的查找</span></li><li fid=\"uacb31ed0\" data-lake-id=\"u129bf726\" id=\"u129bf726\"><span data-lake-id=\"u0963348a\" id=\"u0963348a\">优化</span><code data-lake-id=\"u1458a8cd\" id=\"u1458a8cd\"><span data-lake-id=\"u85336547\" id=\"u85336547\">resolve.mainFields</span></code><span data-lake-id=\"u837c9a69\" id=\"u837c9a69\">配置</span></li><li fid=\"uacb31ed0\" data-lake-id=\"u3ae612a5\" id=\"u3ae612a5\"><span data-lake-id=\"ucb36f1fd\" id=\"ucb36f1fd\">优化</span><code data-lake-id=\"u97d84358\" id=\"u97d84358\"><span data-lake-id=\"u8881e6c8\" id=\"u8881e6c8\">resolve.extensions</span></code><span data-lake-id=\"u5ed74775\" id=\"u5ed74775\">配置</span></li><li fid=\"uacb31ed0\" data-lake-id=\"ud886a48d\" id=\"ud886a48d\"><span data-lake-id=\"u4351c0ee\" id=\"u4351c0ee\">对不需要解析的第三方库进行忽略</span></li><li fid=\"uacb31ed0\" data-lake-id=\"u2bbd5cb8\" id=\"u2bbd5cb8\"><span data-lake-id=\"u392d879f\" id=\"u392d879f\">合理利用</span><code data-lake-id=\"u3706ff34\" id=\"u3706ff34\"><span data-lake-id=\"u211e3a6c\" id=\"u211e3a6c\">alias</span></code></li></ul><ol list=\"ue4c88d23\" start=\"6\"><li fid=\"u305d115c\" data-lake-id=\"u48f2fb96\" id=\"u48f2fb96\"><strong><span data-lake-id=\"u3bea5974\" id=\"u3bea5974\">提取页面公共资源</span></strong></li></ol><ul list=\"u324d9fc2\" data-lake-indent=\"1\"><li fid=\"u06b6ffe2\" data-lake-id=\"u5957e8d5\" id=\"u5957e8d5\"><code data-lake-id=\"u9e39ba32\" id=\"u9e39ba32\"><span data-lake-id=\"u4f0ad02e\" id=\"u4f0ad02e\">externals</span></code><span data-lake-id=\"u34ea6349\" id=\"u34ea6349\">：</span></li></ul><ul list=\"u324d9fc2\" data-lake-indent=\"2\"><li fid=\"u06b6ffe2\" data-lake-id=\"uf838f5d5\" id=\"uf838f5d5\"><span data-lake-id=\"ua9a731fc\" id=\"ua9a731fc\">使用</span><code data-lake-id=\"uf665086d\" id=\"uf665086d\"><span data-lake-id=\"uad0eb71b\" id=\"uad0eb71b\">externals</span></code><span data-lake-id=\"u62679f3c\" id=\"u62679f3c\">配置来提取常用库，将基础库通过</span><code data-lake-id=\"u993331cc\" id=\"u993331cc\"><span data-lake-id=\"u737a5091\" id=\"u737a5091\">cdn</span></code><span data-lake-id=\"u532df8fc\" id=\"u532df8fc\">引入，不打入</span><code data-lake-id=\"u2df89d0a\" id=\"u2df89d0a\"><span data-lake-id=\"ufd1182b8\" id=\"ufd1182b8\">bundle</span></code><span data-lake-id=\"ufb80e7bf\" id=\"ufb80e7bf\">中</span></li></ul><ul list=\"u324d9fc2\" start=\"2\" data-lake-indent=\"1\"><li fid=\"u06b6ffe2\" data-lake-id=\"ufabed71e\" id=\"ufabed71e\"><code data-lake-id=\"ucb80b135\" id=\"ucb80b135\"><span data-lake-id=\"u1df82417\" id=\"u1df82417\">dll</span></code><card type=\"inline\" name=\"label\" value=\"data:%7B%22label%22%3A%22webpack5%E4%B8%8D%E6%8E%A8%E8%8D%90%22%2C%22colorIndex%22%3A0%2C%22id%22%3A%22HMv11%22%7D\"></card><span data-lake-id=\"u8ba846c3\" id=\"u8ba846c3\">：</span></li></ul><ul list=\"u324d9fc2\" data-lake-indent=\"2\"><li fid=\"u06b6ffe2\" data-lake-id=\"ue6306697\" id=\"ue6306697\"><span data-lake-id=\"u9422a2ef\" id=\"u9422a2ef\">在</span><code data-lake-id=\"u5bf6a397\" id=\"u5bf6a397\"><span data-lake-id=\"u810bfce7\" id=\"u810bfce7\">webpack v4</span></code><span data-lake-id=\"ua2df7cef\" id=\"ua2df7cef\">及以前，可以通过使用</span><code data-lake-id=\"uc6d4079c\" id=\"uc6d4079c\"><span data-lake-id=\"uf830c84a\" id=\"uf830c84a\">webpack.DllPlugin</span></code><span data-lake-id=\"uafd453ad\" id=\"uafd453ad\">和</span><code data-lake-id=\"uf54f76c5\" id=\"uf54f76c5\"><span data-lake-id=\"u8eae6160\" id=\"u8eae6160\">webpack.DllReferencePlugin</span></code><span data-lake-id=\"u6a3ff5f4\" id=\"u6a3ff5f4\">来拆分</span><code data-lake-id=\"u28010b6b\" id=\"u28010b6b\"><span data-lake-id=\"u0da78c6e\" id=\"u0da78c6e\">bundles</span></code><span data-lake-id=\"u730bb408\" id=\"u730bb408\">，对模块进行预编译，从而大幅提升构建速度。(</span><code data-lake-id=\"ue9f3797b\" id=\"ue9f3797b\"><span data-lake-id=\"u54104281\" id=\"u54104281\">dll: 动态链接库</span></code><span data-lake-id=\"u284b2e55\" id=\"u284b2e55\">)</span></li><li fid=\"u06b6ffe2\" data-lake-id=\"ufdd0185b\" id=\"ufdd0185b\"><span data-lake-id=\"ue5eaaf92\" id=\"ue5eaaf92\">主要是利用，利用索引链接对</span><code data-lake-id=\"u97096055\" id=\"u97096055\"><span data-lake-id=\"u19c9cf80\" id=\"u19c9cf80\">mainfest.json</span></code><span data-lake-id=\"u22fa0210\" id=\"u22fa0210\">的引用，通过</span><code data-lake-id=\"ud0115ef0\" id=\"ud0115ef0\"><span data-lake-id=\"u638eb79b\" id=\"u638eb79b\">webpack.DllPlugin</span></code><span data-lake-id=\"ua64fd309\" id=\"ua64fd309\">来对引用但绝对不会修改的</span><code data-lake-id=\"u84bd4d67\" id=\"u84bd4d67\"><span data-lake-id=\"u9864ca32\" id=\"u9864ca32\">npm</span></code><span data-lake-id=\"u13517de1\" id=\"u13517de1\">包进行预编译，再通过</span><code data-lake-id=\"u8e603e59\" id=\"u8e603e59\"><span data-lake-id=\"uf88e2bf6\" id=\"uf88e2bf6\">webpack.DllReferencePlugin</span></code><span data-lake-id=\"u7ba2c468\" id=\"u7ba2c468\">将预编译的模块加载进来，避免反复编译浪费时间</span></li><li fid=\"u06b6ffe2\" data-lake-id=\"u641ffe98\" id=\"u641ffe98\"><span data-lake-id=\"u80a7a36b\" id=\"u80a7a36b\">随着</span><code data-lake-id=\"u54da4731\" id=\"u54da4731\"><span data-lake-id=\"ua7e6f7ea\" id=\"ua7e6f7ea\">webpack v4</span></code><span data-lake-id=\"u5d511785\" id=\"u5d511785\">版本自身编译加快，</span><code data-lake-id=\"uca1c6154\" id=\"uca1c6154\"><span data-lake-id=\"u6b2b319d\" id=\"u6b2b319d\">dll</span></code><span data-lake-id=\"u9802c6c3\" id=\"u9802c6c3\">缓存作为优化方案便显得不再那么重要。在</span><code data-lake-id=\"u0e681b32\" id=\"u0e681b32\"><span data-lake-id=\"u32c0d0d0\" id=\"u32c0d0d0\">webpack v5</span></code><span data-lake-id=\"uc69ee71a\" id=\"uc69ee71a\">中，提供的持久化缓存是比</span><code data-lake-id=\"u29c95e45\" id=\"u29c95e45\"><span data-lake-id=\"ube4f7414\" id=\"ube4f7414\">dll</span></code><span data-lake-id=\"udb1dfd06\" id=\"udb1dfd06\">更优秀的解决方案。</span></li></ul><ol list=\"ue4c88d23\" start=\"7\"><li fid=\"u305d115c\" data-lake-id=\"ucb599ce4\" id=\"ucb599ce4\"><strong><span data-lake-id=\"u18f598bb\" id=\"u18f598bb\">充分利用缓存提高二次构建速度</span></strong></li></ol><ul list=\"u69c595ed\" data-lake-indent=\"1\"><li fid=\"uc8c8ce1f\" data-lake-id=\"ub4bc2262\" id=\"ub4bc2262\"><code data-lake-id=\"u198b2b1b\" id=\"u198b2b1b\"><span data-lake-id=\"u4ed8eb74\" id=\"u4ed8eb74\">babel-loader</span></code><span data-lake-id=\"u8201d99e\" id=\"u8201d99e\">可以通过设置</span><code data-lake-id=\"u6eaf0e2c\" id=\"u6eaf0e2c\"><span data-lake-id=\"u4f79c9da\" id=\"u4f79c9da\">cacheDirectory: true</span></code><span data-lake-id=\"u26acdbdc\" id=\"u26acdbdc\">选项来开启缓存配置，将</span><code data-lake-id=\"u7a4b8381\" id=\"u7a4b8381\"><span data-lake-id=\"u88d9dd93\" id=\"u88d9dd93\">babel-loader</span></code><span data-lake-id=\"ua7217de8\" id=\"ua7217de8\">提速至少两倍，同时会将转译结果缓存到文件系统中。</span></li><li fid=\"uc8c8ce1f\" data-lake-id=\"u1580c3c8\" id=\"u1580c3c8\"><code data-lake-id=\"u95c73d8b\" id=\"u95c73d8b\"><span data-lake-id=\"u53b760e6\" id=\"u53b760e6\">terser-webpack-plugin</span></code><span data-lake-id=\"u3ff0af56\" id=\"u3ff0af56\">：通过配置</span><code data-lake-id=\"ua799f7b6\" id=\"ua799f7b6\"><span data-lake-id=\"uc4259d88\" id=\"uc4259d88\">minimizer</span></code><span data-lake-id=\"uc2ca691e\" id=\"uc2ca691e\">自定义</span><code data-lake-id=\"u9787cda1\" id=\"u9787cda1\"><span data-lake-id=\"u16f4ec28\" id=\"u16f4ec28\">terser-webpack-plugin</span></code><span data-lake-id=\"u26bb0582\" id=\"u26bb0582\">配置</span></li></ul><ul list=\"u69c595ed\" data-lake-indent=\"2\"><li fid=\"uc8c8ce1f\" data-lake-id=\"u51721267\" id=\"u51721267\"><span data-lake-id=\"u64a5036d\" id=\"u64a5036d\">在 </span><code data-lake-id=\"uc65d3be2\" id=\"uc65d3be2\"><span data-lake-id=\"u251d6f01\" id=\"u251d6f01\">webpack4</span></code><span data-lake-id=\"u85372e60\" id=\"u85372e60\"> 中，通过设置</span><code data-lake-id=\"u90798386\" id=\"u90798386\"><span data-lake-id=\"ue1c3f438\" id=\"ue1c3f438\">cache: true</span></code><span data-lake-id=\"u8158f1dd\" id=\"u8158f1dd\">或者 </span><code data-lake-id=\"u11a6023b\" id=\"u11a6023b\"><span data-lake-id=\"u16b6f708\" id=\"u16b6f708\">cache: 'path/to/cache'</span></code><span data-lake-id=\"uef4ec24e\" id=\"uef4ec24e\"> 即指定缓存目录来开启缓存；</span></li><li fid=\"uc8c8ce1f\" data-lake-id=\"uc194ebaa\" id=\"uc194ebaa\"><span data-lake-id=\"u9e6c4cdf\" id=\"u9e6c4cdf\">在 </span><code data-lake-id=\"u721165fb\" id=\"u721165fb\"><span data-lake-id=\"u9c4c6052\" id=\"u9c4c6052\">webpack5</span></code><span data-lake-id=\"u0dee0997\" id=\"u0dee0997\">中，通过设置</span><code data-lake-id=\"ua3304da1\" id=\"ua3304da1\"><span data-lake-id=\"uafd36d7e\" id=\"uafd36d7e\">terserOptions.nameCache: </span><span data-lake-id=\"u3698e6ec\" id=\"u3698e6ec\" style=\"color: var(--color-prettylights-syntax-constant)\">JSON</span><span data-lake-id=\"u98637cec\" id=\"u98637cec\">.</span><span data-lake-id=\"u92630c2e\" id=\"u92630c2e\" style=\"color: var(--color-prettylights-syntax-entity)\">parse</span><span data-lake-id=\"u883e7b1d\" id=\"u883e7b1d\">(fs.</span><span data-lake-id=\"u2dbfba53\" id=\"u2dbfba53\" style=\"color: var(--color-prettylights-syntax-entity)\">readFileSync</span><span data-lake-id=\"u79f814a2\" id=\"u79f814a2\">(</span><span data-lake-id=\"u4d8d0ef9\" id=\"u4d8d0ef9\" style=\"color: var(--color-prettylights-syntax-string)\">/tmp/cache.json</span><span data-lake-id=\"u7783aea2\" id=\"u7783aea2\">, </span><span data-lake-id=\"udd3372e4\" id=\"udd3372e4\" style=\"color: var(--color-prettylights-syntax-string)\">&quot;utf8&quot;</span><span data-lake-id=\"u77d16015\" id=\"u77d16015\">))</span></code><span data-lake-id=\"ud63c8ae1\" id=\"ud63c8ae1\">来指定缓存文件的映射</span></li></ul><ul list=\"u69c595ed\" start=\"3\" data-lake-indent=\"1\"><li fid=\"uc8c8ce1f\" data-lake-id=\"u1b90a755\" id=\"u1b90a755\"><span data-lake-id=\"ue6735ed5\" id=\"ue6735ed5\">在</span><code data-lake-id=\"uaff6feae\" id=\"uaff6feae\"><span data-lake-id=\"ueaf6b2f1\" id=\"ueaf6b2f1\">webpack5</span></code><span data-lake-id=\"u2341ee76\" id=\"u2341ee76\">中，通过配置持久化缓存</span><code data-lake-id=\"ua31eb501\" id=\"ua31eb501\"><span data-lake-id=\"u1b5995c1\" id=\"u1b5995c1\">cache.type: filesystem</span></code><span data-lake-id=\"u7fe14e69\" id=\"u7fe14e69\">和配置缓存路径</span><code data-lake-id=\"ud255583c\" id=\"ud255583c\"><span data-lake-id=\"uc572e107\" id=\"uc572e107\">cache.</span><span data-lake-id=\"u462f4083\" id=\"u462f4083\" class=\"lake-fontsize-11\" style=\"color: rgb(43, 58, 66)\">cacheDirectory: path.resolve(__dirname, '.temp_cache')</span></code><span data-lake-id=\"u827af32d\" id=\"u827af32d\">来缓存生成的</span><code data-lake-id=\"ua0306b24\" id=\"ua0306b24\"><span data-lake-id=\"u2c2dc3a1\" id=\"u2c2dc3a1\">webpack</span></code><span data-lake-id=\"u4f773299\" id=\"u4f773299\">模块和</span><code data-lake-id=\"u896b9719\" id=\"u896b9719\"><span data-lake-id=\"u57fd94e4\" id=\"u57fd94e4\">chunk</span></code><span data-lake-id=\"u79c2530d\" id=\"u79c2530d\">，以改善构建速度。(当构建突然中断，二次构建时，将直接从缓存中拉取代码，整体提速 </span><code data-lake-id=\"uc5ce10a2\" id=\"uc5ce10a2\"><span data-lake-id=\"uf049433b\" id=\"uf049433b\">90%</span></code><span data-lake-id=\"ue393326a\" id=\"ue393326a\">左右)</span></li></ul><ol list=\"ue4c88d23\" start=\"8\"><li fid=\"u305d115c\" data-lake-id=\"u4d8bd31e\" id=\"u4d8bd31e\"><strong><span data-lake-id=\"u48399876\" id=\"u48399876\">多个入口时进行 </span></strong><code data-lake-id=\"u01ff429f\" id=\"u01ff429f\"><strong><span data-lake-id=\"u20643c01\" id=\"u20643c01\">common chunk</span></strong></code><strong><span data-lake-id=\"u277db4a8\" id=\"u277db4a8\"> 设置</span></strong></li></ol><ul list=\"ud87a8ceb\" data-lake-indent=\"1\"><li fid=\"u0304215a\" data-lake-id=\"u88bc0d08\" id=\"u88bc0d08\"><span data-lake-id=\"ubee68f97\" id=\"ubee68f97\">在</span><code data-lake-id=\"ub68b15ca\" id=\"ub68b15ca\"><span data-lake-id=\"u4baee053\" id=\"u4baee053\">webpack v4</span></code><span data-lake-id=\"u634773e0\" id=\"u634773e0\">之前，曾使用</span><code data-lake-id=\"u5f62def1\" id=\"u5f62def1\"><span data-lake-id=\"u3957062b\" id=\"u3957062b\">common-webpack-plugin</span></code><span data-lake-id=\"u21083d89\" id=\"u21083d89\">来避免</span><code data-lake-id=\"u58f4a930\" id=\"u58f4a930\"><span data-lake-id=\"ua9c12bfb\" id=\"ua9c12bfb\">webpack</span></code><span data-lake-id=\"ub3e2f4c5\" id=\"ub3e2f4c5\">图谱中父子关系关联之间的重复依赖问题</span></li><li fid=\"u0304215a\" data-lake-id=\"u9c3963bf\" id=\"u9c3963bf\"><span data-lake-id=\"uaa186219\" id=\"uaa186219\">在</span><code data-lake-id=\"u83db95dc\" id=\"u83db95dc\"><span data-lake-id=\"uf7fdf5d2\" id=\"uf7fdf5d2\">webpack v4</span></code><span data-lake-id=\"u11fb25d6\" id=\"u11fb25d6\">开始，通过使用</span><code data-lake-id=\"u6cbb8747\" id=\"u6cbb8747\"><span data-lake-id=\"uf5ef3df1\" id=\"uf5ef3df1\">optimization.splitChunks</span></code><span data-lake-id=\"u8d3a8d5a\" id=\"u8d3a8d5a\">来配置分包策略，进而分离公共资源，避免单个包体积过大等问题</span></li></ul><ol list=\"ue4c88d23\" start=\"9\"><li fid=\"u305d115c\" data-lake-id=\"u290db0bc\" id=\"u290db0bc\"><strong><span data-lake-id=\"ufe62d990\" id=\"ufe62d990\">代码 </span></strong><code data-lake-id=\"ub7c3245b\" id=\"ub7c3245b\"><strong><span data-lake-id=\"u7460160f\" id=\"u7460160f\">tree-shaking</span></strong></code></li></ol><ul list=\"u9ed8968f\" data-lake-indent=\"1\"><li fid=\"u83d9598e\" data-lake-id=\"uf261e574\" id=\"uf261e574\"><span data-lake-id=\"u71c01596\" id=\"u71c01596\">在打包过程中检测工程中没有使用过的模块并进行标记，在资源压缩时将他们从最终的 </span><code data-lake-id=\"uc436e471\" id=\"uc436e471\"><span data-lake-id=\"ud2041a64\" id=\"ud2041a64\">bunlde</span></code><span data-lake-id=\"u5c8af605\" id=\"u5c8af605\">中去掉，在开发过程中尽可能的使用</span><code data-lake-id=\"ucad47dbf\" id=\"ucad47dbf\"><span data-lake-id=\"u6d300182\" id=\"u6d300182\">es-module</span></code><span data-lake-id=\"uad71d94a\" id=\"uad71d94a\">的模块，提高</span><code data-lake-id=\"uada9c9bc\" id=\"uada9c9bc\"><span data-lake-id=\"udd7e42d9\" id=\"udd7e42d9\">tree-shaking</span></code><span data-lake-id=\"u82b056f2\" id=\"u82b056f2\">效率</span></li><li fid=\"u83d9598e\" data-lake-id=\"u55feaa89\" id=\"u55feaa89\"><span data-lake-id=\"u1ec7602c\" id=\"u1ec7602c\">禁用</span><code data-lake-id=\"u429c5944\" id=\"u429c5944\"><span data-lake-id=\"u1e11bd9b\" id=\"u1e11bd9b\">babel-loader</span></code><span data-lake-id=\"ub404e6a1\" id=\"ub404e6a1\">的模块依赖解析功能，否则</span><code data-lake-id=\"u154dc5dd\" id=\"u154dc5dd\"><span data-lake-id=\"u0aee90d1\" id=\"u0aee90d1\">webpack</span></code><span data-lake-id=\"u388964d2\" id=\"u388964d2\">接收到的就是转换过的</span><code data-lake-id=\"uef840052\" id=\"uef840052\"><span data-lake-id=\"ub6b2f72c\" id=\"ub6b2f72c\">commonjs</span></code><span data-lake-id=\"ud7ed1baa\" id=\"ud7ed1baa\">形式的模块，无法进行</span><code data-lake-id=\"u18379bd5\" id=\"u18379bd5\"><span data-lake-id=\"u79ab87ce\" id=\"u79ab87ce\">tree-shaking</span></code></li><li fid=\"u83d9598e\" data-lake-id=\"uab0838f4\" id=\"uab0838f4\"><span data-lake-id=\"u1ef794ea\" id=\"u1ef794ea\">使用</span><code data-lake-id=\"u7040b761\" id=\"u7040b761\"><span data-lake-id=\"ud9996e90\" id=\"ud9996e90\">mini-css-extract-plugin</span></code><span data-lake-id=\"u4bd4380c\" id=\"u4bd4380c\">，默认情况下会生成使用</span><code data-lake-id=\"u2c02e5a7\" id=\"u2c02e5a7\"><span data-lake-id=\"u3e293abf\" id=\"u3e293abf\">ES</span></code><span data-lake-id=\"uee72b85f\" id=\"uee72b85f\">模块语法的</span><code data-lake-id=\"ubc50c03f\" id=\"ubc50c03f\"><span data-lake-id=\"u3b33eb11\" id=\"u3b33eb11\">JS</span></code><span data-lake-id=\"u7ba18c30\" id=\"u7ba18c30\">语法，这样对</span><code data-lake-id=\"u3922a6d7\" id=\"u3922a6d7\"><span data-lake-id=\"u71d12e98\" id=\"u71d12e98\">tree-shaking</span></code><span data-lake-id=\"u29486170\" id=\"u29486170\">是有益的</span></li></ul><ol list=\"ue4c88d23\" start=\"10\"><li fid=\"u305d115c\" data-lake-id=\"u2d06a38e\" id=\"u2d06a38e\"><strong><span data-lake-id=\"u49aee53f\" id=\"u49aee53f\">作用域提升 </span></strong><code data-lake-id=\"u93eca278\" id=\"u93eca278\"><strong><span data-lake-id=\"u0903a4b9\" id=\"u0903a4b9\">scope-hoisting</span></strong></code></li></ol><ul list=\"u7a858abe\" data-lake-indent=\"1\"><li fid=\"u8f6befbf\" data-lake-id=\"u2ce52ce7\" id=\"u2ce52ce7\"><code data-lake-id=\"u6d94fab0\" id=\"u6d94fab0\"><span data-lake-id=\"uba19059e\" id=\"uba19059e\">scope-hoisting</span></code><span data-lake-id=\"u4e5e1110\" id=\"u4e5e1110\"> 会分析出模块之间的依赖关系，尽可能的使用闭包，即把打包出来的模块合并到一个函数中，这样会减少冗余并加速</span></li><li fid=\"u8f6befbf\" data-lake-id=\"u3f371adf\" id=\"u3f371adf\"><span data-lake-id=\"u393e5e8f\" id=\"u393e5e8f\">开启方式：</span><code data-lake-id=\"u58ada6d8\" id=\"u58ada6d8\"><span data-lake-id=\"u79fd4a9a\" id=\"u79fd4a9a\">optimazation.concatenateModules: true</span></code></li></ul><ol list=\"ue4c88d23\" start=\"11\"><li fid=\"u305d115c\" data-lake-id=\"u2d8fc294\" id=\"u2d8fc294\"><strong><span data-lake-id=\"uae0846c8\" id=\"uae0846c8\">动态 </span></strong><code data-lake-id=\"u362abbb3\" id=\"u362abbb3\"><strong><span data-lake-id=\"u8f563a1d\" id=\"u8f563a1d\">polyfill</span></strong></code><strong><span data-lake-id=\"u7d75a8a4\" id=\"u7d75a8a4\"> 服务</span></strong></li></ol><ul list=\"ue5dc8606\" data-lake-indent=\"1\"><li fid=\"ua8d29760\" data-lake-id=\"ue0eb3445\" id=\"ue0eb3445\"><span data-lake-id=\"u71e7d53f\" id=\"u71e7d53f\">利用 </span><code data-lake-id=\"u9182fd9e\" id=\"u9182fd9e\"><span data-lake-id=\"u623e4df0\" id=\"u623e4df0\">cdn</span></code><span data-lake-id=\"u257d33c8\" id=\"u257d33c8\">动态导入 </span><code data-lake-id=\"u830d1b0c\" id=\"u830d1b0c\"><span data-lake-id=\"u0bbbc4e7\" id=\"u0bbbc4e7\">polyfill</span></code></li></ul><ol list=\"ue4c88d23\" start=\"12\"><li fid=\"u305d115c\" data-lake-id=\"uae81bcac\" id=\"uae81bcac\"><strong><span data-lake-id=\"u42f4d4ce\" id=\"u42f4d4ce\">关闭 </span></strong><code data-lake-id=\"ue5347f9d\" id=\"ue5347f9d\"><strong><span data-lake-id=\"u753a1312\" id=\"u753a1312\">symlinks</span></strong></code><strong><span data-lake-id=\"u24c1f1d2\" id=\"u24c1f1d2\">​</span></strong></li></ol><ul list=\"ub2a7f9cf\" data-lake-indent=\"1\"><li fid=\"ua6fe60a7\" data-lake-id=\"u4045e7f6\" id=\"u4045e7f6\"><span data-lake-id=\"u25128a20\" id=\"u25128a20\">若项目不使用 </span><code data-lake-id=\"u23bb4234\" id=\"u23bb4234\"><span data-lake-id=\"u07144cd7\" id=\"u07144cd7\">npm link</span></code><span data-lake-id=\"uaa486ffb\" id=\"uaa486ffb\"> 或者 </span><code data-lake-id=\"u1f298d91\" id=\"u1f298d91\"><span data-lake-id=\"ud006bd24\" id=\"ud006bd24\">yarn link</span></code><span data-lake-id=\"uc04346b9\" id=\"uc04346b9\">，那么可以设置 </span><code data-lake-id=\"u1a44ed95\" id=\"u1a44ed95\"><span data-lake-id=\"uc32c3802\" id=\"uc32c3802\">resolve.syslinks: false</span></code><span data-lake-id=\"ub8c1723d\" id=\"ub8c1723d\">，减少解析工作量</span></li></ul><ol list=\"u4f689392\" start=\"13\"><li fid=\"ubd0e1d9a\" data-lake-id=\"u519da31a\" id=\"u519da31a\"><strong><span data-lake-id=\"u0b1d0f31\" id=\"u0b1d0f31\">不同的</span></strong><code data-lake-id=\"u3fc8bc2a\" id=\"u3fc8bc2a\"><strong><span data-lake-id=\"u2f4847de\" id=\"u2f4847de\">devtool</span></strong></code><strong><span data-lake-id=\"ufc4c7059\" id=\"ufc4c7059\">设置，会导致性能差异</span></strong></li></ol><ul list=\"uf1c60a59\" data-lake-indent=\"1\"><li fid=\"u8ba79cda\" data-lake-id=\"u8e9c7906\" id=\"u8e9c7906\"><span data-lake-id=\"u45309395\" id=\"u45309395\">在大多数情况下，最佳选择是</span><code data-lake-id=\"u84d97f3e\" id=\"u84d97f3e\"><span data-lake-id=\"ucf71a2ba\" id=\"ucf71a2ba\">eval-cheap-module-source-map</span></code></li></ul><ul list=\"uf1c60a59\" data-lake-indent=\"2\"><li fid=\"u8ba79cda\" data-lake-id=\"u1b23dd9e\" id=\"u1b23dd9e\"><span data-lake-id=\"u7273861b\" id=\"u7273861b\">设置</span><code data-lake-id=\"u64bde544\" id=\"u64bde544\"><span data-lake-id=\"u28c4bd20\" id=\"u28c4bd20\">devtool: &quot;eval-cheap-module-source-map&quot;</span></code><span data-lake-id=\"ud41679fb\" id=\"ud41679fb\">即可</span></li></ul><ol list=\"uae6e4934\" start=\"14\"><li fid=\"u5f486540\" data-lake-id=\"u5fb1d2be\" id=\"u5fb1d2be\"><strong><span data-lake-id=\"ud88151ae\" id=\"ud88151ae\">输出结果不携带路径信息</span></strong></li></ol><ul list=\"u6ab4893e\" data-lake-indent=\"1\"><li fid=\"u12de7413\" data-lake-id=\"uf2ce587d\" id=\"uf2ce587d\"><span data-lake-id=\"u6d07ac20\" id=\"u6d07ac20\">默认</span><code data-lake-id=\"u8bf4a52d\" id=\"u8bf4a52d\"><span data-lake-id=\"ua9c21f57\" id=\"ua9c21f57\">webpack</span></code><span data-lake-id=\"u7c86eaf0\" id=\"u7c86eaf0\">会在输出的</span><code data-lake-id=\"u3443b080\" id=\"u3443b080\"><span data-lake-id=\"u456e8b5c\" id=\"u456e8b5c\">bundle</span></code><span data-lake-id=\"uf4d08d3d\" id=\"uf4d08d3d\">中生成路径信息，将路径信息删除可小幅度提升构建速度</span></li></ul><ul list=\"u6ab4893e\" data-lake-indent=\"2\"><li fid=\"u12de7413\" data-lake-id=\"uf3adda2a\" id=\"uf3adda2a\"><span data-lake-id=\"u6ee50111\" id=\"u6ee50111\">设置</span><code data-lake-id=\"u958c104b\" id=\"u958c104b\"><span data-lake-id=\"ue5178510\" id=\"ue5178510\">output.pathinfo: false</span></code><span data-lake-id=\"uee495e8a\" id=\"uee495e8a\">来关闭路径信息</span></li></ul>",
  "body_draft_lake": "",
  "public": 0,
  "status": 1,
  "view_status": 0,
  "read_status": 1,
  "likes_count": 0,
  "comments_count": 0,
  "content_updated_at": "2022-04-04T11:33:24.000Z",
  "deleted_at": null,
  "created_at": "2022-04-04T11:33:24.000Z",
  "updated_at": "2022-05-10T15:12:37.000Z",
  "published_at": "2022-04-04T11:33:24.000Z",
  "first_published_at": "2022-04-04T11:33:24.118Z",
  "word_count": 1080,
  "cover": null,
  "description": "使用高版本的 webpack 和 node.jswebpack v4 优点：v8 带来的优化(for...of 代替了 forEach、Map 和 Set 代替了 Object、includes 代替了 indexOf)默认使用更快的 md4 hash算法，去替代md5webpack ast可...",
  "custom_description": null,
  "hits": 0,
  "_serializer": "v2.doc_detail"
}