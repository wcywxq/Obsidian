{
  "id": 72212392,
  "slug": "griz0t",
  "title": "节流",
  "book_id": 26225252,
  "book": {
    "id": 26225252,
    "type": "Book",
    "slug": "sd8kbc",
    "name": "笔试 written test",
    "user_id": 732231,
    "description": "笔试相关题目\n1. 原生 API 实现\n2. 业务场景相关问题\n3. LeetCode 算法相关问题",
    "creator_id": 732231,
    "public": 0,
    "items_count": 74,
    "likes_count": 0,
    "watches_count": 1,
    "content_updated_at": "2023-11-11T18:15:38.713Z",
    "updated_at": "2023-11-11T18:15:39.000Z",
    "created_at": "2022-04-04T11:34:53.000Z",
    "namespace": "wcywxq/sd8kbc",
    "user": {
      "id": 732231,
      "type": "User",
      "login": "wcywxq",
      "name": "magic",
      "description": null,
      "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
      "books_count": 18,
      "public_books_count": 0,
      "followers_count": 0,
      "following_count": 0,
      "created_at": "2020-01-08T14:21:31.000Z",
      "updated_at": "2023-11-13T09:32:35.000Z",
      "_serializer": "v2.user"
    },
    "_serializer": "v2.book"
  },
  "user_id": 732231,
  "creator": {
    "id": 732231,
    "type": "User",
    "login": "wcywxq",
    "name": "magic",
    "description": null,
    "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
    "books_count": 18,
    "public_books_count": 0,
    "followers_count": 0,
    "following_count": 0,
    "created_at": "2020-01-08T14:21:31.000Z",
    "updated_at": "2023-11-13T09:32:35.000Z",
    "_serializer": "v2.user"
  },
  "format": "lake",
  "body": "设置了固定时间触发的时候，在触发高频事件的过程中，如果达到了设置的时间间隔，将执行 `1` 次\n\n常用场景: `resize`、`scroll` 等一定会触发的高频事件中\n<a name=\"WuORS\"></a>\n## 初级版\n\n- 第一次立即执行, 时间戳法\n```javascript\nfunction throttle(fn, wait) {\n  let prev = 0\n  return function(...args) {\n    let context = this\n    if (Date.now() - prev > wait) {\n      fn.apply(context, args)\n      prev = Date.now()\n    }\n  }\n}\n```\n\n- 第一次不立即执行, 定时器法\n```javascript\nfunction throttle(fn, wait) {\n  let timer\n  return function (...args) {\n    let context = this\n    if (timer) return\n    timer = setTimeout(() => {\n      fn.apply(context, args)\n      timer = null\n    }, wait)\n  }\n}\n```\n\n- 结合时间戳法和定时器法, 保证第一次和最后一次都执行\n```javascript\nfunction throttle(fn, wait) {\n  let timer\n  let startTime = Date.now()\n  return function(...args) {\n    let currentTime = Date.now()\n    let remainingTime = wait - (currentTime - startTimeÏ)\n    let context = this\n    if (timer) clearTimeout(timer)\n    if (remainingTime <= 0) {\n      fn.apply(context, args)\n      startTime = Date.now()\n    } else {\n      timer = setTimeout(fn, remainingTime)\n    }\n  }                \n}\n```\n<a name=\"Dv6Kz\"></a>\n## 包含立即执行和结束后执行1次开关并且带有取消功能\n```javascript\n/**\n* @desc fn 回调函数\n* @desc wait 等待事件\n* @desc immediate 是否立即执行一次\n* @desc trail 执行结束后是否再执行一次\n*/\nfunction throttle(fn, wait, immediate, trail) {\n  let timer\n  let startTime = 0\n  let clearTimer = () => {\n    clearTimeout(timer)\n    timer = null\n  }\n  let fn = function (...args) {\n    let context = this\n    if (!prev && !immediate) {\n      startTime = Date.now()\n    }\n    let remainingTime = wait - (Date.now() - startTime)\n    if (timer) clearTimer()\n    if (!timer) {\n      if (remainingTime <= 0 || remainingTime > wait) {\n        startTime = Date.now()\n        fn.apply(context, args)\n      }\n      if (trail) {\n        timer = setTimeout(() => {\n          startTime = immediate ? 0 : Date.now()\n          timer = null\n          fn.apply(context, args)\n        }, remainingTime)\n      }\n    }\n  }\n  fn.off = function () {\n    clearTimer()\n    startTime = 0\n  }\n  return fn\n}\n```\n\n\n\n\n\n",
  "body_draft": "",
  "body_html": "<!doctype html><p data-lake-id=\"u35026aa9\"><span>设置了固定时间触发的时候，在触发高频事件的过程中，如果达到了设置的时间间隔，将执行 </span><code><span>1</span></code><span> 次</span></p><p data-lake-id=\"u7e07b8b8\"><span>​</span><br /></p><p data-lake-id=\"ue003aacd\"><span>常用场景: </span><code><span>resize</span></code><span>、</span><code><span>scroll</span></code><span> 等一定会触发的高频事件中</span></p><h2 id=\"WuORS\"><span>初级版</span></h2><ul><li><span>第一次立即执行, 时间戳法</span></li></ul><pre data-lang=\"javascript\"><code>function throttle(fn, wait) {\n  let prev = 0\n  return function(...args) {\n    let context = this\n    if (Date.now() - prev &gt; wait) {\n      fn.apply(context, args)\n      prev = Date.now()\n    }\n  }\n}</code></pre><ul><li><span>第一次不立即执行, 定时器法</span></li></ul><pre data-lang=\"javascript\"><code>function throttle(fn, wait) {\n  let timer\n  return function (...args) {\n    let context = this\n    if (timer) return\n    timer = setTimeout(() =&gt; {\n      fn.apply(context, args)\n      timer = null\n    }, wait)\n  }\n}</code></pre><ul><li><span>结合时间戳法和定时器法, 保证第一次和最后一次都执行</span></li></ul><pre data-lang=\"javascript\"><code>function throttle(fn, wait) {\n  let timer\n  let startTime = Date.now()\n  return function(...args) {\n    let currentTime = Date.now()\n    let remainingTime = wait - (currentTime - startTimeÏ)\n    let context = this\n    if (timer) clearTimeout(timer)\n    if (remainingTime &lt;= 0) {\n      fn.apply(context, args)\n      startTime = Date.now()\n    } else {\n      timer = setTimeout(fn, remainingTime)\n    }\n  }                \n}</code></pre><h2 id=\"Dv6Kz\"><span>包含立即执行和结束后执行1次开关并且带有取消功能</span></h2><pre data-lang=\"javascript\"><code>/**\n* @desc fn 回调函数\n* @desc wait 等待事件\n* @desc immediate 是否立即执行一次\n* @desc trail 执行结束后是否再执行一次\n*/\nfunction throttle(fn, wait, immediate, trail) {\n  let timer\n  let startTime = 0\n  let clearTimer = () =&gt; {\n    clearTimeout(timer)\n    timer = null\n  }\n  let fn = function (...args) {\n    let context = this\n    if (!prev &amp;&amp; !immediate) {\n      startTime = Date.now()\n    }\n    let remainingTime = wait - (Date.now() - startTime)\n    if (timer) clearTimer()\n    if (!timer) {\n      if (remainingTime &lt;= 0 || remainingTime &gt; wait) {\n        startTime = Date.now()\n        fn.apply(context, args)\n      }\n      if (trail) {\n        timer = setTimeout(() =&gt; {\n          startTime = immediate ? 0 : Date.now()\n          timer = null\n          fn.apply(context, args)\n        }, remainingTime)\n      }\n    }\n  }\n  fn.off = function () {\n    clearTimer()\n    startTime = 0\n  }\n  return fn\n}</code></pre><p data-lake-id=\"u56be573f\"><br /></p><p data-lake-id=\"ufe4d6137\"><br /></p><p data-lake-id=\"u7fafb8ef\"><br /></p><p data-lake-id=\"u6257ab44\"><br /></p><p data-lake-id=\"u6270f666\"><br /></p>",
  "body_lake": "<!doctype lake><meta name=\"doc-version\" content=\"1\" /><meta name=\"typography\" content=\"classic\" /><meta name=\"viewport\" content=\"adapt\" /><p data-lake-id=\"u35026aa9\" id=\"u35026aa9\"><span data-lake-id=\"u7a94f419\" id=\"u7a94f419\">设置了固定时间触发的时候，在触发高频事件的过程中，如果达到了设置的时间间隔，将执行 </span><code data-lake-id=\"uc15a9732\" id=\"uc15a9732\"><span data-lake-id=\"u88dc2b5e\" id=\"u88dc2b5e\">1</span></code><span data-lake-id=\"u4c09cd3f\" id=\"u4c09cd3f\"> 次</span></p><p data-lake-id=\"u7e07b8b8\" id=\"u7e07b8b8\"><span data-lake-id=\"u1f626607\" id=\"u1f626607\">​</span><br></p><p data-lake-id=\"ue003aacd\" id=\"ue003aacd\"><span data-lake-id=\"ud807b58a\" id=\"ud807b58a\">常用场景: </span><code data-lake-id=\"u3f0c9524\" id=\"u3f0c9524\"><span data-lake-id=\"u966c04a9\" id=\"u966c04a9\">resize</span></code><span data-lake-id=\"u37a5a1d5\" id=\"u37a5a1d5\">、</span><code data-lake-id=\"ub45cd88b\" id=\"ub45cd88b\"><span data-lake-id=\"ueccd0ffc\" id=\"ueccd0ffc\">scroll</span></code><span data-lake-id=\"u369ece1c\" id=\"u369ece1c\"> 等一定会触发的高频事件中</span></p><h2 data-lake-id=\"WuORS\" id=\"WuORS\"><span data-lake-id=\"u84a2af87\" id=\"u84a2af87\">初级版</span></h2><ul list=\"u54e0bc38\"><li fid=\"u8a4eae91\" data-lake-id=\"u07c7d9c9\" id=\"u07c7d9c9\"><span data-lake-id=\"ufc52b9b4\" id=\"ufc52b9b4\">第一次立即执行, 时间戳法</span></li></ul><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22function%20throttle(fn%2C%20wait)%20%7B%5Cn%20%20let%20prev%20%3D%200%5Cn%20%20return%20function(...args)%20%7B%5Cn%20%20%20%20let%20context%20%3D%20this%5Cn%20%20%20%20if%20(Date.now()%20-%20prev%20%3E%20wait)%20%7B%5Cn%20%20%20%20%20%20fn.apply(context%2C%20args)%5Cn%20%20%20%20%20%20prev%20%3D%20Date.now()%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22name%22%3A%22%E6%97%B6%E9%97%B4%E6%88%B3%E6%B3%95%20-%3E%20%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%89%A7%E8%A1%8C%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22One%20Dark%20Pro%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22frfwY%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><ul list=\"uf5059700\"><li fid=\"uf183f2db\" data-lake-id=\"u05e7cc5e\" id=\"u05e7cc5e\"><span data-lake-id=\"u61e1cde9\" id=\"u61e1cde9\">第一次不立即执行, 定时器法</span></li></ul><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22function%20throttle(fn%2C%20wait)%20%7B%5Cn%20%20let%20timer%5Cn%20%20return%20function%20(...args)%20%7B%5Cn%20%20%20%20let%20context%20%3D%20this%5Cn%20%20%20%20if%20(timer)%20return%5Cn%20%20%20%20timer%20%3D%20setTimeout(()%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20fn.apply(context%2C%20args)%5Cn%20%20%20%20%20%20timer%20%3D%20null%5Cn%20%20%20%20%7D%2C%20wait)%5Cn%20%20%7D%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22name%22%3A%22%E5%AE%9A%E6%97%B6%E5%99%A8%E6%B3%95%20-%3E%20%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8D%E6%89%A7%E8%A1%8C%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22One%20Dark%20Pro%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22mzKNY%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><ul list=\"ub692fa5d\"><li fid=\"u89f49b60\" data-lake-id=\"u145c8be0\" id=\"u145c8be0\"><span data-lake-id=\"u26219366\" id=\"u26219366\">结合时间戳法和定时器法, 保证第一次和最后一次都执行</span></li></ul><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22function%20throttle(fn%2C%20wait)%20%7B%5Cn%20%20let%20timer%5Cn%20%20let%20startTime%20%3D%20Date.now()%5Cn%20%20return%20function(...args)%20%7B%5Cn%20%20%20%20let%20currentTime%20%3D%20Date.now()%5Cn%20%20%20%20let%20remainingTime%20%3D%20wait%20-%20(currentTime%20-%20startTime%C3%8F)%5Cn%20%20%20%20let%20context%20%3D%20this%5Cn%20%20%20%20if%20(timer)%20clearTimeout(timer)%5Cn%20%20%20%20if%20(remainingTime%20%3C%3D%200)%20%7B%5Cn%20%20%20%20%20%20fn.apply(context%2C%20args)%5Cn%20%20%20%20%20%20startTime%20%3D%20Date.now()%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20timer%20%3D%20setTimeout(fn%2C%20remainingTime)%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22name%22%3A%22%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%92%8C%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E9%83%BD%E6%89%A7%E8%A1%8C%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22One%20Dark%20Pro%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22bym7e%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h2 data-lake-id=\"Dv6Kz\" id=\"Dv6Kz\"><span data-lake-id=\"u2078993b\" id=\"u2078993b\">包含立即执行和结束后执行1次开关并且带有取消功能</span></h2><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22%2F**%5Cn*%20%40desc%20fn%20%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%5Cn*%20%40desc%20wait%20%E7%AD%89%E5%BE%85%E4%BA%8B%E4%BB%B6%5Cn*%20%40desc%20immediate%20%E6%98%AF%E5%90%A6%E7%AB%8B%E5%8D%B3%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1%5Cn*%20%40desc%20trail%20%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9D%9F%E5%90%8E%E6%98%AF%E5%90%A6%E5%86%8D%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1%5Cn*%2F%5Cnfunction%20throttle(fn%2C%20wait%2C%20immediate%2C%20trail)%20%7B%5Cn%20%20let%20timer%5Cn%20%20let%20startTime%20%3D%200%5Cn%20%20let%20clearTimer%20%3D%20()%20%3D%3E%20%7B%5Cn%20%20%20%20clearTimeout(timer)%5Cn%20%20%20%20timer%20%3D%20null%5Cn%20%20%7D%5Cn%20%20let%20fn%20%3D%20function%20(...args)%20%7B%5Cn%20%20%20%20let%20context%20%3D%20this%5Cn%20%20%20%20if%20(!prev%20%26%26%20!immediate)%20%7B%5Cn%20%20%20%20%20%20startTime%20%3D%20Date.now()%5Cn%20%20%20%20%7D%5Cn%20%20%20%20let%20remainingTime%20%3D%20wait%20-%20(Date.now()%20-%20startTime)%5Cn%20%20%20%20if%20(timer)%20clearTimer()%5Cn%20%20%20%20if%20(!timer)%20%7B%5Cn%20%20%20%20%20%20if%20(remainingTime%20%3C%3D%200%20%7C%7C%20remainingTime%20%3E%20wait)%20%7B%5Cn%20%20%20%20%20%20%20%20startTime%20%3D%20Date.now()%5Cn%20%20%20%20%20%20%20%20fn.apply(context%2C%20args)%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if%20(trail)%20%7B%5Cn%20%20%20%20%20%20%20%20timer%20%3D%20setTimeout(()%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20startTime%20%3D%20immediate%20%3F%200%20%3A%20Date.now()%5Cn%20%20%20%20%20%20%20%20%20%20timer%20%3D%20null%5Cn%20%20%20%20%20%20%20%20%20%20fn.apply(context%2C%20args)%5Cn%20%20%20%20%20%20%20%20%7D%2C%20remainingTime)%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20fn.off%20%3D%20function%20()%20%7B%5Cn%20%20%20%20clearTimer()%5Cn%20%20%20%20startTime%20%3D%200%5Cn%20%20%7D%5Cn%20%20return%20fn%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22One%20Dark%20Pro%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22Dgrd1%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><p data-lake-id=\"u56be573f\" id=\"u56be573f\"><br></p><p data-lake-id=\"ufe4d6137\" id=\"ufe4d6137\"><br></p><p data-lake-id=\"u7fafb8ef\" id=\"u7fafb8ef\"><br></p><p data-lake-id=\"u6257ab44\" id=\"u6257ab44\"><br></p><p data-lake-id=\"u6270f666\" id=\"u6270f666\"><br></p>",
  "body_draft_lake": "",
  "public": 0,
  "status": 1,
  "view_status": 0,
  "read_status": 1,
  "likes_count": 0,
  "comments_count": 0,
  "content_updated_at": "2022-04-04T11:35:08.000Z",
  "deleted_at": null,
  "created_at": "2022-04-04T11:35:08.000Z",
  "updated_at": "2022-05-10T15:16:50.000Z",
  "published_at": "2022-04-04T11:35:08.000Z",
  "first_published_at": "2022-04-04T11:35:08.086Z",
  "word_count": 404,
  "cover": null,
  "description": "设置了固定时间触发的时候，在触发高频事件的过程中，如果达到了设置的时间间隔，将执行 1 次常用场景: resize、scroll 等一定会触发的高频事件中初级版第一次立即执行, 时间戳法function throttle(fn, wait) {   let prev = 0   return ...",
  "custom_description": null,
  "hits": 0,
  "_serializer": "v2.doc_detail"
}