{
  "id": 11465923,
  "slug": "vy4087",
  "title": "文档索引",
  "book_id": 24988551,
  "book": {
    "id": 24988551,
    "type": "Book",
    "slug": "qy29pt",
    "name": "数据库相关知识",
    "user_id": 732231,
    "description": "数据库相关知识，如：MongoDB、MySQL",
    "creator_id": 732231,
    "public": 0,
    "items_count": 2,
    "likes_count": 0,
    "watches_count": 1,
    "content_updated_at": "2022-03-13T10:00:48.648Z",
    "updated_at": "2023-11-11T18:10:22.000Z",
    "created_at": "2022-03-03T15:29:23.000Z",
    "namespace": "wcywxq/qy29pt",
    "user": {
      "id": 732231,
      "type": "User",
      "login": "wcywxq",
      "name": "magic",
      "description": null,
      "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
      "books_count": 18,
      "public_books_count": 0,
      "followers_count": 0,
      "following_count": 0,
      "created_at": "2020-01-08T14:21:31.000Z",
      "updated_at": "2023-11-13T09:32:35.000Z",
      "_serializer": "v2.user"
    },
    "_serializer": "v2.book"
  },
  "user_id": 732231,
  "creator": {
    "id": 732231,
    "type": "User",
    "login": "wcywxq",
    "name": "magic",
    "description": null,
    "avatar_url": "https://cdn.nlark.com/yuque/0/2020/png/732231/1606968271774-avatar/886ad88b-d2cc-4c9e-a674-f70eb51a679c.png",
    "books_count": 18,
    "public_books_count": 0,
    "followers_count": 0,
    "following_count": 0,
    "created_at": "2020-01-08T14:21:31.000Z",
    "updated_at": "2023-11-13T09:32:35.000Z",
    "_serializer": "v2.user"
  },
  "format": "lake",
  "body": "`mongodb` 是一种非关系型数据库，不必写 `sql` 语句，其操作类似于 `json` ，方便后端工作者进行开发。\n\n`mongoose` 是一种 `mongodb` 的 `orm` 框架，方便操作和使用，其中，`Schema` 是关键。\n<a name=\"485b8bb7\"></a>\n## 一、常用命令：\n| 常用命令 | 介绍 |\n| --- | --- |\n| `show dbs` | 显示数据库列表 |\n| `show collections` | 显示当前数据库中的集合（类似数据库中的表） |\n| `show users` | 显示用户 |\n| `use <db name>` | 切换/创建当前数据库 |\n| `db.help()` | 显示数据库操作命令 |\n| `db.dropDatabase()` | 删除当前使用数据库 |\n| `db.createCollection()` | 创建一个集合(表) |\n| `db/db.getName()` | 查看当前所在数据库 |\n| `db.user.findOne()` | 查询第一条数据 |\n| `load()` | 加载文件 |\n\n\n<a name=\"ebb75e45\"></a>\n### 1. find 查找\n\n> `@params: [条件，指定打印字段的名称]`\n\n\n- 查找 【`age >= 20` 并且 `age <= 30` 的】数据\n\n```javascript\ndb.user.find({ \n  age: {\n    $gte: 20, \n    $lte: 30\n  } \n}, { \n  name: true, \n  age: true, \n  _id: false \n})\n```\n\n- 查找【21岁 和 10岁的】数据\n\n```javascript\ndb.user.find({\n  age: {\n    $in: [21, 10]\n  }\n}, {\n  name: true, \n  age: true, \n  _id: false\n})\n```\n\n- 查找 【 要么 `age <= 10`，要么 `pc.brand = 'IBM'` 】的数据\n\n> 与或非：`$and, $or, $not`\n\n\n```javascript\ndb.user.find({ \n  $or: [age: { $lte: 10, 'pc.brand': 'IBM' }]\n}, { name: true, age: true, _id: false })\n```\n\n- 数组查询：查找【喜欢篮球和敲代码的】数据\n\n> `$all`：全部满足查询，`$in`：满足任意一个条件查询，`$size`：根据个数查询\n\n\n```javascript\ndb.user.find({\n    hobby: { $all: ['篮球', '敲代码'] }\n}, {name: true, age: true, _id: false})\n```\n\n- 分页查询：\n\n> `limit`：每次查询几条，`skip`：从第几条开始，`sort`：排序方式(-1：降序，1：升序)\n\n\n```javascript\ndb.user.find({}, {name: true, age: true, _id: false})\n  .limit(1).skip(0).sort({ age: -1 })\n```\n\n- 逐条打印 `forEach`\n\n```javascript\nvar db = connect('me')\nvar userlist = db.user.find()\nuserlist.forEach(user => {\n    /** 业务逻辑处理 if else */\n    printjson(user)\n})\n```\n\n<a name=\"0e2d7f46\"></a>\n### 2. update 更新\n\n> `db.user.update(条件, 方法)`\n\n\n- `$inc`：进行加减操作\n- `$set`：修改一个指定的`key`值\n\n```javascript\n//\t修改数组中的某个元素的值\ndb.user.update({name: \"xiaofeng\"}, {$set: { 'age.0': 40 }})\n```\n\n- `$unset` ：删除一个`key`值和对应的`value`值\n- `upsert` ： 如果当前找不到这个值， 那么就插入这个值\n\n```javascript\ndb.user.update({name: \"xiaofeng\"}, {$set: {age: 10}}, {upsert: true})\n```\n\n- `multi`：给所有数据都增加属性 如果为`false`或者不加那么只有第一条数据会加\n\n```javascript\ndb.user.update({}, {$set: {hobby: []}}, {multi: true})\n```\n\n- `$push`：给数组字段里增加一个新的元素\n\n```javascript\ndb.user.update({name: \"xiaowu\"}, {$push: {hobby: \"吃鸡\"}})\n```\n\n- `$addToSet` ： 查找是否存在，如果不存在则`push`进去，如果存在则不`push`\n- `$each`：在数组中插入多个元素\n\n```javascript\n//\t在数组中插入多个元素\nvar newHobby = [\"鸡\", \"鸭\", \"鹅\"]\ndb.user.update({name: \"wxq\"}, {$addToSet: { hobby: {$each: newHobby} }})\n```\n\n- `findAndModify` ： 有返回值，可以根据返回值来进行逻辑处理\n\n```javascript\n//\t应答式的修改方法\nvar modify = {\n    findAndModify: \"user\",\n    query: {name: 'wxq'},\n    update: {$set: {age: 21}},\n    new: true\t//\ttrue：返回修改之后的值，false：返回修改之前的值\n}\nvar result = db.runCommand(modify)\nprintjson(result)\n```\n\n<a name=\"ed7b6691\"></a>\n### 3. 插入 insert\n\n> 使用`insert()`或`save()`方法向集合中插入文档。如果不指定`_id`字段，`save()`方法类似`insert()`方法；如果指定`_id`字段，则会更新该`_id`的数据。\n\n\n<a name=\"ee980e02\"></a>\n### 4. 删除\n\n```javascript\ndb.collection.drop()\n```\n\n<a name=\"b271e427\"></a>\n### 索引\n\n> 建立索引可以提高查询效率，不是所有的情况都要建立索引；\n> 当频繁查询数据时常用。\n\n\n- 建立索引：\n\n```javascript\ndb.tel.ensureIndex({tel: 1})\n```\n\n- 获取索引：\n\n```javascript\ndb.tel.getIndexes()\n```\n\n- 删除索引：\n\n```javascript\ndb.tel.dropIndex({tel: 1})\n```\n\n<a name=\"0031f16b\"></a>\n## 二、mongoose\n\n> **介绍：**`Mongoose`是`MongoDB`的一个对象模型工具，是基于`node-mongodb-native`开发的`MongoDB nodejs`驱动，可以在**异步的环境下执行**。同时它也是针对`MongoDB`操作的一个对象模型库，封装了`MongoDB`对文档的的一些增删改查等常用方法，让`NodeJS`操作`Mongodb`数据库变得更加**灵活简单**。\n\n\n<a name=\"cf148000\"></a>\n### 1、安装\n\n> `npm install mongoose`\n\n\n<a name=\"d3997a03\"></a>\n### 2、数据库连接\n\n```javascript\n// 初始化mongoose\nconst mongoose = require('mongoose');\nconst db = 'mongodb://localhost/shop';\n\nexports.connect = () => {\n    // 连接数据库\n    mongoose.connect(db, {\n        useNewUrlParser: true // 解析url\n    })\n    // 监听数据库连接\n    mongoose.connection.on('disconnected', () => {\n        mongoose.connect(db);\n    })\n    // 数据库出错\n    mongoose.connection.on('error', error => {\n        console.log(error)\n        mongoose.connect(db);\n    })\n    // 连接的时候\n    mongoose.connection.once('open', () => {\n        console.log('mongoodb connected success')\n    })\n}\n```\n\n<a name=\"94072740\"></a>\n### 3、Schema\n\n<a name=\"2e6c91e8\"></a>\n#### 3.1 定义一个 Schema\n\n> **介绍**：数据属性模型(传统意义的表结构)，又或着是“集合”的模型骨架。\n\n\n```javascript\nvar mongoose = require('mongoose');\nvar TestSchema = new mongoose.Schema({\n  \tname: { type: String, unique: true },// unique: true代表当前用户名是唯一的\n\tage: { type: Number, default: 18 },\n  \tgender: { type: Boolean, default: true }\n})\n```\n\n<a name=\"ce95eeef\"></a>\n#### 3.2\tModel\n\n> **介绍**：由`Schema`构造生成的模型，除了`Schema`定义的数据库骨架以外，还具有数据库操作行为，类似于管理数据库属性、行为的类\n> 创建`Model`模型，需要指定：**1.集合名称，2.集合的**`**Schema**`**结构对象**\n\n\n```javascript\n// 创建Model\nvar TestModel = mongoose.model(\"test1\", TestSchema);\n```\n\n> `test1`：数据库中的集合名称，当我们对其添加数据时如果`test1`已经存在，则会保存到其目录下，如果未存在，则会创建`test1`集合，然后在保存数据。\n\n\n<a name=\"3011837c\"></a>\n#### 3.3 Entity\n\n> **介绍**：由`Model`创建的实体，使用`save`方法保存数据，`Model`和`Entity`都有能影响数据库的操作，但`Model`比`Entity`更具操作性。\n\n\n```javascript\n// 创建Entity\nvar TestEntity = new TestModel({\n       name : \"Lenka\",\n       age  : 36,\n       email: \"lenka@qq.com\"\n});\nconsole.log(TestEntity.name); // Lenka\nconsole.log(TestEntity.age); // 36\n```\n\n<a name=\"b279dbc0\"></a>\n#### 3.4\t创建集合\n\n```javascript\nvar mongoose = require('mongoose')\nmongoose.connect('mongodb://127.0.0.1:27017/test')\nmongoose.connection.on('connected', function() {\n\tconsole.log('yes')\n})\n\nvar TestSchema = new mongoose.Schema({\n\tname: { type: String },\n  \tage: { type: Number, default: 0 },\n  \temail: { type: String },\n  \ttime: { type: Date, defaultL: Date.now }\n})\n\nvar TestModel = mongoose.model('test1', TestSchema)\n\nvar TestEntity = new TestModel({\n\tname: 'zs',\n  \tage: 20,\n  \temail: 'aa@bb.com'\n})\nTestEntity.save(function(error, doc) {\n\tif(error) {\n    \tconsole.log(\"error:\" + error)\n    } else {\n    \tconsole.log(doc)\n    }\n})\n```\n\n<a name=\"bb03aec3\"></a>\n### 4、操作\n\n<a name=\"4e874710\"></a>\n#### 4.1 查询\n\n<a name=\"7a1dc02c\"></a>\n##### 4.1.1 find 基本查询\n\n> `obj.find(查询条件, callback)`\n\n\n<a name=\"8fe7015f\"></a>\n##### 4.1.2 find 过滤查询\n\n- 属性过滤\n> `find(Conditions, field, callback)`，其中`field`省略或者设置为`null`，则返回所有属性\n\n\n<a name=\"21958309\"></a>\n##### 4.1.3 单条数据查询\n\n- `findOne`\n\n> `findOne(Conditions, callback)`，注意：只返回第一个符合条件的文档数据\n\n\n- `findById`\n> `findById(_id, callback)`，注意：只接受文档的`_id`作为参数\n\n\n<a name=\"1240c168\"></a>\n#### 4.2 Model 保存\n\n- `Model.create(文档数据, callback)`\n\n<a name=\"182385ff\"></a>\n#### 4.3 entity 保存\n\n```javascript\nvar Entity = new Model({ name: \"zs\", age: 27 })\nEntity.save(function(error, doc) {\n    if(error) {\n        console.log(error)\n    } else {\n        console.log(doc)\n    }\n})\n```\n\n<a name=\"96ba815e\"></a>\n#### 4.4 数据更新\n\n- `obj.update(查询条件, 更新对象, callback)`\n\n<a name=\"274dbed5\"></a>\n#### 4.5 数据删除\n\n- `obj.remove(查询条件, callback)`\n",
  "body_draft": "",
  "body_html": "<!doctype html><div class=\"lake-content\" typography=\"traditional\"><p id=\"a20d224c568e48b9d67847a2c66a8c01_p_0\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">mongodb</span></code><span class=\"ne-text\"> 是一种非关系型数据库，不必写 </span><code class=\"ne-code\"><span class=\"ne-text\">sql</span></code><span class=\"ne-text\"> 语句，其操作类似于 </span><code class=\"ne-code\"><span class=\"ne-text\">json</span></code><span class=\"ne-text\"> ，方便后端工作者进行开发。</span></p><p id=\"0c4d068e4aede2bc9d552ce387999b01_p_4\" class=\"ne-p\"><br></p><p id=\"1be1eeca63aa45c0a89fd9c8eb131b02_p_5\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">mongoose</span></code><span class=\"ne-text\"> 是一种 </span><code class=\"ne-code\"><span class=\"ne-text\">mongodb</span></code><span class=\"ne-text\"> 的 </span><code class=\"ne-code\"><span class=\"ne-text\">orm</span></code><span class=\"ne-text\"> 框架，方便操作和使用，其中，</span><code class=\"ne-code\"><span class=\"ne-text\">Schema</span></code><span class=\"ne-text\"> 是关键。</span></p><h2 id=\"485b8bb7\"><span class=\"ne-text\">一、常用命令：</span></h2><table id=\"2392904a\" class=\"ne-table\" style=\"width: 750px\"><tbody><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u4ec147b5\" class=\"ne-p\"><span class=\"ne-text\">常用命令</span></p></td><td width=\"375\"><p id=\"uc1300c00\" class=\"ne-p\"><span class=\"ne-text\">介绍</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"ue69fbdba\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">show dbs</span></code></p></td><td width=\"375\"><p id=\"u980f663e\" class=\"ne-p\"><span class=\"ne-text\">显示数据库列表</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u67d49c9e\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">show collections</span></code></p></td><td width=\"375\"><p id=\"ue36f57bc\" class=\"ne-p\"><span class=\"ne-text\">显示当前数据库中的集合（类似数据库中的表）</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u1b265523\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">show users</span></code></p></td><td width=\"375\"><p id=\"ubeb39a72\" class=\"ne-p\"><span class=\"ne-text\">显示用户</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u773977b2\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">use &lt;db name&gt;</span></code></p></td><td width=\"375\"><p id=\"u1b513695\" class=\"ne-p\"><span class=\"ne-text\">切换/创建当前数据库</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"ue264c382\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">db.help()</span></code></p></td><td width=\"375\"><p id=\"u8c4dd2ca\" class=\"ne-p\"><span class=\"ne-text\">显示数据库操作命令</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u99875ae4\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">db.dropDatabase()</span></code></p></td><td width=\"375\"><p id=\"u187fe4ed\" class=\"ne-p\"><span class=\"ne-text\">删除当前使用数据库</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"ubdc8f2f3\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">db.createCollection()</span></code></p></td><td width=\"375\"><p id=\"udab8e9e0\" class=\"ne-p\"><span class=\"ne-text\">创建一个集合(表)</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u3873b800\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">db/db.getName()</span></code></p></td><td width=\"375\"><p id=\"uf2029eb1\" class=\"ne-p\"><span class=\"ne-text\">查看当前所在数据库</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u6a040ae6\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">db.user.findOne()</span></code></p></td><td width=\"375\"><p id=\"u8e147f00\" class=\"ne-p\"><span class=\"ne-text\">查询第一条数据</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u3dde56e9\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">load()</span></code></p></td><td width=\"375\"><p id=\"ube2b5f3c\" class=\"ne-p\"><span class=\"ne-text\">加载文件</span></p></td></tr></tbody></table><p id=\"f23fb9c519ff30bfe03d0b2cc2cac85d_p_6\" class=\"ne-p\"><br></p><h3 id=\"ebb75e45\"><span class=\"ne-text\">1. find 查找</span></h3><p id=\"e1b0979b54c1fb29acc1d92ad2159922_p_7\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"cba62c1edb20d1f703ba9c811af81d2a_p_8\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">@params: [条件，指定打印字段的名称]</span></code></p></div><p id=\"eadc4ec477465f1f239730d987d394b1_p_9\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"c544d393a313442b38d7e244085cdc69_li_3\"><span class=\"ne-text\">查找 【</span><code class=\"ne-code\"><span class=\"ne-text\">age &gt;= 20</span></code><span class=\"ne-text\"> 并且 </span><code class=\"ne-code\"><span class=\"ne-text\">age &lt;= 30</span></code><span class=\"ne-text\"> 的】数据</span></li></ul><p id=\"042da541aac17f869693ba89ebd10d8e_p_10\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"91951a7f\" class=\"ne-codeblock language-javascript\">db.user.find({ \n  age: {\n    $gte: 20, \n    $lte: 30\n  } \n}, { \n  name: true, \n  age: true, \n  _id: false \n})</pre><p id=\"828bea0262f636b25c97fbef525aed20_p_11\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"d400ad5b3883d7327b9e8fce48627311_li_4\"><span class=\"ne-text\">查找【21岁 和 10岁的】数据</span></li></ul><p id=\"09a2b5671cf447a1a3529d71c89cf9e1_p_12\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"5583174e\" class=\"ne-codeblock language-javascript\">db.user.find({\n  age: {\n    $in: [21, 10]\n  }\n}, {\n  name: true, \n  age: true, \n  _id: false\n})</pre><p id=\"2369fafe89fae403079018df6f36b51b_p_13\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"6c0d01b555538169bca5a51850c916d1_li_5\"><span class=\"ne-text\">查找 【 要么 </span><code class=\"ne-code\"><span class=\"ne-text\">age &lt;= 10</span></code><span class=\"ne-text\">，要么 </span><code class=\"ne-code\"><span class=\"ne-text\">pc.brand = 'IBM'</span></code><span class=\"ne-text\"> 】的数据</span></li></ul><p id=\"7cf79ceeaaf91ef14264b4c55c1c8c1d_p_14\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"15e08fa08208b9badd966b4ec1de2c09_p_15\" class=\"ne-p\"><span class=\"ne-text\">与或非：</span><code class=\"ne-code\"><span class=\"ne-text\">$and, $or, $not</span></code></p></div><p id=\"42752743bc6d3f9f6c928fb47989b8c2_p_16\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"9b6cfc91\" class=\"ne-codeblock language-javascript\">db.user.find({ \n  $or: [age: { $lte: 10, 'pc.brand': 'IBM' }]\n}, { name: true, age: true, _id: false })</pre><p id=\"c5eaf555cee01ec836fc749258c6179d_p_17\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"5c593f90559b4ce2eb6f3e648787bda9_li_6\"><span class=\"ne-text\">数组查询：查找【喜欢篮球和敲代码的】数据</span></li></ul><p id=\"3f8949dd5527f0c9624c3fd3faefb76f_p_18\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"7c65ff855596b0bf2d92b8593ba61cfc_p_19\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">$all</span></code><span class=\"ne-text\">：全部满足查询，</span><code class=\"ne-code\"><span class=\"ne-text\">$in</span></code><span class=\"ne-text\">：满足任意一个条件查询，</span><code class=\"ne-code\"><span class=\"ne-text\">$size</span></code><span class=\"ne-text\">：根据个数查询</span></p></div><p id=\"db841a6e995b001085603629a3ace379_p_20\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"90618017\" class=\"ne-codeblock language-javascript\">db.user.find({\n    hobby: { $all: ['篮球', '敲代码'] }\n}, {name: true, age: true, _id: false})</pre><p id=\"54d418504a63791b75a5f497078fa24a_p_21\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"1662455bb19a580cf4b4d9ebcbfa971c_li_7\"><span class=\"ne-text\">分页查询：</span></li></ul><p id=\"37928cd1f32681ee4810a9ab9d3c1104_p_22\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"a4ecc0472d21335c4ebb7b2d3f2bb55a_p_23\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">limit</span></code><span class=\"ne-text\">：每次查询几条，</span><code class=\"ne-code\"><span class=\"ne-text\">skip</span></code><span class=\"ne-text\">：从第几条开始，</span><code class=\"ne-code\"><span class=\"ne-text\">sort</span></code><span class=\"ne-text\">：排序方式(-1：降序，1：升序)</span></p></div><p id=\"1f3b4b4a4867a8b756c196b38558d0c4_p_24\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"a7713c62\" class=\"ne-codeblock language-javascript\">db.user.find({}, {name: true, age: true, _id: false})\n  .limit(1).skip(0).sort({ age: -1 })</pre><p id=\"3afe72986fc83f6913935faccbcf69b2_p_25\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"cdfbb21ac5b6a90b254261593db3c6a5_li_8\"><span class=\"ne-text\">逐条打印 </span><code class=\"ne-code\"><span class=\"ne-text\">forEach</span></code></li></ul><p id=\"b57de0a6a045efefe71d109094be9ddc_p_26\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"764df917\" class=\"ne-codeblock language-javascript\">var db = connect('me')\nvar userlist = db.user.find()\nuserlist.forEach(user =&gt; {\n    /** 业务逻辑处理 if else */\n    printjson(user)\n})</pre><p id=\"4cc44302cfe9be1836a49b383f7e914f_p_27\" class=\"ne-p\"><br></p><h3 id=\"0e2d7f46\"><span class=\"ne-text\">2. update 更新</span></h3><p id=\"d17d837b16c49a0e5c21edc18722e410_p_28\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"1595915121f042f5f79cba077b58d670_p_29\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">db.user.update(条件, 方法)</span></code></p></div><p id=\"d657ac1e4c3211af4f7dcea889518735_p_30\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"283580dcfbd0517bc1345c255f7c5390_li_9\"><code class=\"ne-code\"><span class=\"ne-text\">$inc</span></code><span class=\"ne-text\">：进行加减操作</span></li></ul><ul class=\"ne-ul\"><li id=\"c474c27c576f57ded9730cb4fafb857e_li_10\"><code class=\"ne-code\"><span class=\"ne-text\">$set</span></code><span class=\"ne-text\">：修改一个指定的</span><code class=\"ne-code\"><span class=\"ne-text\">key</span></code><span class=\"ne-text\">值</span></li></ul><p id=\"e2e9b10bfede90e88bd47291199e0b55_p_31\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"a2c86750\" class=\"ne-codeblock language-javascript\">//\t修改数组中的某个元素的值\ndb.user.update({name: &quot;xiaofeng&quot;}, {$set: { 'age.0': 40 }})</pre><p id=\"bb3e20f1faeaf6bf9497bffd7f381295_p_32\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"a5bfaa22d44e846fffc4d5ffb5c9bea3_li_11\"><code class=\"ne-code\"><span class=\"ne-text\">$unset</span></code><span class=\"ne-text\"> ：删除一个</span><code class=\"ne-code\"><span class=\"ne-text\">key</span></code><span class=\"ne-text\">值和对应的</span><code class=\"ne-code\"><span class=\"ne-text\">value</span></code><span class=\"ne-text\">值</span></li></ul><ul class=\"ne-ul\"><li id=\"26b764a908e5fa9062a566ca7d0dede8_li_12\"><code class=\"ne-code\"><span class=\"ne-text\">upsert</span></code><span class=\"ne-text\"> ： 如果当前找不到这个值， 那么就插入这个值</span></li></ul><p id=\"73b74e66f7d869f94eb34b57d63eae3f_p_33\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"c2b5a48e\" class=\"ne-codeblock language-javascript\">db.user.update({name: &quot;xiaofeng&quot;}, {$set: {age: 10}}, {upsert: true})</pre><p id=\"39abba9494ef6da94608fbd0e487aa60_p_34\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"0ac08a61bce41b0b6b4a094e606f438d_li_13\"><code class=\"ne-code\"><span class=\"ne-text\">multi</span></code><span class=\"ne-text\">：给所有数据都增加属性 如果为</span><code class=\"ne-code\"><span class=\"ne-text\">false</span></code><span class=\"ne-text\">或者不加那么只有第一条数据会加</span></li></ul><p id=\"86d045d193aa7ac4616d4ea50a0dc92f_p_35\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"13cbf582\" class=\"ne-codeblock language-javascript\">db.user.update({}, {$set: {hobby: []}}, {multi: true})</pre><p id=\"6f8f966688575a1f666bafa122494f73_p_36\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"5348a9513557021f90bd1792d9cc5742_li_14\"><code class=\"ne-code\"><span class=\"ne-text\">$push</span></code><span class=\"ne-text\">：给数组字段里增加一个新的元素</span></li></ul><p id=\"ab57135091a86c42cc63ec67ac068a45_p_37\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"3099f157\" class=\"ne-codeblock language-javascript\">db.user.update({name: &quot;xiaowu&quot;}, {$push: {hobby: &quot;吃鸡&quot;}})</pre><p id=\"82f45866a429f6224b2e92c65bfda254_p_38\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"d17fb336492eed12daf987625c030393_li_15\"><code class=\"ne-code\"><span class=\"ne-text\">$addToSet</span></code><span class=\"ne-text\"> ： 查找是否存在，如果不存在则</span><code class=\"ne-code\"><span class=\"ne-text\">push</span></code><span class=\"ne-text\">进去，如果存在则不</span><code class=\"ne-code\"><span class=\"ne-text\">push</span></code></li></ul><ul class=\"ne-ul\"><li id=\"f9c92b76a83c4ff3e87f45bf0dfc8326_li_16\"><code class=\"ne-code\"><span class=\"ne-text\">$each</span></code><span class=\"ne-text\">：在数组中插入多个元素</span></li></ul><p id=\"faade82d6cfe8ed09f505bc5d9204fda_p_39\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"12ccff57\" class=\"ne-codeblock language-javascript\">//\t在数组中插入多个元素\nvar newHobby = [&quot;鸡&quot;, &quot;鸭&quot;, &quot;鹅&quot;]\ndb.user.update({name: &quot;wxq&quot;}, {$addToSet: { hobby: {$each: newHobby} }})</pre><p id=\"17b412f9fc3ec51ada5f566f0d09108c_p_40\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"3d34b3282872d00df5172cff4ccffa33_li_17\"><code class=\"ne-code\"><span class=\"ne-text\">findAndModify</span></code><span class=\"ne-text\"> ： 有返回值，可以根据返回值来进行逻辑处理</span></li></ul><p id=\"d9d31f80b21bee6005ee4bb0be1d9a6b_p_41\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"d27df91d\" class=\"ne-codeblock language-javascript\">//\t应答式的修改方法\nvar modify = {\n    findAndModify: &quot;user&quot;,\n    query: {name: 'wxq'},\n    update: {$set: {age: 21}},\n    new: true\t//\ttrue：返回修改之后的值，false：返回修改之前的值\n}\nvar result = db.runCommand(modify)\nprintjson(result)</pre><p id=\"aebb7af96a9ee3c9b7a669f28fef1d7e_p_42\" class=\"ne-p\"><br></p><h3 id=\"ed7b6691\"><span class=\"ne-text\">3. 插入 insert</span></h3><p id=\"4930f2b57b08d977b4a7a79433f23490_p_43\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"d9b903f25e263d2819a32064e4bf1a49_p_44\" class=\"ne-p\"><span class=\"ne-text\">使用</span><code class=\"ne-code\"><span class=\"ne-text\">insert()</span></code><span class=\"ne-text\">或</span><code class=\"ne-code\"><span class=\"ne-text\">save()</span></code><span class=\"ne-text\">方法向集合中插入文档。如果不指定</span><code class=\"ne-code\"><span class=\"ne-text\">_id</span></code><span class=\"ne-text\">字段，</span><code class=\"ne-code\"><span class=\"ne-text\">save()</span></code><span class=\"ne-text\">方法类似</span><code class=\"ne-code\"><span class=\"ne-text\">insert()</span></code><span class=\"ne-text\">方法；如果指定</span><code class=\"ne-code\"><span class=\"ne-text\">_id</span></code><span class=\"ne-text\">字段，则会更新该</span><code class=\"ne-code\"><span class=\"ne-text\">_id</span></code><span class=\"ne-text\">的数据。</span></p></div><p id=\"0e4b859961c17882302ca1144adad96d_p_45\" class=\"ne-p\"><br></p><h3 id=\"ee980e02\"><span class=\"ne-text\">4. 删除</span></h3><p id=\"e81b6efc8e2153cf8aa53e3b04d7f22c_p_46\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"0bddfe0c\" class=\"ne-codeblock language-javascript\">db.collection.drop()</pre><p id=\"478231c71c811ff5f728eef1ada97581_p_47\" class=\"ne-p\"><br></p><h3 id=\"b271e427\"><span class=\"ne-text\">索引</span></h3><p id=\"aa95668f5a65b03373d1b0b3f9f8d3a6_p_48\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"65d964c76e344b8ca35cbd065392a548_p_49\" class=\"ne-p\"><span class=\"ne-text\">建立索引可以提高查询效率，不是所有的情况都要建立索引；</span></p><p id=\"8fd54d81002f2dffa7def646886e83cf_p_50\" class=\"ne-p\"><span class=\"ne-text\">当频繁查询数据时常用。</span></p></div><p id=\"d3ff43f9faa22377838e1e2c0834a861_p_51\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"ad74b5d998737e95179cc772ad0f1152_li_18\"><span class=\"ne-text\">建立索引：</span></li></ul><p id=\"bc2359f7bb1e32241fa27f528e60a125_p_52\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"c6a85205\" class=\"ne-codeblock language-javascript\">db.tel.ensureIndex({tel: 1})</pre><p id=\"0c6a7643ebb3931744a90899eb00ce0b_p_53\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"7ebe8d006bcd45baf6c49b382be52142_li_19\"><span class=\"ne-text\">获取索引：</span></li></ul><p id=\"e10b5c78ee7ba45f407740af88433fc9_p_54\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"74adceb1\" class=\"ne-codeblock language-javascript\">db.tel.getIndexes()</pre><p id=\"7188e3d4590c731c34019643bbb3ba96_p_55\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"0701f65243d16694a212e6c3b961c901_li_20\"><span class=\"ne-text\">删除索引：</span></li></ul><p id=\"a6e7204180aba568d27cc7b95d0717fd_p_56\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"a85abf9b\" class=\"ne-codeblock language-javascript\">db.tel.dropIndex({tel: 1})</pre><p id=\"67592880a847e874a0da3af4d564ef1f_p_57\" class=\"ne-p\"><br></p><h2 id=\"0031f16b\"><span class=\"ne-text\">二、mongoose</span></h2><p id=\"e3c9bad72638009a374744280c63ecc6_p_58\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"b5a926e4d1a8f49509e1c662740d3a08_p_59\" class=\"ne-p\"><strong><span class=\"ne-text\">介绍：</span></strong><code class=\"ne-code\"><span class=\"ne-text\">Mongoose</span></code><span class=\"ne-text\">是</span><code class=\"ne-code\"><span class=\"ne-text\">MongoDB</span></code><span class=\"ne-text\">的一个对象模型工具，是基于</span><code class=\"ne-code\"><span class=\"ne-text\">node-mongodb-native</span></code><span class=\"ne-text\">开发的</span><code class=\"ne-code\"><span class=\"ne-text\">MongoDB nodejs</span></code><span class=\"ne-text\">驱动，可以在</span><strong><span class=\"ne-text\">异步的环境下执行</span></strong><span class=\"ne-text\">。同时它也是针对</span><code class=\"ne-code\"><span class=\"ne-text\">MongoDB</span></code><span class=\"ne-text\">操作的一个对象模型库，封装了</span><code class=\"ne-code\"><span class=\"ne-text\">MongoDB</span></code><span class=\"ne-text\">对文档的的一些增删改查等常用方法，让</span><code class=\"ne-code\"><span class=\"ne-text\">NodeJS</span></code><span class=\"ne-text\">操作</span><code class=\"ne-code\"><span class=\"ne-text\">Mongodb</span></code><span class=\"ne-text\">数据库变得更加</span><strong><span class=\"ne-text\">灵活简单</span></strong><span class=\"ne-text\">。</span></p></div><p id=\"daa3e859dfee1b8825cb9c219dcb2526_p_60\" class=\"ne-p\"><br></p><h3 id=\"cf148000\"><span class=\"ne-text\">1、安装</span></h3><p id=\"d89d8c6a729313c0d25f9b1742c0d590_p_61\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"b3b64879140e53f2efade079bd3dff73_p_62\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">npm install mongoose</span></code></p></div><p id=\"87e34965e50e2c8e31ce44a85667e8dd_p_63\" class=\"ne-p\"><br></p><h3 id=\"d3997a03\"><span class=\"ne-text\">2、数据库连接</span></h3><p id=\"b3add770127d8c2a5064673aa8a9731f_p_64\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"f3c0e364\" class=\"ne-codeblock language-javascript\">// 初始化mongoose\nconst mongoose = require('mongoose');\nconst db = 'mongodb://localhost/shop';\n\nexports.connect = () =&gt; {\n    // 连接数据库\n    mongoose.connect(db, {\n        useNewUrlParser: true // 解析url\n    })\n    // 监听数据库连接\n    mongoose.connection.on('disconnected', () =&gt; {\n        mongoose.connect(db);\n    })\n    // 数据库出错\n    mongoose.connection.on('error', error =&gt; {\n        console.log(error)\n        mongoose.connect(db);\n    })\n    // 连接的时候\n    mongoose.connection.once('open', () =&gt; {\n        console.log('mongoodb connected success')\n    })\n}</pre><p id=\"2a81d6eed31dfd1dc3c193bbdb75c1a1_p_65\" class=\"ne-p\"><br></p><h3 id=\"94072740\"><span class=\"ne-text\">3、Schema</span></h3><p id=\"cf44cb59378505901ec625cdc88d7d91_p_66\" class=\"ne-p\"><br></p><h4 id=\"2e6c91e8\"><span class=\"ne-text\">3.1 定义一个 Schema</span></h4><p id=\"152302cc03cd3433e252fd8fbe4bade7_p_67\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"799eef9b38154811607d54bddf7db3dd_p_68\" class=\"ne-p\"><strong><span class=\"ne-text\">介绍</span></strong><span class=\"ne-text\">：数据属性模型(传统意义的表结构)，又或着是“集合”的模型骨架。</span></p></div><p id=\"956e0d4312e941b77cd57ec35c294aff_p_69\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"1c43ed0b\" class=\"ne-codeblock language-javascript\">var mongoose = require('mongoose');\nvar TestSchema = new mongoose.Schema({\n  \tname: { type: String, unique: true },// unique: true代表当前用户名是唯一的\n\tage: { type: Number, default: 18 },\n  \tgender: { type: Boolean, default: true }\n})</pre><p id=\"67523e0fa28fe87849ce38cd391e3347_p_70\" class=\"ne-p\"><br></p><h4 id=\"ce95eeef\"><span class=\"ne-text\">3.2\tModel</span></h4><p id=\"b7f5c253c3fb3956b40638fc0613cbf9_p_71\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"747f21c1332dda43dabf7534c74f1a7e_p_72\" class=\"ne-p\"><strong><span class=\"ne-text\">介绍</span></strong><span class=\"ne-text\">：由</span><code class=\"ne-code\"><span class=\"ne-text\">Schema</span></code><span class=\"ne-text\">构造生成的模型，除了</span><code class=\"ne-code\"><span class=\"ne-text\">Schema</span></code><span class=\"ne-text\">定义的数据库骨架以外，还具有数据库操作行为，类似于管理数据库属性、行为的类</span></p><p id=\"aff1faf8918c609306443436d0574840_p_73\" class=\"ne-p\"><span class=\"ne-text\">创建</span><code class=\"ne-code\"><span class=\"ne-text\">Model</span></code><span class=\"ne-text\">模型，需要指定：</span><strong><span class=\"ne-text\">1.集合名称，2.集合的</span></strong><code class=\"ne-code\"><strong><span class=\"ne-text\">Schema</span></strong></code><strong><span class=\"ne-text\">结构对象</span></strong></p></div><p id=\"d36608d2dcf9f070081537010b5adfb3_p_74\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"09475daf\" class=\"ne-codeblock language-javascript\">// 创建Model\nvar TestModel = mongoose.model(&quot;test1&quot;, TestSchema);</pre><p id=\"cee026a6997be2fe2ca3b5d6e2ce2bf0_p_75\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"8d2be128dde550dd2bce1a825b5787c3_p_76\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">test1</span></code><span class=\"ne-text\">：数据库中的集合名称，当我们对其添加数据时如果</span><code class=\"ne-code\"><span class=\"ne-text\">test1</span></code><span class=\"ne-text\">已经存在，则会保存到其目录下，如果未存在，则会创建</span><code class=\"ne-code\"><span class=\"ne-text\">test1</span></code><span class=\"ne-text\">集合，然后在保存数据。</span></p></div><p id=\"9fc1a1e32cf7c324fef5888bc3009382_p_77\" class=\"ne-p\"><br></p><h4 id=\"3011837c\"><span class=\"ne-text\">3.3 Entity</span></h4><p id=\"f585fed1cef9af7641b65ac1c4919258_p_78\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"ec695567a097a69e9a045f78df4c66a6_p_79\" class=\"ne-p\"><strong><span class=\"ne-text\">介绍</span></strong><span class=\"ne-text\">：由</span><code class=\"ne-code\"><span class=\"ne-text\">Model</span></code><span class=\"ne-text\">创建的实体，使用</span><code class=\"ne-code\"><span class=\"ne-text\">save</span></code><span class=\"ne-text\">方法保存数据，</span><code class=\"ne-code\"><span class=\"ne-text\">Model</span></code><span class=\"ne-text\">和</span><code class=\"ne-code\"><span class=\"ne-text\">Entity</span></code><span class=\"ne-text\">都有能影响数据库的操作，但</span><code class=\"ne-code\"><span class=\"ne-text\">Model</span></code><span class=\"ne-text\">比</span><code class=\"ne-code\"><span class=\"ne-text\">Entity</span></code><span class=\"ne-text\">更具操作性。</span></p></div><p id=\"cacc5e28cdefa24e262c83e0ab2a3ade_p_80\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"061fdf72\" class=\"ne-codeblock language-javascript\">// 创建Entity\nvar TestEntity = new TestModel({\n       name : &quot;Lenka&quot;,\n       age  : 36,\n       email: &quot;lenka@qq.com&quot;\n});\nconsole.log(TestEntity.name); // Lenka\nconsole.log(TestEntity.age); // 36</pre><p id=\"00780844004a7920ee455d8665291201_p_81\" class=\"ne-p\"><br></p><h4 id=\"b279dbc0\"><span class=\"ne-text\">3.4\t创建集合</span></h4><p id=\"ede07f6666baf1587414d7171c5dd877_p_82\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"b14fea9e\" class=\"ne-codeblock language-javascript\">var mongoose = require('mongoose')\nmongoose.connect('mongodb://127.0.0.1:27017/test')\nmongoose.connection.on('connected', function() {\n\tconsole.log('yes')\n})\n\nvar TestSchema = new mongoose.Schema({\n\tname: { type: String },\n  \tage: { type: Number, default: 0 },\n  \temail: { type: String },\n  \ttime: { type: Date, defaultL: Date.now }\n})\n\nvar TestModel = mongoose.model('test1', TestSchema)\n\nvar TestEntity = new TestModel({\n\tname: 'zs',\n  \tage: 20,\n  \temail: 'aa@bb.com'\n})\nTestEntity.save(function(error, doc) {\n\tif(error) {\n    \tconsole.log(&quot;error:&quot; + error)\n    } else {\n    \tconsole.log(doc)\n    }\n})</pre><p id=\"187832c794b601f7094c1a9b20086a6b_p_83\" class=\"ne-p\"><br></p><h3 id=\"bb03aec3\"><span class=\"ne-text\">4、操作</span></h3><p id=\"470257ffbff08ad0eedbc557452f8c66_p_84\" class=\"ne-p\"><br></p><h4 id=\"4e874710\"><span class=\"ne-text\">4.1 查询</span></h4><p id=\"bd02ded472df593f8e23bb50569c5ce4_p_85\" class=\"ne-p\"><br></p><h5 id=\"7a1dc02c\"><span class=\"ne-text\">4.1.1 find 基本查询</span></h5><p id=\"c07d4a2054239914d4a014d7d64fcf23_p_86\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"4233d36f6c4053adc6c6c9021a8619f3_p_87\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">obj.find(查询条件, callback)</span></code></p></div><p id=\"ac4c0d2013d04adfac6d2e9459525ac0_p_88\" class=\"ne-p\"><br></p><h5 id=\"8fe7015f\"><span class=\"ne-text\">4.1.2 find 过滤查询</span></h5><p id=\"ab51a4ad9cb9ee48199bb5c9fc6715a2_p_89\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"b84767490c4de031be3c97204b7da51d_li_21\"><span class=\"ne-text\">属性过滤</span></li></ul><div class=\"ne-quote\"><p id=\"0f8079aecc6ee0bdaeabe04432a1d438_p_90\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">find(Conditions, field, callback)</span></code><span class=\"ne-text\">，其中</span><code class=\"ne-code\"><span class=\"ne-text\">field</span></code><span class=\"ne-text\">省略或者设置为</span><code class=\"ne-code\"><span class=\"ne-text\">null</span></code><span class=\"ne-text\">，则返回所有属性</span></p></div><p id=\"2585884a100de0fae153ff935c1040bf_p_91\" class=\"ne-p\"><br></p><h5 id=\"21958309\"><span class=\"ne-text\">4.1.3 单条数据查询</span></h5><p id=\"f82a35c2fca60d6b3bdc5c1000201985_p_92\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"c7fecba67e6ff5af8bf7eebe88a97988_li_22\"><code class=\"ne-code\"><span class=\"ne-text\">findOne</span></code></li></ul><p id=\"92499751fabe053dd037c1574d6f4fb2_p_93\" class=\"ne-p\"><br></p><div class=\"ne-quote\"><p id=\"843de173fed186b0d566fb2d67ffb1d2_p_94\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">findOne(Conditions, callback)</span></code><span class=\"ne-text\">，注意：只返回第一个符合条件的文档数据</span></p></div><p id=\"45f9c401f99c8bc813e223381c98f09b_p_95\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"4b33286a5a297ba177aba135a448b7f2_li_23\"><code class=\"ne-code\"><span class=\"ne-text\">findById</span></code></li></ul><div class=\"ne-quote\"><p id=\"f7a29b3adb784cd479242731a9b971c2_p_96\" class=\"ne-p\"><code class=\"ne-code\"><span class=\"ne-text\">findById(_id, callback)</span></code><span class=\"ne-text\">，注意：只接受文档的</span><code class=\"ne-code\"><span class=\"ne-text\">_id</span></code><span class=\"ne-text\">作为参数</span></p></div><p id=\"d6a51c95a901676ffc113c140e74f091_p_97\" class=\"ne-p\"><br></p><h4 id=\"1240c168\"><span class=\"ne-text\">4.2 Model 保存</span></h4><p id=\"545db91b827f87cc9afe81c0f08a1a88_p_98\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"9a315966ea4c273065234743b072d249_li_24\"><code class=\"ne-code\"><span class=\"ne-text\">Model.create(文档数据, callback)</span></code></li></ul><p id=\"680207cd112f221e8bb2a2adf8b5ef15_p_99\" class=\"ne-p\"><br></p><h4 id=\"182385ff\"><span class=\"ne-text\">4.3 entity 保存</span></h4><p id=\"ec69cd8d8f73ee437722723e0adf1fa7_p_100\" class=\"ne-p\"><br></p><pre data-language=\"javascript\" id=\"61a594cd\" class=\"ne-codeblock language-javascript\">var Entity = new Model({ name: &quot;zs&quot;, age: 27 })\nEntity.save(function(error, doc) {\n    if(error) {\n        console.log(error)\n    } else {\n        console.log(doc)\n    }\n})</pre><p id=\"01884230bc631815ce050c63d5156a8c_p_101\" class=\"ne-p\"><br></p><h4 id=\"96ba815e\"><span class=\"ne-text\">4.4 数据更新</span></h4><p id=\"a2c2ab33193f15adcdff2e08f718d7c2_p_102\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"688b64de43cf398e63903d0864fc25d0_li_25\"><code class=\"ne-code\"><span class=\"ne-text\">obj.update(查询条件, 更新对象, callback)</span></code></li></ul><p id=\"c4eb78622bfacec164736bf4df40fa3b_p_103\" class=\"ne-p\"><br></p><h4 id=\"274dbed5\"><span class=\"ne-text\">4.5 数据删除</span></h4><p id=\"9bd2d97c6b7de4b9f89a01020f0acbdc_p_104\" class=\"ne-p\"><br></p><ul class=\"ne-ul\"><li id=\"7f09d05e3b0eee758cb71ce6ece6dc71_li_26\"><code class=\"ne-code\"><span class=\"ne-text\">obj.remove(查询条件, callback)</span></code></li></ul></div>",
  "body_lake": "<!doctype lake><meta name=\"doc-version\" content=\"1\" /><meta name=\"typography\" content=\"traditional\" /><meta name=\"viewport\" content=\"adapt\" /><p data-lake-id=\"a20d224c568e48b9d67847a2c66a8c01_p_0\" id=\"a20d224c568e48b9d67847a2c66a8c01_p_0\"><code data-lake-id=\"ueec9fd3b\" id=\"ueec9fd3b\"><span data-lake-id=\"u36eb3a29\" id=\"u36eb3a29\">mongodb</span></code><span data-lake-id=\"u1ff50899\" id=\"u1ff50899\"> 是一种非关系型数据库，不必写 </span><code data-lake-id=\"u7ae5a3e1\" id=\"u7ae5a3e1\"><span data-lake-id=\"ua70dd6da\" id=\"ua70dd6da\">sql</span></code><span data-lake-id=\"u759902b3\" id=\"u759902b3\"> 语句，其操作类似于 </span><code data-lake-id=\"u58b8b861\" id=\"u58b8b861\"><span data-lake-id=\"u8579890e\" id=\"u8579890e\">json</span></code><span data-lake-id=\"u60ca42fa\" id=\"u60ca42fa\"> ，方便后端工作者进行开发。</span></p><p data-lake-id=\"0c4d068e4aede2bc9d552ce387999b01_p_4\" id=\"0c4d068e4aede2bc9d552ce387999b01_p_4\"><br></p><p data-lake-id=\"1be1eeca63aa45c0a89fd9c8eb131b02_p_5\" id=\"1be1eeca63aa45c0a89fd9c8eb131b02_p_5\"><code data-lake-id=\"ubc56a2a7\" id=\"ubc56a2a7\"><span data-lake-id=\"ua797bee7\" id=\"ua797bee7\">mongoose</span></code><span data-lake-id=\"uf9a8099a\" id=\"uf9a8099a\"> 是一种 </span><code data-lake-id=\"uf56d857e\" id=\"uf56d857e\"><span data-lake-id=\"u27e8da60\" id=\"u27e8da60\">mongodb</span></code><span data-lake-id=\"u9f425252\" id=\"u9f425252\"> 的 </span><code data-lake-id=\"u03b13878\" id=\"u03b13878\"><span data-lake-id=\"u4a4af0a5\" id=\"u4a4af0a5\">orm</span></code><span data-lake-id=\"u79c09d92\" id=\"u79c09d92\"> 框架，方便操作和使用，其中，</span><code data-lake-id=\"ua5e49d02\" id=\"ua5e49d02\"><span data-lake-id=\"ua3f323ed\" id=\"ua3f323ed\">Schema</span></code><span data-lake-id=\"u1c6adae7\" id=\"u1c6adae7\"> 是关键。</span></p><h2 data-lake-id=\"485b8bb7\" id=\"485b8bb7\"><span data-lake-id=\"u05e8cd5a\" id=\"u05e8cd5a\">一、常用命令：</span></h2><card type=\"block\" name=\"table\" value=\"data:%7B%22id%22%3A%222392904a%22%2C%22rows%22%3A11%2C%22cols%22%3A2%2C%22html%22%3A%22%3Ctable%20data-lake-id%3D%5C%222392904a%5C%22%20id%3D%5C%222392904a%5C%22%20class%3D%5C%22lake-table%5C%22%20style%3D%5C%22width%3A%20750px%5C%22%3E%3Ccolgroup%3E%3Ccol%20width%3D%5C%22375%5C%22%3E%3Ccol%20width%3D%5C%22375%5C%22%3E%3C%2Fcolgroup%3E%3Ctbody%3E%3Ctr%20data-lake-id%3D%5C%22u2e1d2943%5C%22%20id%3D%5C%22u2e1d2943%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u0232a159%5C%22%20id%3D%5C%22u0232a159%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u4ec147b5%5C%22%20id%3D%5C%22u4ec147b5%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u8a72a34d%5C%22%20id%3D%5C%22u8a72a34d%5C%22%3E%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22ub234580f%5C%22%20id%3D%5C%22ub234580f%5C%22%3E%3Cp%20data-lake-id%3D%5C%22uc1300c00%5C%22%20id%3D%5C%22uc1300c00%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u28f5eb7b%5C%22%20id%3D%5C%22u28f5eb7b%5C%22%3E%E4%BB%8B%E7%BB%8D%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22u1673d3b3%5C%22%20id%3D%5C%22u1673d3b3%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22uab158d6d%5C%22%20id%3D%5C%22uab158d6d%5C%22%3E%3Cp%20data-lake-id%3D%5C%22ue69fbdba%5C%22%20id%3D%5C%22ue69fbdba%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22ub67194be%5C%22%20id%3D%5C%22ub67194be%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u3ef464db%5C%22%20id%3D%5C%22u3ef464db%5C%22%3Eshow%20dbs%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22u07b4f73c%5C%22%20id%3D%5C%22u07b4f73c%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u980f663e%5C%22%20id%3D%5C%22u980f663e%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22ue54fa4ce%5C%22%20id%3D%5C%22ue54fa4ce%5C%22%3E%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%97%E8%A1%A8%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22u0c7f373c%5C%22%20id%3D%5C%22u0c7f373c%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u1688a26e%5C%22%20id%3D%5C%22u1688a26e%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u67d49c9e%5C%22%20id%3D%5C%22u67d49c9e%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22ua8c05fff%5C%22%20id%3D%5C%22ua8c05fff%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u1af544a7%5C%22%20id%3D%5C%22u1af544a7%5C%22%3Eshow%20collections%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22uf7455679%5C%22%20id%3D%5C%22uf7455679%5C%22%3E%3Cp%20data-lake-id%3D%5C%22ue36f57bc%5C%22%20id%3D%5C%22ue36f57bc%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22uc78f6c3b%5C%22%20id%3D%5C%22uc78f6c3b%5C%22%3E%E6%98%BE%E7%A4%BA%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E9%9B%86%E5%90%88%EF%BC%88%E7%B1%BB%E4%BC%BC%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E8%A1%A8%EF%BC%89%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22ucd84aa65%5C%22%20id%3D%5C%22ucd84aa65%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u669a14c2%5C%22%20id%3D%5C%22u669a14c2%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u1b265523%5C%22%20id%3D%5C%22u1b265523%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22u57f0a225%5C%22%20id%3D%5C%22u57f0a225%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u72e11794%5C%22%20id%3D%5C%22u72e11794%5C%22%3Eshow%20users%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22u7e6a97fd%5C%22%20id%3D%5C%22u7e6a97fd%5C%22%3E%3Cp%20data-lake-id%3D%5C%22ubeb39a72%5C%22%20id%3D%5C%22ubeb39a72%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u1caa62f3%5C%22%20id%3D%5C%22u1caa62f3%5C%22%3E%E6%98%BE%E7%A4%BA%E7%94%A8%E6%88%B7%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22ud05180d5%5C%22%20id%3D%5C%22ud05180d5%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u13030ee0%5C%22%20id%3D%5C%22u13030ee0%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u773977b2%5C%22%20id%3D%5C%22u773977b2%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22ud7a05751%5C%22%20id%3D%5C%22ud7a05751%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22ua2983d96%5C%22%20id%3D%5C%22ua2983d96%5C%22%3Euse%20%26lt%3Bdb%20name%26gt%3B%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22u3ffb9d34%5C%22%20id%3D%5C%22u3ffb9d34%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u1b513695%5C%22%20id%3D%5C%22u1b513695%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u815f742e%5C%22%20id%3D%5C%22u815f742e%5C%22%3E%E5%88%87%E6%8D%A2%2F%E5%88%9B%E5%BB%BA%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22u0168ee2c%5C%22%20id%3D%5C%22u0168ee2c%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u01d1733e%5C%22%20id%3D%5C%22u01d1733e%5C%22%3E%3Cp%20data-lake-id%3D%5C%22ue264c382%5C%22%20id%3D%5C%22ue264c382%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22udeee9e22%5C%22%20id%3D%5C%22udeee9e22%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22uae2ab77f%5C%22%20id%3D%5C%22uae2ab77f%5C%22%3Edb.help()%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22ue33f7e50%5C%22%20id%3D%5C%22ue33f7e50%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u8c4dd2ca%5C%22%20id%3D%5C%22u8c4dd2ca%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22ua589b225%5C%22%20id%3D%5C%22ua589b225%5C%22%3E%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22uf9256f1d%5C%22%20id%3D%5C%22uf9256f1d%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u276116dc%5C%22%20id%3D%5C%22u276116dc%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u99875ae4%5C%22%20id%3D%5C%22u99875ae4%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22ue41c44f2%5C%22%20id%3D%5C%22ue41c44f2%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u079245bf%5C%22%20id%3D%5C%22u079245bf%5C%22%3Edb.dropDatabase()%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22u192effd8%5C%22%20id%3D%5C%22u192effd8%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u187fe4ed%5C%22%20id%3D%5C%22u187fe4ed%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22ub8deac61%5C%22%20id%3D%5C%22ub8deac61%5C%22%3E%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22uebc3022f%5C%22%20id%3D%5C%22uebc3022f%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22ue7307613%5C%22%20id%3D%5C%22ue7307613%5C%22%3E%3Cp%20data-lake-id%3D%5C%22ubdc8f2f3%5C%22%20id%3D%5C%22ubdc8f2f3%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22u5e53ed91%5C%22%20id%3D%5C%22u5e53ed91%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u52f59d09%5C%22%20id%3D%5C%22u52f59d09%5C%22%3Edb.createCollection()%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22ue82ce109%5C%22%20id%3D%5C%22ue82ce109%5C%22%3E%3Cp%20data-lake-id%3D%5C%22udab8e9e0%5C%22%20id%3D%5C%22udab8e9e0%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u9658635e%5C%22%20id%3D%5C%22u9658635e%5C%22%3E%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%9B%86%E5%90%88(%E8%A1%A8)%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22u37c69f0f%5C%22%20id%3D%5C%22u37c69f0f%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u72819140%5C%22%20id%3D%5C%22u72819140%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u3873b800%5C%22%20id%3D%5C%22u3873b800%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22u017a9cdd%5C%22%20id%3D%5C%22u017a9cdd%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22uc805ee8e%5C%22%20id%3D%5C%22uc805ee8e%5C%22%3Edb%2Fdb.getName()%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22ud45bbbe6%5C%22%20id%3D%5C%22ud45bbbe6%5C%22%3E%3Cp%20data-lake-id%3D%5C%22uf2029eb1%5C%22%20id%3D%5C%22uf2029eb1%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u14f332b1%5C%22%20id%3D%5C%22u14f332b1%5C%22%3E%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E6%89%80%E5%9C%A8%E6%95%B0%E6%8D%AE%E5%BA%93%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22u48037491%5C%22%20id%3D%5C%22u48037491%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22u9108ad6a%5C%22%20id%3D%5C%22u9108ad6a%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u6a040ae6%5C%22%20id%3D%5C%22u6a040ae6%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22u913b4edd%5C%22%20id%3D%5C%22u913b4edd%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u4e22fff5%5C%22%20id%3D%5C%22u4e22fff5%5C%22%3Edb.user.findOne()%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22uf0dad7b6%5C%22%20id%3D%5C%22uf0dad7b6%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u8e147f00%5C%22%20id%3D%5C%22u8e147f00%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u2a0b9a22%5C%22%20id%3D%5C%22u2a0b9a22%5C%22%3E%E6%9F%A5%E8%AF%A2%E7%AC%AC%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3Ctr%20data-lake-id%3D%5C%22u23cabeda%5C%22%20id%3D%5C%22u23cabeda%5C%22%3E%3Ctd%20data-lake-id%3D%5C%22uf23464da%5C%22%20id%3D%5C%22uf23464da%5C%22%3E%3Cp%20data-lake-id%3D%5C%22u3dde56e9%5C%22%20id%3D%5C%22u3dde56e9%5C%22%3E%3Ccode%20data-lake-id%3D%5C%22u66370697%5C%22%20id%3D%5C%22u66370697%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u795dfb64%5C%22%20id%3D%5C%22u795dfb64%5C%22%3Eload()%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fp%3E%3C%2Ftd%3E%3Ctd%20data-lake-id%3D%5C%22uaad3fa48%5C%22%20id%3D%5C%22uaad3fa48%5C%22%3E%3Cp%20data-lake-id%3D%5C%22ube2b5f3c%5C%22%20id%3D%5C%22ube2b5f3c%5C%22%3E%3Cspan%20data-lake-id%3D%5C%22u5901fa66%5C%22%20id%3D%5C%22u5901fa66%5C%22%3E%E5%8A%A0%E8%BD%BD%E6%96%87%E4%BB%B6%3C%2Fspan%3E%3C%2Fp%3E%3C%2Ftd%3E%3C%2Ftr%3E%3C%2Ftbody%3E%3C%2Ftable%3E%22%2C%22margin%22%3Atrue%7D\"></card><p data-lake-id=\"f23fb9c519ff30bfe03d0b2cc2cac85d_p_6\" id=\"f23fb9c519ff30bfe03d0b2cc2cac85d_p_6\"><br></p><h3 data-lake-id=\"ebb75e45\" id=\"ebb75e45\"><span data-lake-id=\"u478bd482\" id=\"u478bd482\">1. find 查找</span></h3><p data-lake-id=\"e1b0979b54c1fb29acc1d92ad2159922_p_7\" id=\"e1b0979b54c1fb29acc1d92ad2159922_p_7\"><br></p><blockquote data-lake-id=\"ufd365c92\" id=\"ufd365c92\"><p data-lake-id=\"cba62c1edb20d1f703ba9c811af81d2a_p_8\" id=\"cba62c1edb20d1f703ba9c811af81d2a_p_8\"><code data-lake-id=\"ueee94cbe\" id=\"ueee94cbe\"><span data-lake-id=\"u537126af\" id=\"u537126af\">@params: [条件，指定打印字段的名称]</span></code></p></blockquote><p data-lake-id=\"eadc4ec477465f1f239730d987d394b1_p_9\" id=\"eadc4ec477465f1f239730d987d394b1_p_9\"><br></p><ul list=\"ub39f12d9\"><li fid=\"u65224f33\" data-lake-id=\"c544d393a313442b38d7e244085cdc69_li_3\" id=\"c544d393a313442b38d7e244085cdc69_li_3\"><span data-lake-id=\"u1161e7ec\" id=\"u1161e7ec\">查找 【</span><code data-lake-id=\"u57fd74a4\" id=\"u57fd74a4\"><span data-lake-id=\"u131e6c9c\" id=\"u131e6c9c\">age &gt;= 20</span></code><span data-lake-id=\"u2d762b2b\" id=\"u2d762b2b\"> 并且 </span><code data-lake-id=\"u69103985\" id=\"u69103985\"><span data-lake-id=\"u4afd7557\" id=\"u4afd7557\">age &lt;= 30</span></code><span data-lake-id=\"u98b4d1dd\" id=\"u98b4d1dd\"> 的】数据</span></li></ul><p data-lake-id=\"042da541aac17f869693ba89ebd10d8e_p_10\" id=\"042da541aac17f869693ba89ebd10d8e_p_10\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.find(%7B%20%5Cn%20%20age%3A%20%7B%5Cn%20%20%20%20%24gte%3A%2020%2C%20%5Cn%20%20%20%20%24lte%3A%2030%5Cn%20%20%7D%20%5Cn%7D%2C%20%7B%20%5Cn%20%20name%3A%20true%2C%20%5Cn%20%20age%3A%20true%2C%20%5Cn%20%20_id%3A%20false%20%5Cn%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%2291951a7f%22%7D\"></card><p data-lake-id=\"828bea0262f636b25c97fbef525aed20_p_11\" id=\"828bea0262f636b25c97fbef525aed20_p_11\"><br></p><ul list=\"u66d13f5e\"><li fid=\"u4fbf530b\" data-lake-id=\"d400ad5b3883d7327b9e8fce48627311_li_4\" id=\"d400ad5b3883d7327b9e8fce48627311_li_4\"><span data-lake-id=\"u7510906e\" id=\"u7510906e\">查找【21岁 和 10岁的】数据</span></li></ul><p data-lake-id=\"09a2b5671cf447a1a3529d71c89cf9e1_p_12\" id=\"09a2b5671cf447a1a3529d71c89cf9e1_p_12\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.find(%7B%5Cn%20%20age%3A%20%7B%5Cn%20%20%20%20%24in%3A%20%5B21%2C%2010%5D%5Cn%20%20%7D%5Cn%7D%2C%20%7B%5Cn%20%20name%3A%20true%2C%20%5Cn%20%20age%3A%20true%2C%20%5Cn%20%20_id%3A%20false%5Cn%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%225583174e%22%7D\"></card><p data-lake-id=\"2369fafe89fae403079018df6f36b51b_p_13\" id=\"2369fafe89fae403079018df6f36b51b_p_13\"><br></p><ul list=\"ufa518f28\"><li fid=\"u2e14d228\" data-lake-id=\"6c0d01b555538169bca5a51850c916d1_li_5\" id=\"6c0d01b555538169bca5a51850c916d1_li_5\"><span data-lake-id=\"uc7e4d1a3\" id=\"uc7e4d1a3\">查找 【 要么 </span><code data-lake-id=\"u18a654a0\" id=\"u18a654a0\"><span data-lake-id=\"u0e89feb9\" id=\"u0e89feb9\">age &lt;= 10</span></code><span data-lake-id=\"uf97ea040\" id=\"uf97ea040\">，要么 </span><code data-lake-id=\"ub7ed68b7\" id=\"ub7ed68b7\"><span data-lake-id=\"ud212d8ed\" id=\"ud212d8ed\">pc.brand = 'IBM'</span></code><span data-lake-id=\"u285a6761\" id=\"u285a6761\"> 】的数据</span></li></ul><p data-lake-id=\"7cf79ceeaaf91ef14264b4c55c1c8c1d_p_14\" id=\"7cf79ceeaaf91ef14264b4c55c1c8c1d_p_14\"><br></p><blockquote data-lake-id=\"ub7730fc3\" id=\"ub7730fc3\"><p data-lake-id=\"15e08fa08208b9badd966b4ec1de2c09_p_15\" id=\"15e08fa08208b9badd966b4ec1de2c09_p_15\"><span data-lake-id=\"u244d3ed3\" id=\"u244d3ed3\">与或非：</span><code data-lake-id=\"u92acca2e\" id=\"u92acca2e\"><span data-lake-id=\"u9c0b1c4f\" id=\"u9c0b1c4f\">$and, $or, $not</span></code></p></blockquote><p data-lake-id=\"42752743bc6d3f9f6c928fb47989b8c2_p_16\" id=\"42752743bc6d3f9f6c928fb47989b8c2_p_16\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.find(%7B%20%5Cn%20%20%24or%3A%20%5Bage%3A%20%7B%20%24lte%3A%2010%2C%20'pc.brand'%3A%20'IBM'%20%7D%5D%5Cn%7D%2C%20%7B%20name%3A%20true%2C%20age%3A%20true%2C%20_id%3A%20false%20%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%229b6cfc91%22%7D\"></card><p data-lake-id=\"c5eaf555cee01ec836fc749258c6179d_p_17\" id=\"c5eaf555cee01ec836fc749258c6179d_p_17\"><br></p><ul list=\"u97bd7473\"><li fid=\"ubc1918b1\" data-lake-id=\"5c593f90559b4ce2eb6f3e648787bda9_li_6\" id=\"5c593f90559b4ce2eb6f3e648787bda9_li_6\"><span data-lake-id=\"u2f1c5d5f\" id=\"u2f1c5d5f\">数组查询：查找【喜欢篮球和敲代码的】数据</span></li></ul><p data-lake-id=\"3f8949dd5527f0c9624c3fd3faefb76f_p_18\" id=\"3f8949dd5527f0c9624c3fd3faefb76f_p_18\"><br></p><blockquote data-lake-id=\"u98937f3a\" id=\"u98937f3a\"><p data-lake-id=\"7c65ff855596b0bf2d92b8593ba61cfc_p_19\" id=\"7c65ff855596b0bf2d92b8593ba61cfc_p_19\"><code data-lake-id=\"u51e95381\" id=\"u51e95381\"><span data-lake-id=\"u857b2b64\" id=\"u857b2b64\">$all</span></code><span data-lake-id=\"u7b7f50c8\" id=\"u7b7f50c8\">：全部满足查询，</span><code data-lake-id=\"u3cfdee95\" id=\"u3cfdee95\"><span data-lake-id=\"u76921a6a\" id=\"u76921a6a\">$in</span></code><span data-lake-id=\"u033c453c\" id=\"u033c453c\">：满足任意一个条件查询，</span><code data-lake-id=\"ue3251e13\" id=\"ue3251e13\"><span data-lake-id=\"ub39b52f6\" id=\"ub39b52f6\">$size</span></code><span data-lake-id=\"u6c7561d4\" id=\"u6c7561d4\">：根据个数查询</span></p></blockquote><p data-lake-id=\"db841a6e995b001085603629a3ace379_p_20\" id=\"db841a6e995b001085603629a3ace379_p_20\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.find(%7B%5Cn%20%20%20%20hobby%3A%20%7B%20%24all%3A%20%5B'%E7%AF%AE%E7%90%83'%2C%20'%E6%95%B2%E4%BB%A3%E7%A0%81'%5D%20%7D%5Cn%7D%2C%20%7Bname%3A%20true%2C%20age%3A%20true%2C%20_id%3A%20false%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%2290618017%22%7D\"></card><p data-lake-id=\"54d418504a63791b75a5f497078fa24a_p_21\" id=\"54d418504a63791b75a5f497078fa24a_p_21\"><br></p><ul list=\"u91f6dc84\"><li fid=\"ue64c942f\" data-lake-id=\"1662455bb19a580cf4b4d9ebcbfa971c_li_7\" id=\"1662455bb19a580cf4b4d9ebcbfa971c_li_7\"><span data-lake-id=\"ubd7d8acc\" id=\"ubd7d8acc\">分页查询：</span></li></ul><p data-lake-id=\"37928cd1f32681ee4810a9ab9d3c1104_p_22\" id=\"37928cd1f32681ee4810a9ab9d3c1104_p_22\"><br></p><blockquote data-lake-id=\"ue45eedf4\" id=\"ue45eedf4\"><p data-lake-id=\"a4ecc0472d21335c4ebb7b2d3f2bb55a_p_23\" id=\"a4ecc0472d21335c4ebb7b2d3f2bb55a_p_23\"><code data-lake-id=\"ub1afe14f\" id=\"ub1afe14f\"><span data-lake-id=\"u7feb1a07\" id=\"u7feb1a07\">limit</span></code><span data-lake-id=\"u8ed69295\" id=\"u8ed69295\">：每次查询几条，</span><code data-lake-id=\"u159fa375\" id=\"u159fa375\"><span data-lake-id=\"u065d44b2\" id=\"u065d44b2\">skip</span></code><span data-lake-id=\"uc6bfa606\" id=\"uc6bfa606\">：从第几条开始，</span><code data-lake-id=\"u5a521d16\" id=\"u5a521d16\"><span data-lake-id=\"u17cc643c\" id=\"u17cc643c\">sort</span></code><span data-lake-id=\"ua4c0e65b\" id=\"ua4c0e65b\">：排序方式(-1：降序，1：升序)</span></p></blockquote><p data-lake-id=\"1f3b4b4a4867a8b756c196b38558d0c4_p_24\" id=\"1f3b4b4a4867a8b756c196b38558d0c4_p_24\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.find(%7B%7D%2C%20%7Bname%3A%20true%2C%20age%3A%20true%2C%20_id%3A%20false%7D)%5Cn%20%20.limit(1).skip(0).sort(%7B%20age%3A%20-1%20%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22a7713c62%22%7D\"></card><p data-lake-id=\"3afe72986fc83f6913935faccbcf69b2_p_25\" id=\"3afe72986fc83f6913935faccbcf69b2_p_25\"><br></p><ul list=\"u4e1208fb\"><li fid=\"u7a7fe34f\" data-lake-id=\"cdfbb21ac5b6a90b254261593db3c6a5_li_8\" id=\"cdfbb21ac5b6a90b254261593db3c6a5_li_8\"><span data-lake-id=\"u6a2d41d2\" id=\"u6a2d41d2\">逐条打印 </span><code data-lake-id=\"ucb1b8b8b\" id=\"ucb1b8b8b\"><span data-lake-id=\"u9f87ab1d\" id=\"u9f87ab1d\">forEach</span></code></li></ul><p data-lake-id=\"b57de0a6a045efefe71d109094be9ddc_p_26\" id=\"b57de0a6a045efefe71d109094be9ddc_p_26\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22var%20db%20%3D%20connect('me')%5Cnvar%20userlist%20%3D%20db.user.find()%5Cnuserlist.forEach(user%20%3D%3E%20%7B%5Cn%20%20%20%20%2F**%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%A4%84%E7%90%86%20if%20else%20*%2F%5Cn%20%20%20%20printjson(user)%5Cn%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22764df917%22%7D\"></card><p data-lake-id=\"4cc44302cfe9be1836a49b383f7e914f_p_27\" id=\"4cc44302cfe9be1836a49b383f7e914f_p_27\"><br></p><h3 data-lake-id=\"0e2d7f46\" id=\"0e2d7f46\"><span data-lake-id=\"u03fe29d5\" id=\"u03fe29d5\">2. update 更新</span></h3><p data-lake-id=\"d17d837b16c49a0e5c21edc18722e410_p_28\" id=\"d17d837b16c49a0e5c21edc18722e410_p_28\"><br></p><blockquote data-lake-id=\"u161d3544\" id=\"u161d3544\"><p data-lake-id=\"1595915121f042f5f79cba077b58d670_p_29\" id=\"1595915121f042f5f79cba077b58d670_p_29\"><code data-lake-id=\"u1de0c651\" id=\"u1de0c651\"><span data-lake-id=\"ue5858694\" id=\"ue5858694\">db.user.update(条件, 方法)</span></code></p></blockquote><p data-lake-id=\"d657ac1e4c3211af4f7dcea889518735_p_30\" id=\"d657ac1e4c3211af4f7dcea889518735_p_30\"><br></p><ul list=\"u8ea15ab3\"><li fid=\"u1d6b8be9\" data-lake-id=\"283580dcfbd0517bc1345c255f7c5390_li_9\" id=\"283580dcfbd0517bc1345c255f7c5390_li_9\"><code data-lake-id=\"u6fca2026\" id=\"u6fca2026\"><span data-lake-id=\"ud1c257d6\" id=\"ud1c257d6\">$inc</span></code><span data-lake-id=\"u4f73177a\" id=\"u4f73177a\">：进行加减操作</span></li></ul><ul list=\"ufc8f3e24\"><li fid=\"ue63a6733\" data-lake-id=\"c474c27c576f57ded9730cb4fafb857e_li_10\" id=\"c474c27c576f57ded9730cb4fafb857e_li_10\"><code data-lake-id=\"uf3710744\" id=\"uf3710744\"><span data-lake-id=\"uab70ed44\" id=\"uab70ed44\">$set</span></code><span data-lake-id=\"u2998716a\" id=\"u2998716a\">：修改一个指定的</span><code data-lake-id=\"u916e91f6\" id=\"u916e91f6\"><span data-lake-id=\"u9f8acdf2\" id=\"u9f8acdf2\">key</span></code><span data-lake-id=\"ubdf10b17\" id=\"ubdf10b17\">值</span></li></ul><p data-lake-id=\"e2e9b10bfede90e88bd47291199e0b55_p_31\" id=\"e2e9b10bfede90e88bd47291199e0b55_p_31\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22%2F%2F%5Ct%E4%BF%AE%E6%94%B9%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%90%E4%B8%AA%E5%85%83%E7%B4%A0%E7%9A%84%E5%80%BC%5Cndb.user.update(%7Bname%3A%20%5C%22xiaofeng%5C%22%7D%2C%20%7B%24set%3A%20%7B%20'age.0'%3A%2040%20%7D%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22a2c86750%22%7D\"></card><p data-lake-id=\"bb3e20f1faeaf6bf9497bffd7f381295_p_32\" id=\"bb3e20f1faeaf6bf9497bffd7f381295_p_32\"><br></p><ul list=\"u3f39d5a4\"><li fid=\"uaa680cb4\" data-lake-id=\"a5bfaa22d44e846fffc4d5ffb5c9bea3_li_11\" id=\"a5bfaa22d44e846fffc4d5ffb5c9bea3_li_11\"><code data-lake-id=\"u98ea45e6\" id=\"u98ea45e6\"><span data-lake-id=\"u6551f438\" id=\"u6551f438\">$unset</span></code><span data-lake-id=\"udbf31b77\" id=\"udbf31b77\"> ：删除一个</span><code data-lake-id=\"u22996ce4\" id=\"u22996ce4\"><span data-lake-id=\"u15a6ba12\" id=\"u15a6ba12\">key</span></code><span data-lake-id=\"uf11d4b92\" id=\"uf11d4b92\">值和对应的</span><code data-lake-id=\"u4ffae921\" id=\"u4ffae921\"><span data-lake-id=\"u9743fa6d\" id=\"u9743fa6d\">value</span></code><span data-lake-id=\"ud433cb32\" id=\"ud433cb32\">值</span></li></ul><ul list=\"u9b2ce5d7\"><li fid=\"ucf45458b\" data-lake-id=\"26b764a908e5fa9062a566ca7d0dede8_li_12\" id=\"26b764a908e5fa9062a566ca7d0dede8_li_12\"><code data-lake-id=\"u513a49a7\" id=\"u513a49a7\"><span data-lake-id=\"ue2752e24\" id=\"ue2752e24\">upsert</span></code><span data-lake-id=\"u840d2ea2\" id=\"u840d2ea2\"> ： 如果当前找不到这个值， 那么就插入这个值</span></li></ul><p data-lake-id=\"73b74e66f7d869f94eb34b57d63eae3f_p_33\" id=\"73b74e66f7d869f94eb34b57d63eae3f_p_33\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.update(%7Bname%3A%20%5C%22xiaofeng%5C%22%7D%2C%20%7B%24set%3A%20%7Bage%3A%2010%7D%7D%2C%20%7Bupsert%3A%20true%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22c2b5a48e%22%7D\"></card><p data-lake-id=\"39abba9494ef6da94608fbd0e487aa60_p_34\" id=\"39abba9494ef6da94608fbd0e487aa60_p_34\"><br></p><ul list=\"uf162d18e\"><li fid=\"u92b678b9\" data-lake-id=\"0ac08a61bce41b0b6b4a094e606f438d_li_13\" id=\"0ac08a61bce41b0b6b4a094e606f438d_li_13\"><code data-lake-id=\"u6f5f5efb\" id=\"u6f5f5efb\"><span data-lake-id=\"u6d58e71c\" id=\"u6d58e71c\">multi</span></code><span data-lake-id=\"ufddb28a9\" id=\"ufddb28a9\">：给所有数据都增加属性 如果为</span><code data-lake-id=\"u134616d1\" id=\"u134616d1\"><span data-lake-id=\"uc7267186\" id=\"uc7267186\">false</span></code><span data-lake-id=\"u578f8d99\" id=\"u578f8d99\">或者不加那么只有第一条数据会加</span></li></ul><p data-lake-id=\"86d045d193aa7ac4616d4ea50a0dc92f_p_35\" id=\"86d045d193aa7ac4616d4ea50a0dc92f_p_35\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.update(%7B%7D%2C%20%7B%24set%3A%20%7Bhobby%3A%20%5B%5D%7D%7D%2C%20%7Bmulti%3A%20true%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%2213cbf582%22%7D\"></card><p data-lake-id=\"6f8f966688575a1f666bafa122494f73_p_36\" id=\"6f8f966688575a1f666bafa122494f73_p_36\"><br></p><ul list=\"uc606c43b\"><li fid=\"u4ded0474\" data-lake-id=\"5348a9513557021f90bd1792d9cc5742_li_14\" id=\"5348a9513557021f90bd1792d9cc5742_li_14\"><code data-lake-id=\"u97b201e5\" id=\"u97b201e5\"><span data-lake-id=\"u9917505d\" id=\"u9917505d\">$push</span></code><span data-lake-id=\"u04e25a5d\" id=\"u04e25a5d\">：给数组字段里增加一个新的元素</span></li></ul><p data-lake-id=\"ab57135091a86c42cc63ec67ac068a45_p_37\" id=\"ab57135091a86c42cc63ec67ac068a45_p_37\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.user.update(%7Bname%3A%20%5C%22xiaowu%5C%22%7D%2C%20%7B%24push%3A%20%7Bhobby%3A%20%5C%22%E5%90%83%E9%B8%A1%5C%22%7D%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%223099f157%22%7D\"></card><p data-lake-id=\"82f45866a429f6224b2e92c65bfda254_p_38\" id=\"82f45866a429f6224b2e92c65bfda254_p_38\"><br></p><ul list=\"u076b4f77\"><li fid=\"uc48ea1f0\" data-lake-id=\"d17fb336492eed12daf987625c030393_li_15\" id=\"d17fb336492eed12daf987625c030393_li_15\"><code data-lake-id=\"ub29afd18\" id=\"ub29afd18\"><span data-lake-id=\"ud4ebfca7\" id=\"ud4ebfca7\">$addToSet</span></code><span data-lake-id=\"ue3fbbb27\" id=\"ue3fbbb27\"> ： 查找是否存在，如果不存在则</span><code data-lake-id=\"ud9020009\" id=\"ud9020009\"><span data-lake-id=\"u8d9b51fc\" id=\"u8d9b51fc\">push</span></code><span data-lake-id=\"ub6ba62cd\" id=\"ub6ba62cd\">进去，如果存在则不</span><code data-lake-id=\"u031dc224\" id=\"u031dc224\"><span data-lake-id=\"ucf8d109b\" id=\"ucf8d109b\">push</span></code></li></ul><ul list=\"u36f9cf21\"><li fid=\"u11e7b267\" data-lake-id=\"f9c92b76a83c4ff3e87f45bf0dfc8326_li_16\" id=\"f9c92b76a83c4ff3e87f45bf0dfc8326_li_16\"><code data-lake-id=\"ue1f8e6db\" id=\"ue1f8e6db\"><span data-lake-id=\"ub4e5014b\" id=\"ub4e5014b\">$each</span></code><span data-lake-id=\"uc313f167\" id=\"uc313f167\">：在数组中插入多个元素</span></li></ul><p data-lake-id=\"faade82d6cfe8ed09f505bc5d9204fda_p_39\" id=\"faade82d6cfe8ed09f505bc5d9204fda_p_39\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22%2F%2F%5Ct%E5%9C%A8%E6%95%B0%E7%BB%84%E4%B8%AD%E6%8F%92%E5%85%A5%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0%5Cnvar%20newHobby%20%3D%20%5B%5C%22%E9%B8%A1%5C%22%2C%20%5C%22%E9%B8%AD%5C%22%2C%20%5C%22%E9%B9%85%5C%22%5D%5Cndb.user.update(%7Bname%3A%20%5C%22wxq%5C%22%7D%2C%20%7B%24addToSet%3A%20%7B%20hobby%3A%20%7B%24each%3A%20newHobby%7D%20%7D%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%2212ccff57%22%7D\"></card><p data-lake-id=\"17b412f9fc3ec51ada5f566f0d09108c_p_40\" id=\"17b412f9fc3ec51ada5f566f0d09108c_p_40\"><br></p><ul list=\"ua2d19d56\"><li fid=\"u8bf7df02\" data-lake-id=\"3d34b3282872d00df5172cff4ccffa33_li_17\" id=\"3d34b3282872d00df5172cff4ccffa33_li_17\"><code data-lake-id=\"u00fd96f3\" id=\"u00fd96f3\"><span data-lake-id=\"ub09aa39b\" id=\"ub09aa39b\">findAndModify</span></code><span data-lake-id=\"u774cb49d\" id=\"u774cb49d\"> ： 有返回值，可以根据返回值来进行逻辑处理</span></li></ul><p data-lake-id=\"d9d31f80b21bee6005ee4bb0be1d9a6b_p_41\" id=\"d9d31f80b21bee6005ee4bb0be1d9a6b_p_41\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22%2F%2F%5Ct%E5%BA%94%E7%AD%94%E5%BC%8F%E7%9A%84%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95%5Cnvar%20modify%20%3D%20%7B%5Cn%20%20%20%20findAndModify%3A%20%5C%22user%5C%22%2C%5Cn%20%20%20%20query%3A%20%7Bname%3A%20'wxq'%7D%2C%5Cn%20%20%20%20update%3A%20%7B%24set%3A%20%7Bage%3A%2021%7D%7D%2C%5Cn%20%20%20%20new%3A%20true%5Ct%2F%2F%5Cttrue%EF%BC%9A%E8%BF%94%E5%9B%9E%E4%BF%AE%E6%94%B9%E4%B9%8B%E5%90%8E%E7%9A%84%E5%80%BC%EF%BC%8Cfalse%EF%BC%9A%E8%BF%94%E5%9B%9E%E4%BF%AE%E6%94%B9%E4%B9%8B%E5%89%8D%E7%9A%84%E5%80%BC%5Cn%7D%5Cnvar%20result%20%3D%20db.runCommand(modify)%5Cnprintjson(result)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22d27df91d%22%7D\"></card><p data-lake-id=\"aebb7af96a9ee3c9b7a669f28fef1d7e_p_42\" id=\"aebb7af96a9ee3c9b7a669f28fef1d7e_p_42\"><br></p><h3 data-lake-id=\"ed7b6691\" id=\"ed7b6691\"><span data-lake-id=\"u2987451c\" id=\"u2987451c\">3. 插入 insert</span></h3><p data-lake-id=\"4930f2b57b08d977b4a7a79433f23490_p_43\" id=\"4930f2b57b08d977b4a7a79433f23490_p_43\"><br></p><blockquote data-lake-id=\"u0fdc42ba\" id=\"u0fdc42ba\"><p data-lake-id=\"d9b903f25e263d2819a32064e4bf1a49_p_44\" id=\"d9b903f25e263d2819a32064e4bf1a49_p_44\"><span data-lake-id=\"u588e3082\" id=\"u588e3082\">使用</span><code data-lake-id=\"u044d760b\" id=\"u044d760b\"><span data-lake-id=\"ue0d22278\" id=\"ue0d22278\">insert()</span></code><span data-lake-id=\"u608c3302\" id=\"u608c3302\">或</span><code data-lake-id=\"u8c8cda7b\" id=\"u8c8cda7b\"><span data-lake-id=\"uc09872cc\" id=\"uc09872cc\">save()</span></code><span data-lake-id=\"ufe902e50\" id=\"ufe902e50\">方法向集合中插入文档。如果不指定</span><code data-lake-id=\"udce69330\" id=\"udce69330\"><span data-lake-id=\"ue39eb09c\" id=\"ue39eb09c\">_id</span></code><span data-lake-id=\"u6467ab95\" id=\"u6467ab95\">字段，</span><code data-lake-id=\"ua6e46bb4\" id=\"ua6e46bb4\"><span data-lake-id=\"uac32b3dc\" id=\"uac32b3dc\">save()</span></code><span data-lake-id=\"u80dbc2d9\" id=\"u80dbc2d9\">方法类似</span><code data-lake-id=\"ub6eb5588\" id=\"ub6eb5588\"><span data-lake-id=\"u294968bb\" id=\"u294968bb\">insert()</span></code><span data-lake-id=\"u97af21b5\" id=\"u97af21b5\">方法；如果指定</span><code data-lake-id=\"u94605f4a\" id=\"u94605f4a\"><span data-lake-id=\"uccf096c7\" id=\"uccf096c7\">_id</span></code><span data-lake-id=\"ubf3b20a4\" id=\"ubf3b20a4\">字段，则会更新该</span><code data-lake-id=\"u133e7d82\" id=\"u133e7d82\"><span data-lake-id=\"u32d2d276\" id=\"u32d2d276\">_id</span></code><span data-lake-id=\"u828426d1\" id=\"u828426d1\">的数据。</span></p></blockquote><p data-lake-id=\"0e4b859961c17882302ca1144adad96d_p_45\" id=\"0e4b859961c17882302ca1144adad96d_p_45\"><br></p><h3 data-lake-id=\"ee980e02\" id=\"ee980e02\"><span data-lake-id=\"u9fe3602d\" id=\"u9fe3602d\">4. 删除</span></h3><p data-lake-id=\"e81b6efc8e2153cf8aa53e3b04d7f22c_p_46\" id=\"e81b6efc8e2153cf8aa53e3b04d7f22c_p_46\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.collection.drop()%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%220bddfe0c%22%7D\"></card><p data-lake-id=\"478231c71c811ff5f728eef1ada97581_p_47\" id=\"478231c71c811ff5f728eef1ada97581_p_47\"><br></p><h3 data-lake-id=\"b271e427\" id=\"b271e427\"><span data-lake-id=\"ue4c0aa90\" id=\"ue4c0aa90\">索引</span></h3><p data-lake-id=\"aa95668f5a65b03373d1b0b3f9f8d3a6_p_48\" id=\"aa95668f5a65b03373d1b0b3f9f8d3a6_p_48\"><br></p><blockquote data-lake-id=\"uee485970\" id=\"uee485970\"><p data-lake-id=\"65d964c76e344b8ca35cbd065392a548_p_49\" id=\"65d964c76e344b8ca35cbd065392a548_p_49\"><span data-lake-id=\"u8f5569be\" id=\"u8f5569be\">建立索引可以提高查询效率，不是所有的情况都要建立索引；</span></p><p data-lake-id=\"8fd54d81002f2dffa7def646886e83cf_p_50\" id=\"8fd54d81002f2dffa7def646886e83cf_p_50\"><span data-lake-id=\"u94e51ef8\" id=\"u94e51ef8\">当频繁查询数据时常用。</span></p></blockquote><p data-lake-id=\"d3ff43f9faa22377838e1e2c0834a861_p_51\" id=\"d3ff43f9faa22377838e1e2c0834a861_p_51\"><br></p><ul list=\"u36aabc64\"><li fid=\"ub85f5625\" data-lake-id=\"ad74b5d998737e95179cc772ad0f1152_li_18\" id=\"ad74b5d998737e95179cc772ad0f1152_li_18\"><span data-lake-id=\"u675fdc70\" id=\"u675fdc70\">建立索引：</span></li></ul><p data-lake-id=\"bc2359f7bb1e32241fa27f528e60a125_p_52\" id=\"bc2359f7bb1e32241fa27f528e60a125_p_52\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.tel.ensureIndex(%7Btel%3A%201%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22c6a85205%22%7D\"></card><p data-lake-id=\"0c6a7643ebb3931744a90899eb00ce0b_p_53\" id=\"0c6a7643ebb3931744a90899eb00ce0b_p_53\"><br></p><ul list=\"ud8b99a69\"><li fid=\"uc828c02c\" data-lake-id=\"7ebe8d006bcd45baf6c49b382be52142_li_19\" id=\"7ebe8d006bcd45baf6c49b382be52142_li_19\"><span data-lake-id=\"u40b2a01d\" id=\"u40b2a01d\">获取索引：</span></li></ul><p data-lake-id=\"e10b5c78ee7ba45f407740af88433fc9_p_54\" id=\"e10b5c78ee7ba45f407740af88433fc9_p_54\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.tel.getIndexes()%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%2274adceb1%22%7D\"></card><p data-lake-id=\"7188e3d4590c731c34019643bbb3ba96_p_55\" id=\"7188e3d4590c731c34019643bbb3ba96_p_55\"><br></p><ul list=\"u324e4c3b\"><li fid=\"ud082b613\" data-lake-id=\"0701f65243d16694a212e6c3b961c901_li_20\" id=\"0701f65243d16694a212e6c3b961c901_li_20\"><span data-lake-id=\"u2a37ad4c\" id=\"u2a37ad4c\">删除索引：</span></li></ul><p data-lake-id=\"a6e7204180aba568d27cc7b95d0717fd_p_56\" id=\"a6e7204180aba568d27cc7b95d0717fd_p_56\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22db.tel.dropIndex(%7Btel%3A%201%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22a85abf9b%22%7D\"></card><p data-lake-id=\"67592880a847e874a0da3af4d564ef1f_p_57\" id=\"67592880a847e874a0da3af4d564ef1f_p_57\"><br></p><h2 data-lake-id=\"0031f16b\" id=\"0031f16b\"><span data-lake-id=\"u30b58e8f\" id=\"u30b58e8f\">二、mongoose</span></h2><p data-lake-id=\"e3c9bad72638009a374744280c63ecc6_p_58\" id=\"e3c9bad72638009a374744280c63ecc6_p_58\"><br></p><blockquote data-lake-id=\"u030b2b8a\" id=\"u030b2b8a\"><p data-lake-id=\"b5a926e4d1a8f49509e1c662740d3a08_p_59\" id=\"b5a926e4d1a8f49509e1c662740d3a08_p_59\"><strong><span data-lake-id=\"ua8a31ffa\" id=\"ua8a31ffa\">介绍：</span></strong><code data-lake-id=\"ua853760f\" id=\"ua853760f\"><span data-lake-id=\"ue339f704\" id=\"ue339f704\">Mongoose</span></code><span data-lake-id=\"u30066d9c\" id=\"u30066d9c\">是</span><code data-lake-id=\"ub3284da3\" id=\"ub3284da3\"><span data-lake-id=\"ufff58cfe\" id=\"ufff58cfe\">MongoDB</span></code><span data-lake-id=\"u592e96d0\" id=\"u592e96d0\">的一个对象模型工具，是基于</span><code data-lake-id=\"uf7ae7583\" id=\"uf7ae7583\"><span data-lake-id=\"u00e75440\" id=\"u00e75440\">node-mongodb-native</span></code><span data-lake-id=\"u43f3ccf6\" id=\"u43f3ccf6\">开发的</span><code data-lake-id=\"u3bf18971\" id=\"u3bf18971\"><span data-lake-id=\"u226bb9a8\" id=\"u226bb9a8\">MongoDB nodejs</span></code><span data-lake-id=\"udd7fcf33\" id=\"udd7fcf33\">驱动，可以在</span><strong><span data-lake-id=\"u912f3d61\" id=\"u912f3d61\">异步的环境下执行</span></strong><span data-lake-id=\"u5b25253a\" id=\"u5b25253a\">。同时它也是针对</span><code data-lake-id=\"u6c682e49\" id=\"u6c682e49\"><span data-lake-id=\"ufa5103cf\" id=\"ufa5103cf\">MongoDB</span></code><span data-lake-id=\"uf98dbaa7\" id=\"uf98dbaa7\">操作的一个对象模型库，封装了</span><code data-lake-id=\"u5ce61917\" id=\"u5ce61917\"><span data-lake-id=\"uadd37cb7\" id=\"uadd37cb7\">MongoDB</span></code><span data-lake-id=\"ud8bc3053\" id=\"ud8bc3053\">对文档的的一些增删改查等常用方法，让</span><code data-lake-id=\"uf5da49e9\" id=\"uf5da49e9\"><span data-lake-id=\"u916de6ec\" id=\"u916de6ec\">NodeJS</span></code><span data-lake-id=\"u6d2ccc93\" id=\"u6d2ccc93\">操作</span><code data-lake-id=\"u69ee0930\" id=\"u69ee0930\"><span data-lake-id=\"u5e035c35\" id=\"u5e035c35\">Mongodb</span></code><span data-lake-id=\"u28180af3\" id=\"u28180af3\">数据库变得更加</span><strong><span data-lake-id=\"u56cad06a\" id=\"u56cad06a\">灵活简单</span></strong><span data-lake-id=\"u4bf3b166\" id=\"u4bf3b166\">。</span></p></blockquote><p data-lake-id=\"daa3e859dfee1b8825cb9c219dcb2526_p_60\" id=\"daa3e859dfee1b8825cb9c219dcb2526_p_60\"><br></p><h3 data-lake-id=\"cf148000\" id=\"cf148000\"><span data-lake-id=\"u6ee8800c\" id=\"u6ee8800c\">1、安装</span></h3><p data-lake-id=\"d89d8c6a729313c0d25f9b1742c0d590_p_61\" id=\"d89d8c6a729313c0d25f9b1742c0d590_p_61\"><br></p><blockquote data-lake-id=\"u9b39a3e3\" id=\"u9b39a3e3\"><p data-lake-id=\"b3b64879140e53f2efade079bd3dff73_p_62\" id=\"b3b64879140e53f2efade079bd3dff73_p_62\"><code data-lake-id=\"u85410005\" id=\"u85410005\"><span data-lake-id=\"udf90d195\" id=\"udf90d195\">npm install mongoose</span></code></p></blockquote><p data-lake-id=\"87e34965e50e2c8e31ce44a85667e8dd_p_63\" id=\"87e34965e50e2c8e31ce44a85667e8dd_p_63\"><br></p><h3 data-lake-id=\"d3997a03\" id=\"d3997a03\"><span data-lake-id=\"uf5f5396a\" id=\"uf5f5396a\">2、数据库连接</span></h3><p data-lake-id=\"b3add770127d8c2a5064673aa8a9731f_p_64\" id=\"b3add770127d8c2a5064673aa8a9731f_p_64\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22%2F%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96mongoose%5Cnconst%20mongoose%20%3D%20require('mongoose')%3B%5Cnconst%20db%20%3D%20'mongodb%3A%2F%2Flocalhost%2Fshop'%3B%5Cn%5Cnexports.connect%20%3D%20()%20%3D%3E%20%7B%5Cn%20%20%20%20%2F%2F%20%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%5Cn%20%20%20%20mongoose.connect(db%2C%20%7B%5Cn%20%20%20%20%20%20%20%20useNewUrlParser%3A%20true%20%2F%2F%20%E8%A7%A3%E6%9E%90url%5Cn%20%20%20%20%7D)%5Cn%20%20%20%20%2F%2F%20%E7%9B%91%E5%90%AC%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%5Cn%20%20%20%20mongoose.connection.on('disconnected'%2C%20()%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20mongoose.connect(db)%3B%5Cn%20%20%20%20%7D)%5Cn%20%20%20%20%2F%2F%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%BA%E9%94%99%5Cn%20%20%20%20mongoose.connection.on('error'%2C%20error%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(error)%5Cn%20%20%20%20%20%20%20%20mongoose.connect(db)%3B%5Cn%20%20%20%20%7D)%5Cn%20%20%20%20%2F%2F%20%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%97%B6%E5%80%99%5Cn%20%20%20%20mongoose.connection.once('open'%2C%20()%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20console.log('mongoodb%20connected%20success')%5Cn%20%20%20%20%7D)%5Cn%7D%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22f3c0e364%22%7D\"></card><p data-lake-id=\"2a81d6eed31dfd1dc3c193bbdb75c1a1_p_65\" id=\"2a81d6eed31dfd1dc3c193bbdb75c1a1_p_65\"><br></p><h3 data-lake-id=\"94072740\" id=\"94072740\"><span data-lake-id=\"ud0e10f63\" id=\"ud0e10f63\">3、Schema</span></h3><p data-lake-id=\"cf44cb59378505901ec625cdc88d7d91_p_66\" id=\"cf44cb59378505901ec625cdc88d7d91_p_66\"><br></p><h4 data-lake-id=\"2e6c91e8\" id=\"2e6c91e8\"><span data-lake-id=\"uf68e7a3f\" id=\"uf68e7a3f\">3.1 定义一个 Schema</span></h4><p data-lake-id=\"152302cc03cd3433e252fd8fbe4bade7_p_67\" id=\"152302cc03cd3433e252fd8fbe4bade7_p_67\"><br></p><blockquote data-lake-id=\"ud43c6796\" id=\"ud43c6796\"><p data-lake-id=\"799eef9b38154811607d54bddf7db3dd_p_68\" id=\"799eef9b38154811607d54bddf7db3dd_p_68\"><strong><span data-lake-id=\"ufc70517c\" id=\"ufc70517c\">介绍</span></strong><span data-lake-id=\"u128bb0c9\" id=\"u128bb0c9\">：数据属性模型(传统意义的表结构)，又或着是“集合”的模型骨架。</span></p></blockquote><p data-lake-id=\"956e0d4312e941b77cd57ec35c294aff_p_69\" id=\"956e0d4312e941b77cd57ec35c294aff_p_69\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22var%20mongoose%20%3D%20require('mongoose')%3B%5Cnvar%20TestSchema%20%3D%20new%20mongoose.Schema(%7B%5Cn%20%20%5Ctname%3A%20%7B%20type%3A%20String%2C%20unique%3A%20true%20%7D%2C%2F%2F%20unique%3A%20true%E4%BB%A3%E8%A1%A8%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E5%90%8D%E6%98%AF%E5%94%AF%E4%B8%80%E7%9A%84%5Cn%5Ctage%3A%20%7B%20type%3A%20Number%2C%20default%3A%2018%20%7D%2C%5Cn%20%20%5Ctgender%3A%20%7B%20type%3A%20Boolean%2C%20default%3A%20true%20%7D%5Cn%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%221c43ed0b%22%7D\"></card><p data-lake-id=\"67523e0fa28fe87849ce38cd391e3347_p_70\" id=\"67523e0fa28fe87849ce38cd391e3347_p_70\"><br></p><h4 data-lake-id=\"ce95eeef\" id=\"ce95eeef\"><span data-lake-id=\"ua20a4bc1\" id=\"ua20a4bc1\">3.2\tModel</span></h4><p data-lake-id=\"b7f5c253c3fb3956b40638fc0613cbf9_p_71\" id=\"b7f5c253c3fb3956b40638fc0613cbf9_p_71\"><br></p><blockquote data-lake-id=\"u6fd21591\" id=\"u6fd21591\"><p data-lake-id=\"747f21c1332dda43dabf7534c74f1a7e_p_72\" id=\"747f21c1332dda43dabf7534c74f1a7e_p_72\"><strong><span data-lake-id=\"ue173ea5a\" id=\"ue173ea5a\">介绍</span></strong><span data-lake-id=\"u8cebf4eb\" id=\"u8cebf4eb\">：由</span><code data-lake-id=\"u445699b9\" id=\"u445699b9\"><span data-lake-id=\"u4dae69d4\" id=\"u4dae69d4\">Schema</span></code><span data-lake-id=\"u35fcdf4f\" id=\"u35fcdf4f\">构造生成的模型，除了</span><code data-lake-id=\"u4d9e7741\" id=\"u4d9e7741\"><span data-lake-id=\"u1b6e7098\" id=\"u1b6e7098\">Schema</span></code><span data-lake-id=\"u90703012\" id=\"u90703012\">定义的数据库骨架以外，还具有数据库操作行为，类似于管理数据库属性、行为的类</span></p><p data-lake-id=\"aff1faf8918c609306443436d0574840_p_73\" id=\"aff1faf8918c609306443436d0574840_p_73\"><span data-lake-id=\"u38d9333b\" id=\"u38d9333b\">创建</span><code data-lake-id=\"ue708968f\" id=\"ue708968f\"><span data-lake-id=\"u21fa6a81\" id=\"u21fa6a81\">Model</span></code><span data-lake-id=\"uab9c03fb\" id=\"uab9c03fb\">模型，需要指定：</span><strong><span data-lake-id=\"u4f4cb224\" id=\"u4f4cb224\">1.集合名称，2.集合的</span></strong><code data-lake-id=\"u3831505e\" id=\"u3831505e\"><strong><span data-lake-id=\"u6c7c3d34\" id=\"u6c7c3d34\">Schema</span></strong></code><strong><span data-lake-id=\"u380b4ba6\" id=\"u380b4ba6\">结构对象</span></strong></p></blockquote><p data-lake-id=\"d36608d2dcf9f070081537010b5adfb3_p_74\" id=\"d36608d2dcf9f070081537010b5adfb3_p_74\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22%2F%2F%20%E5%88%9B%E5%BB%BAModel%5Cnvar%20TestModel%20%3D%20mongoose.model(%5C%22test1%5C%22%2C%20TestSchema)%3B%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%2209475daf%22%7D\"></card><p data-lake-id=\"cee026a6997be2fe2ca3b5d6e2ce2bf0_p_75\" id=\"cee026a6997be2fe2ca3b5d6e2ce2bf0_p_75\"><br></p><blockquote data-lake-id=\"ube126e3c\" id=\"ube126e3c\"><p data-lake-id=\"8d2be128dde550dd2bce1a825b5787c3_p_76\" id=\"8d2be128dde550dd2bce1a825b5787c3_p_76\"><code data-lake-id=\"ud3fc6ade\" id=\"ud3fc6ade\"><span data-lake-id=\"u42134e26\" id=\"u42134e26\">test1</span></code><span data-lake-id=\"u72626b9d\" id=\"u72626b9d\">：数据库中的集合名称，当我们对其添加数据时如果</span><code data-lake-id=\"u9b489ea4\" id=\"u9b489ea4\"><span data-lake-id=\"u3caa2055\" id=\"u3caa2055\">test1</span></code><span data-lake-id=\"ub77a6977\" id=\"ub77a6977\">已经存在，则会保存到其目录下，如果未存在，则会创建</span><code data-lake-id=\"ud9663272\" id=\"ud9663272\"><span data-lake-id=\"uae152015\" id=\"uae152015\">test1</span></code><span data-lake-id=\"u0c8e7002\" id=\"u0c8e7002\">集合，然后在保存数据。</span></p></blockquote><p data-lake-id=\"9fc1a1e32cf7c324fef5888bc3009382_p_77\" id=\"9fc1a1e32cf7c324fef5888bc3009382_p_77\"><br></p><h4 data-lake-id=\"3011837c\" id=\"3011837c\"><span data-lake-id=\"uc031f130\" id=\"uc031f130\">3.3 Entity</span></h4><p data-lake-id=\"f585fed1cef9af7641b65ac1c4919258_p_78\" id=\"f585fed1cef9af7641b65ac1c4919258_p_78\"><br></p><blockquote data-lake-id=\"ube7df33f\" id=\"ube7df33f\"><p data-lake-id=\"ec695567a097a69e9a045f78df4c66a6_p_79\" id=\"ec695567a097a69e9a045f78df4c66a6_p_79\"><strong><span data-lake-id=\"u8b057be9\" id=\"u8b057be9\">介绍</span></strong><span data-lake-id=\"u5f73e5fb\" id=\"u5f73e5fb\">：由</span><code data-lake-id=\"u0c565da2\" id=\"u0c565da2\"><span data-lake-id=\"uaf0bdd91\" id=\"uaf0bdd91\">Model</span></code><span data-lake-id=\"u4d956942\" id=\"u4d956942\">创建的实体，使用</span><code data-lake-id=\"u60395935\" id=\"u60395935\"><span data-lake-id=\"u0cfd2936\" id=\"u0cfd2936\">save</span></code><span data-lake-id=\"ud45af233\" id=\"ud45af233\">方法保存数据，</span><code data-lake-id=\"u054e7f88\" id=\"u054e7f88\"><span data-lake-id=\"uc7a82bb0\" id=\"uc7a82bb0\">Model</span></code><span data-lake-id=\"u99b772af\" id=\"u99b772af\">和</span><code data-lake-id=\"u5ed9e945\" id=\"u5ed9e945\"><span data-lake-id=\"u072b32f0\" id=\"u072b32f0\">Entity</span></code><span data-lake-id=\"uf6af15d1\" id=\"uf6af15d1\">都有能影响数据库的操作，但</span><code data-lake-id=\"u33f1c3bf\" id=\"u33f1c3bf\"><span data-lake-id=\"ua2610901\" id=\"ua2610901\">Model</span></code><span data-lake-id=\"uf03a3f31\" id=\"uf03a3f31\">比</span><code data-lake-id=\"u9d98a32c\" id=\"u9d98a32c\"><span data-lake-id=\"u76b92e1d\" id=\"u76b92e1d\">Entity</span></code><span data-lake-id=\"uefc59285\" id=\"uefc59285\">更具操作性。</span></p></blockquote><p data-lake-id=\"cacc5e28cdefa24e262c83e0ab2a3ade_p_80\" id=\"cacc5e28cdefa24e262c83e0ab2a3ade_p_80\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22%2F%2F%20%E5%88%9B%E5%BB%BAEntity%5Cnvar%20TestEntity%20%3D%20new%20TestModel(%7B%5Cn%20%20%20%20%20%20%20name%20%3A%20%5C%22Lenka%5C%22%2C%5Cn%20%20%20%20%20%20%20age%20%20%3A%2036%2C%5Cn%20%20%20%20%20%20%20email%3A%20%5C%22lenka%40qq.com%5C%22%5Cn%7D)%3B%5Cnconsole.log(TestEntity.name)%3B%20%2F%2F%20Lenka%5Cnconsole.log(TestEntity.age)%3B%20%2F%2F%2036%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22061fdf72%22%7D\"></card><p data-lake-id=\"00780844004a7920ee455d8665291201_p_81\" id=\"00780844004a7920ee455d8665291201_p_81\"><br></p><h4 data-lake-id=\"b279dbc0\" id=\"b279dbc0\"><span data-lake-id=\"uf6563245\" id=\"uf6563245\">3.4\t创建集合</span></h4><p data-lake-id=\"ede07f6666baf1587414d7171c5dd877_p_82\" id=\"ede07f6666baf1587414d7171c5dd877_p_82\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22var%20mongoose%20%3D%20require('mongoose')%5Cnmongoose.connect('mongodb%3A%2F%2F127.0.0.1%3A27017%2Ftest')%5Cnmongoose.connection.on('connected'%2C%20function()%20%7B%5Cn%5Ctconsole.log('yes')%5Cn%7D)%5Cn%5Cnvar%20TestSchema%20%3D%20new%20mongoose.Schema(%7B%5Cn%5Ctname%3A%20%7B%20type%3A%20String%20%7D%2C%5Cn%20%20%5Ctage%3A%20%7B%20type%3A%20Number%2C%20default%3A%200%20%7D%2C%5Cn%20%20%5Ctemail%3A%20%7B%20type%3A%20String%20%7D%2C%5Cn%20%20%5Cttime%3A%20%7B%20type%3A%20Date%2C%20defaultL%3A%20Date.now%20%7D%5Cn%7D)%5Cn%5Cnvar%20TestModel%20%3D%20mongoose.model('test1'%2C%20TestSchema)%5Cn%5Cnvar%20TestEntity%20%3D%20new%20TestModel(%7B%5Cn%5Ctname%3A%20'zs'%2C%5Cn%20%20%5Ctage%3A%2020%2C%5Cn%20%20%5Ctemail%3A%20'aa%40bb.com'%5Cn%7D)%5CnTestEntity.save(function(error%2C%20doc)%20%7B%5Cn%5Ctif(error)%20%7B%5Cn%20%20%20%20%5Ctconsole.log(%5C%22error%3A%5C%22%20%2B%20error)%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%5Ctconsole.log(doc)%5Cn%20%20%20%20%7D%5Cn%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%22b14fea9e%22%7D\"></card><p data-lake-id=\"187832c794b601f7094c1a9b20086a6b_p_83\" id=\"187832c794b601f7094c1a9b20086a6b_p_83\"><br></p><h3 data-lake-id=\"bb03aec3\" id=\"bb03aec3\"><span data-lake-id=\"ubcda0058\" id=\"ubcda0058\">4、操作</span></h3><p data-lake-id=\"470257ffbff08ad0eedbc557452f8c66_p_84\" id=\"470257ffbff08ad0eedbc557452f8c66_p_84\"><br></p><h4 data-lake-id=\"4e874710\" id=\"4e874710\"><span data-lake-id=\"u44bbed37\" id=\"u44bbed37\">4.1 查询</span></h4><p data-lake-id=\"bd02ded472df593f8e23bb50569c5ce4_p_85\" id=\"bd02ded472df593f8e23bb50569c5ce4_p_85\"><br></p><h5 data-lake-id=\"7a1dc02c\" id=\"7a1dc02c\"><span data-lake-id=\"u80426a82\" id=\"u80426a82\">4.1.1 find 基本查询</span></h5><p data-lake-id=\"c07d4a2054239914d4a014d7d64fcf23_p_86\" id=\"c07d4a2054239914d4a014d7d64fcf23_p_86\"><br></p><blockquote data-lake-id=\"u1465a86f\" id=\"u1465a86f\"><p data-lake-id=\"4233d36f6c4053adc6c6c9021a8619f3_p_87\" id=\"4233d36f6c4053adc6c6c9021a8619f3_p_87\"><code data-lake-id=\"u670c68ed\" id=\"u670c68ed\"><span data-lake-id=\"u150d773e\" id=\"u150d773e\">obj.find(查询条件, callback)</span></code></p></blockquote><p data-lake-id=\"ac4c0d2013d04adfac6d2e9459525ac0_p_88\" id=\"ac4c0d2013d04adfac6d2e9459525ac0_p_88\"><br></p><h5 data-lake-id=\"8fe7015f\" id=\"8fe7015f\"><span data-lake-id=\"u6f634c6a\" id=\"u6f634c6a\">4.1.2 find 过滤查询</span></h5><p data-lake-id=\"ab51a4ad9cb9ee48199bb5c9fc6715a2_p_89\" id=\"ab51a4ad9cb9ee48199bb5c9fc6715a2_p_89\"><br></p><ul list=\"u4003aba0\"><li fid=\"ue39f6a4a\" data-lake-id=\"b84767490c4de031be3c97204b7da51d_li_21\" id=\"b84767490c4de031be3c97204b7da51d_li_21\"><span data-lake-id=\"u00bbec4d\" id=\"u00bbec4d\">属性过滤</span></li></ul><blockquote data-lake-id=\"uccb6571e\" id=\"uccb6571e\"><p data-lake-id=\"0f8079aecc6ee0bdaeabe04432a1d438_p_90\" id=\"0f8079aecc6ee0bdaeabe04432a1d438_p_90\"><code data-lake-id=\"u2197b69f\" id=\"u2197b69f\"><span data-lake-id=\"uc2b6771d\" id=\"uc2b6771d\">find(Conditions, field, callback)</span></code><span data-lake-id=\"u2f992c04\" id=\"u2f992c04\">，其中</span><code data-lake-id=\"u7d633da1\" id=\"u7d633da1\"><span data-lake-id=\"u3678801d\" id=\"u3678801d\">field</span></code><span data-lake-id=\"u90e661df\" id=\"u90e661df\">省略或者设置为</span><code data-lake-id=\"uf849656e\" id=\"uf849656e\"><span data-lake-id=\"uf3501d3a\" id=\"uf3501d3a\">null</span></code><span data-lake-id=\"ud0a53a1e\" id=\"ud0a53a1e\">，则返回所有属性</span></p></blockquote><p data-lake-id=\"2585884a100de0fae153ff935c1040bf_p_91\" id=\"2585884a100de0fae153ff935c1040bf_p_91\"><br></p><h5 data-lake-id=\"21958309\" id=\"21958309\"><span data-lake-id=\"uba171c9c\" id=\"uba171c9c\">4.1.3 单条数据查询</span></h5><p data-lake-id=\"f82a35c2fca60d6b3bdc5c1000201985_p_92\" id=\"f82a35c2fca60d6b3bdc5c1000201985_p_92\"><br></p><ul list=\"u38de668c\"><li fid=\"u5d937525\" data-lake-id=\"c7fecba67e6ff5af8bf7eebe88a97988_li_22\" id=\"c7fecba67e6ff5af8bf7eebe88a97988_li_22\"><code data-lake-id=\"u31776a50\" id=\"u31776a50\"><span data-lake-id=\"u1bbedc85\" id=\"u1bbedc85\">findOne</span></code></li></ul><p data-lake-id=\"92499751fabe053dd037c1574d6f4fb2_p_93\" id=\"92499751fabe053dd037c1574d6f4fb2_p_93\"><br></p><blockquote data-lake-id=\"ub30bb4b7\" id=\"ub30bb4b7\"><p data-lake-id=\"843de173fed186b0d566fb2d67ffb1d2_p_94\" id=\"843de173fed186b0d566fb2d67ffb1d2_p_94\"><code data-lake-id=\"uc2c5f118\" id=\"uc2c5f118\"><span data-lake-id=\"u67805578\" id=\"u67805578\">findOne(Conditions, callback)</span></code><span data-lake-id=\"ubd1eb973\" id=\"ubd1eb973\">，注意：只返回第一个符合条件的文档数据</span></p></blockquote><p data-lake-id=\"45f9c401f99c8bc813e223381c98f09b_p_95\" id=\"45f9c401f99c8bc813e223381c98f09b_p_95\"><br></p><ul list=\"u280ad27a\"><li fid=\"ud768ad9c\" data-lake-id=\"4b33286a5a297ba177aba135a448b7f2_li_23\" id=\"4b33286a5a297ba177aba135a448b7f2_li_23\"><code data-lake-id=\"u4693c8f3\" id=\"u4693c8f3\"><span data-lake-id=\"u284cb5fb\" id=\"u284cb5fb\">findById</span></code></li></ul><blockquote data-lake-id=\"u0535b8d3\" id=\"u0535b8d3\"><p data-lake-id=\"f7a29b3adb784cd479242731a9b971c2_p_96\" id=\"f7a29b3adb784cd479242731a9b971c2_p_96\"><code data-lake-id=\"uc9c53130\" id=\"uc9c53130\"><span data-lake-id=\"ucfed0518\" id=\"ucfed0518\">findById(_id, callback)</span></code><span data-lake-id=\"ubd6ad41c\" id=\"ubd6ad41c\">，注意：只接受文档的</span><code data-lake-id=\"u7a16483e\" id=\"u7a16483e\"><span data-lake-id=\"ub0534ded\" id=\"ub0534ded\">_id</span></code><span data-lake-id=\"u9c8eb82c\" id=\"u9c8eb82c\">作为参数</span></p></blockquote><p data-lake-id=\"d6a51c95a901676ffc113c140e74f091_p_97\" id=\"d6a51c95a901676ffc113c140e74f091_p_97\"><br></p><h4 data-lake-id=\"1240c168\" id=\"1240c168\"><span data-lake-id=\"uaec0b62c\" id=\"uaec0b62c\">4.2 Model 保存</span></h4><p data-lake-id=\"545db91b827f87cc9afe81c0f08a1a88_p_98\" id=\"545db91b827f87cc9afe81c0f08a1a88_p_98\"><br></p><ul list=\"uc31a6f1c\"><li fid=\"u1354e666\" data-lake-id=\"9a315966ea4c273065234743b072d249_li_24\" id=\"9a315966ea4c273065234743b072d249_li_24\"><code data-lake-id=\"ucf3bc3ba\" id=\"ucf3bc3ba\"><span data-lake-id=\"u0036d275\" id=\"u0036d275\">Model.create(文档数据, callback)</span></code></li></ul><p data-lake-id=\"680207cd112f221e8bb2a2adf8b5ef15_p_99\" id=\"680207cd112f221e8bb2a2adf8b5ef15_p_99\"><br></p><h4 data-lake-id=\"182385ff\" id=\"182385ff\"><span data-lake-id=\"u68a84b27\" id=\"u68a84b27\">4.3 entity 保存</span></h4><p data-lake-id=\"ec69cd8d8f73ee437722723e0adf1fa7_p_100\" id=\"ec69cd8d8f73ee437722723e0adf1fa7_p_100\"><br></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22var%20Entity%20%3D%20new%20Model(%7B%20name%3A%20%5C%22zs%5C%22%2C%20age%3A%2027%20%7D)%5CnEntity.save(function(error%2C%20doc)%20%7B%5Cn%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(error)%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(doc)%5Cn%20%20%20%20%7D%5Cn%7D)%22%2C%22autoWrap%22%3Afalse%2C%22theme%22%3A%22default%22%2C%22heightLimit%22%3Atrue%2C%22id%22%3A%2261a594cd%22%7D\"></card><p data-lake-id=\"01884230bc631815ce050c63d5156a8c_p_101\" id=\"01884230bc631815ce050c63d5156a8c_p_101\"><br></p><h4 data-lake-id=\"96ba815e\" id=\"96ba815e\"><span data-lake-id=\"u3cb18210\" id=\"u3cb18210\">4.4 数据更新</span></h4><p data-lake-id=\"a2c2ab33193f15adcdff2e08f718d7c2_p_102\" id=\"a2c2ab33193f15adcdff2e08f718d7c2_p_102\"><br></p><ul list=\"u7fe2ff71\"><li fid=\"uff06f77f\" data-lake-id=\"688b64de43cf398e63903d0864fc25d0_li_25\" id=\"688b64de43cf398e63903d0864fc25d0_li_25\"><code data-lake-id=\"ucdff20db\" id=\"ucdff20db\"><span data-lake-id=\"u87a01966\" id=\"u87a01966\">obj.update(查询条件, 更新对象, callback)</span></code></li></ul><p data-lake-id=\"c4eb78622bfacec164736bf4df40fa3b_p_103\" id=\"c4eb78622bfacec164736bf4df40fa3b_p_103\"><br></p><h4 data-lake-id=\"274dbed5\" id=\"274dbed5\"><span data-lake-id=\"ucc671878\" id=\"ucc671878\">4.5 数据删除</span></h4><p data-lake-id=\"9bd2d97c6b7de4b9f89a01020f0acbdc_p_104\" id=\"9bd2d97c6b7de4b9f89a01020f0acbdc_p_104\"><br></p><ul list=\"uec192611\"><li fid=\"u01641831\" data-lake-id=\"7f09d05e3b0eee758cb71ce6ece6dc71_li_26\" id=\"7f09d05e3b0eee758cb71ce6ece6dc71_li_26\"><code data-lake-id=\"u94b1ec10\" id=\"u94b1ec10\"><span data-lake-id=\"u8d4eac39\" id=\"u8d4eac39\">obj.remove(查询条件, callback)</span></code></li></ul>",
  "body_draft_lake": "",
  "public": 0,
  "status": 1,
  "view_status": 0,
  "read_status": 1,
  "likes_count": 0,
  "comments_count": 0,
  "content_updated_at": "2022-03-03T15:26:56.000Z",
  "deleted_at": null,
  "created_at": "2020-08-10T05:35:13.000Z",
  "updated_at": "2022-03-13T10:00:02.000Z",
  "published_at": "2022-03-03T15:26:56.000Z",
  "first_published_at": "2020-08-10T05:35:13.000Z",
  "word_count": 1610,
  "cover": null,
  "description": "mongodb 是一种非关系型数据库，不必写 sql 语句，其操作类似于 json ，方便后端工作者进行开发。mongoose 是一种 mongodb 的 orm 框架，方便操作和使用，其中，Schema 是关键。一、常用命令：常用命令介绍show dbs显示数据库列表show collect...",
  "custom_description": null,
  "hits": 0,
  "_serializer": "v2.doc_detail"
}