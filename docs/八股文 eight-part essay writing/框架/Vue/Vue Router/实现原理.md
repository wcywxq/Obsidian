---
title: 实现原理
url: https://www.yuque.com/wcywxq/mxunh7/bgudpr
---

vue-router 通过 hash 和 history 两种方式实现前端路由。更新视图但不重新请求页面，而是前端路由原理的核心之一。 <a name="L1bbR"></a>

## hash 模式和 history 模式

hash 采用了 window.location.hash 的值来获取 URL 中 # 后面的内容。
:::info
**hash 特点：**
hash 虽然出现在 url 中，但不会被包含在 http 请求中，他是用来描述浏览器动作的，但是对服务端无效。因此改变 hash 不会重新加载页面，每一次改变 hash，都会在浏览器历史中增加一个记录，利用 hash 的这些特点，就可以实现前端路由。
:::

history 实际采用了HTML5 中提供的 API 来实现。主要有 history.pushState() 和 history.replaceState()。
:::info
**pushState 和 replaceState 共同特点：**
当前调用他们修改浏览器历史栈后，虽然当前 url 改变了，但浏览器不会立即发送请求 url，这就为单页面前端路由、更新视图但不重新请求页面提供了基础。
:::
:::danger
history 模式需要后面服务器进行路径重写，否则会出现 404 错误
::: <a name="u1zti"></a>

## router-link 和 $router.push 实现原理

<a name="DcQFK"></a>

### router-link

默认会被渲染为 a 标签，可以通过 tag 属性修改为其他标签。自动为 a 标签添加 click 时间，然后执行 $router.push 实现跳转 <a name="WWbJU"></a>

### $router.push

根据路由配置的 mode 确定使用 html5 history 还是 hash history 来实现跳转

- html5 history：调用 window.history.pushState() 跳转
- hash history：调用 HashHistory.push() 跳转
