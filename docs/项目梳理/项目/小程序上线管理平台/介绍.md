---
title: 介绍
url: https://www.yuque.com/wcywxq/aggvdq/klkzoy
---

目前小程序业务的上线部署流程中除了 CI 流程以外，其余步骤基本都靠人工手动操作，效率低下且无法追溯。为此，团队自驱设计开发了小程序上线平台，将除提审和发布之外的全部手工操作流程(版本管理、代码上传、体验码生成、代码包存储、sourceMap 存储等)进行了自动化封装，并和已有的 CI 流程串联起来，闭环小程序业务的完整上线生命周期 <a name="mT6Ed"></a>

## 首页

- 展示接入的小程序项目的基本信息，包括项目地址、渠道路径、流水线地址、上线分支等
- 展示当前项目的所有上线单列表，对应的上线单在不同权限下可进行查看、编辑和删除等操作
- 新建上线单的时候，自动获取最近已上线的版本号，同时更新上线单状态
- 另外，在编辑上线单的时候，如果想要取消某个渠道的发布，需要判定该渠道是否已上线，如果未上线即可以取消，已上线则不能取消，因此会增加一个字段作为标识。 <a name="d9teV"></a>

## 上线单

- 展示基本信息，包括 rd 值班人、qa 值班人，是否需要业务方协同回归
- 展示当前上线单需求列表，其中需求项对应的 rd 和 qa 的状态确认功能需做权限校验
- 创建、编辑、删除当前上线单需求
- 展示当前上线单所有的业务协同方列表，包含业务方信息、rd 和 qa 对接人需要签字确认做权限校验
- 创建上线单后可以自定义是否发出通知，包含上线单填写通知、需求确认通知、业务方签字提醒通知，这些通知内容是在配置中心设置的 <a name="HiYQi"></a>

## patch

- 新建 patch，此时小程序版本号需要做推算，即取所有上线的 patch(不区分渠道)中的最大的 patch 版本 +1，这里渠道如果上线则默认不可选，只做信息展示
- 发起上线将会根据配置的渠道来做相应的信息切换，每个渠道下将展示当前 patch 包所对应的代码相关的信息和体验版二维码等，其中如果当前存在体验版二维码，则当前 patch 带 *
- 发起上线的所有渠道都会包含的流程
  - 自动：拉取代码、OE构建、代码上传、生成 soureMap
  - 手动：版本提审
  - 手动：版本发布
- 发起上线的所有渠道都支持一键回滚的功能，回滚后将变更为版本提审的状态，同时需要记录相关日志信息 <a name="ufgNx"></a>

## 配置中心

- 快速接入：包含项目信息配置、小程序信息配置
- 分组管理：配置用户权限、用户搜索、删除等功能，添加是与 git 权限做关联的，这是 oe 系统的事情
- 小程序信息管理：更新小程序信息，已上线的渠道配置将无法改变
- 消息通知群信息配置：包括群的名字和 token，以及新增和删除
- 通知消息模块配置：配置上线单通知、rd & qa check 通知、业务方签字信息通知、业务方信息配置、自动订阅通知等群消息通知配置
- 系统参数管理：用于整个系统的参数变量配置
