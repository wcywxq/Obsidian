---
title: 数据库表设计
url: https://www.yuque.com/wcywxq/aggvdq/csg8d4
---

```sql
/*
 Navicat Premium Data Transfer

 Source Server         : miniprogram-publish-db
 Source Server Type    : MySQL
 Source Server Version : 80028
 Source Host           : localhost:3306
 Source Schema         : publish-table

 Target Server Type    : MySQL
 Target Server Version : 80028
 File Encoding         : 65001

 Date: 17/02/2022 21:52:58
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for cooperate_tb
-- ----------------------------
DROP TABLE IF EXISTS `cooperate_tb`;
CREATE TABLE `cooperate_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '协同方id',
  `publish_id` bigint NOT NULL COMMENT '上线单id',
  `project_cooperate_id` bigint NOT NULL COMMENT '项目协同方id',
  `confirm_qa_id` bigint DEFAULT NULL COMMENT '签字确认qa的uid',
  `confirm_status` int DEFAULT '0' COMMENT '签字确认状态0:取消1:确认',
  `confirm_time` datetime DEFAULT NULL COMMENT '确认时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for dc_group_tb
-- ----------------------------
DROP TABLE IF EXISTS `dc_group_tb`;
CREATE TABLE `dc_group_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT 'dc群id',
  `project_id` bigint NOT NULL COMMENT '项目id',
  `group_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT 'dc群名称',
  `dc_access_token` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT 'dc群的accessToken',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for limit_tb
-- ----------------------------
DROP TABLE IF EXISTS `limit_tb`;
CREATE TABLE `limit_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '用户uid',
  `project_name` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '项目id',
  `user_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '用户邮箱前缀',
  `chinese_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '用户中文名',
  `limit` int NOT NULL DEFAULT '0' COMMENT '用户权限 0: 无编辑删除权限 1: 管理员 2: 开发者',
  `add_time` datetime NOT NULL COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for menu_tb
-- ----------------------------
DROP TABLE IF EXISTS `menu_tb`;
CREATE TABLE `menu_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '上线单需求id',
  `publish_id` bigint NOT NULL COMMENT '上线单id',
  `cooperate_id` bigint NOT NULL COMMENT '需求方id',
  `name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '需求名称',
  `type` int NOT NULL COMMENT '本次上线类型 1: 需求 2: bugfix',
  `mr_address` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT 'mr地址',
  `wiki` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '需求wiki',
  `relevance_rd_id` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '开发rd,以逗号分隔uid',
  `relevance_qa_id` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '跟进qa, 以逗号分隔uid',
  `qa_checked` int DEFAULT '0' COMMENT 'qa check 值',
  `qa_checked_id` bigint DEFAULT NULL COMMENT 'qa checked uid',
  `qa_checked_time` datetime DEFAULT NULL COMMENT 'qa check 时间',
  `rd_checked` int DEFAULT '0' COMMENT 'rd check 值',
  `rd_checked_id` bigint DEFAULT NULL COMMENT 'rd checked uid',
  `rd_checked_time` datetime DEFAULT NULL COMMENT 'rd check 时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for message_tb
-- ----------------------------
DROP TABLE IF EXISTS `message_tb`;
CREATE TABLE `message_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '消息通知id',
  `project_id` bigint NOT NULL COMMENT '项目id',
  `group_id` int NOT NULL COMMENT '通知群组id',
  `type` int NOT NULL COMMENT '通知类型',
  `text` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '通知文案',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for operate_tb
-- ----------------------------
DROP TABLE IF EXISTS `operate_tb`;
CREATE TABLE `operate_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '操作记录id',
  `patch_id` bigint NOT NULL COMMENT 'patch id',
  `channel` enum('wx','ali','qq') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'wx' COMMENT '渠道',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `operate_source` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '信息来源',
  `operate_status` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '信息状态',
  `operate_content` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '信息内容',
  `flow` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for patch_tb
-- ----------------------------
DROP TABLE IF EXISTS `patch_tb`;
CREATE TABLE `patch_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT 'patch id',
  `publish_id` bigint NOT NULL COMMENT '上线id',
  `flow_status` int NOT NULL DEFAULT '0' COMMENT '微信补丁状态',
  `mp_version` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '小程序版本',
  `sourcemap_origin` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT 'sourcemap地址',
  `code_origin` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '代码包地址',
  `comment` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '备注',
  `is_rollback` int DEFAULT '0' COMMENT '是否回滚 1: 是 0: 否',
  `channel` enum('wx','ali','qq') CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT 'wx' COMMENT '渠道',
  `commit_id` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT 'git提交记录id',
  `publish_percent` int DEFAULT '0' COMMENT '放量百分比',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for project_channel_tb
-- ----------------------------
DROP TABLE IF EXISTS `project_channel_tb`;
CREATE TABLE `project_channel_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '项目渠道id',
  `project_id` bigint NOT NULL COMMENT '项目id',
  `appid` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '小程序appid',
  `channel` enum('wx','ali','qq') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'wx' COMMENT '渠道',
  `output_address` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '产出物地址',
  `size_report_add` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT 'sizeReport地址',
  `private_key` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '密钥',
  `experience_address` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '体验版地址',
  `tool_id` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '支付宝需要的工具id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for project_cooperate_tb
-- ----------------------------
DROP TABLE IF EXISTS `project_cooperate_tb`;
CREATE TABLE `project_cooperate_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '项目协同方id',
  `project_id` bigint NOT NULL COMMENT '项目id',
  `cooperate_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '协同方名称',
  `rd_person_id` bigint NOT NULL COMMENT 'rd对接人',
  `qa_person_id` bigint NOT NULL COMMENT 'qa对接人',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for project_tb
-- ----------------------------
DROP TABLE IF EXISTS `project_tb`;
CREATE TABLE `project_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '项目id',
  `git_address` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT 'git地址',
  `git_project_id` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT 'git项目id',
  `git_access_token` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT 'git access token',
  `publish_branch` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '上线分支',
  `oe_address` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT 'oe流水线地址',
  `project_chinese_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '项目中文名称',
  `project_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '项目名称',
  `project_icon` varchar(400) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '项目icon地址',
  `package_key` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT 'package.json里存放动态修改值的key',
  `is_custom_field` int DEFAULT '0' COMMENT '是否展示需要自定义字段',
  `is_base_module` int DEFAULT '0' COMMENT '是否展示基础模块',
  `is_base_notice` int DEFAULT '0' COMMENT '是否开启基础模块通知功能',
  `is_need_module` int DEFAULT '0' COMMENT '是否展示需求模块',
  `is_need_notice_rd` int DEFAULT '0' COMMENT '是否开启需求模块rd通知功能',
  `is_need_notice_qa` int DEFAULT '0' COMMENT '是否开启需求模块qa通知功能',
  `is_need_check_rd` int DEFAULT '0' COMMENT '是否 check 需求模块rd',
  `is_need_check_qa` int DEFAULT '0' COMMENT '是否 check 需求模块 qa',
  `is_cooperate_module` int DEFAULT '0' COMMENT '是否展示协同模块',
  `is_cooperate_check` int DEFAULT '0' COMMENT '是否 check 协同模块',
  `is_cooperate_notice` int DEFAULT '0' COMMENT '是否开启协同模块通知功能',
  `is_subscribe_notice` int DEFAULT '0' COMMENT '是否订阅通知功能',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

-- ----------------------------
-- Table structure for publish_tb
-- ----------------------------
DROP TABLE IF EXISTS `publish_tb`;
CREATE TABLE `publish_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '上线单id',
  `custom_version` varchar(10) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '0.0.0' COMMENT '端上版本号',
  `app_name` varchar(30) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'didi' COMMENT '项目名称',
  `is_cooper` int NOT NULL DEFAULT '0' COMMENT '是否协同',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `expect_time` datetime NOT NULL COMMENT '预计上线时间',
  `duty_rd_id` int NOT NULL COMMENT 'rd 值班人 uid',
  `duty_qa_id` int NOT NULL COMMENT 'qa 值班人 uid',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;

-- ----------------------------
-- Table structure for qrcode_tb
-- ----------------------------
DROP TABLE IF EXISTS `qrcode_tb`;
CREATE TABLE `qrcode_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '二维码 id',
  `patch_id` bigint NOT NULL COMMENT 'patch id',
  `app_name` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '' COMMENT '项目名称',
  `channel` enum('wx','ali','qq') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'wx' COMMENT '渠道',
  `qrcode_origin` varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '二维码地址',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;

-- ----------------------------
-- Table structure for status_tb
-- ----------------------------
DROP TABLE IF EXISTS `status_tb`;
CREATE TABLE `status_tb` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '上线状态id',
  `publish_id` bigint NOT NULL COMMENT '上线单id',
  `patch_id` bigint NOT NULL COMMENT 'patch id',
  `channel` enum('wx','ali','qq') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'wx' COMMENT '渠道',
  `mp_version` varchar(11) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '0.0.0' COMMENT '小程序版本号',
  `status` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT '' COMMENT '上线状态',
  `enable` int DEFAULT '1' COMMENT '可用状态',
  `is_published` int DEFAULT '0' COMMENT '是否已上线',
  `complete_time` datetime DEFAULT NULL COMMENT '完成时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;

SET FOREIGN_KEY_CHECKS = 1;

```
